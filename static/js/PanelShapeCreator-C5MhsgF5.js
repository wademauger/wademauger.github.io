import{b as h,bh as ge,R as U,c as ue,bi as Me,bj as Oe,bk as mt,bl as fi,bm as hi,aD as Rt,bn as gi,bo as Wn,bp as ps,_ as Xe,bq as pi,br as ms,bs as Xt,bt as vs,bu as gt,bv as bs,bw as ys,bx as Cs,by as _e,bz as Ue,bA as ir,bB as xs,bC as kt,e as mi,bD as Ss,bE as ws,bF as vi,bG as Ur,g as rn,m as on,u as G,r as sn,bH as Zn,bI as Dr,bJ as Fn,C as Bt,bK as bi,aX as yi,bL as Qn,bM as $s,bN as er,bO as Rs,aF as tr,bP as Es,bQ as Xn,bR as Nr,bS as Ms,aC as zr,bT as dt,bU as Lr,bV as An,bW as Ps,bX as sr,ah as _t,aK as Is,bY as js,bZ as Jr,b2 as Ci,b_ as br,b$ as xi,c0 as Si,c1 as xt,c2 as zn,c3 as Os,aw as wi,c4 as Ts,c5 as ks,c6 as As,c7 as Bs,c8 as Ds,aE as Ns,c9 as zs,ca as Ls,I as Yt,cb as $i,cc as Ri,cd as _s,ce as Hs,cf as Ws,cg as yr,K as Fs,ch as Xs,ci as Ys,aV as Ei,F as ar,ai as Gs,j as v,M as Ks,h as Vs,B as je,s as en,f as Cr,cj as qs,q as Ye,T as yn,ck as Us,aT as qe,aU as De,b4 as xr,cl as Zr,cm as Js,cn as Mi,k as Zs,co as Qs,z as ea,p as Bn,aS as ta,cp as na}from"./index-DeCj4Dh0.js";import{R as Yn}from"./PlusOutlined-BuoWBkTE.js";import{T as He,D as _r,a as Sr}from"./DeleteOutlined-BuNT2Cjt.js";import{T as Gn}from"./index--VTcA1ip.js";import{S as ra}from"./index-CdqblKwG.js";function oa(t){var e="touches"in t?t.touches[0]:t,n=document.documentElement.scrollLeft||document.body.scrollLeft||window.pageXOffset,r=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset;return{pageX:e.pageX-n,pageY:e.pageY-r}}function Pi(t){var e=t.targetRef,n=t.containerRef,r=t.direction,o=t.onDragChange,i=t.onDragChangeComplete,a=t.calculate,s=t.color,l=t.disabledDrag,c=h.useState({x:0,y:0}),d=ge(c,2),u=d[0],f=d[1],m=h.useRef(null),b=h.useRef(null);h.useEffect(function(){f(a())},[s]),h.useEffect(function(){return function(){document.removeEventListener("mousemove",m.current),document.removeEventListener("mouseup",b.current),document.removeEventListener("touchmove",m.current),document.removeEventListener("touchend",b.current),m.current=null,b.current=null}},[]);var g=function(R){var P=oa(R),E=P.pageX,D=P.pageY,T=n.current.getBoundingClientRect(),A=T.x,$=T.y,I=T.width,O=T.height,z=e.current.getBoundingClientRect(),N=z.width,K=z.height,H=N/2,q=K/2,oe=Math.max(0,Math.min(E-A,I))-H,L=Math.max(0,Math.min(D-$,O))-q,ae={x:oe,y:r==="x"?u.y:L};if(N===0&&K===0||N!==K)return!1;o?.(ae)},y=function(R){R.preventDefault(),g(R)},x=function(R){R.preventDefault(),document.removeEventListener("mousemove",m.current),document.removeEventListener("mouseup",b.current),document.removeEventListener("touchmove",m.current),document.removeEventListener("touchend",b.current),m.current=null,b.current=null,i?.()},C=function(R){document.removeEventListener("mousemove",m.current),document.removeEventListener("mouseup",b.current),!l&&(g(R),document.addEventListener("mousemove",y),document.addEventListener("mouseup",x),document.addEventListener("touchmove",y),document.addEventListener("touchend",x),m.current=y,b.current=x)};return[u,C]}var Ii=function(e){var n=e.size,r=n===void 0?"default":n,o=e.color,i=e.prefixCls;return U.createElement("div",{className:ue("".concat(i,"-handler"),Me({},"".concat(i,"-handler-sm"),r==="small")),style:{backgroundColor:o}})},ji=function(e){var n=e.children,r=e.style,o=e.prefixCls;return U.createElement("div",{className:"".concat(o,"-palette"),style:Oe({position:"relative"},r)},n)},Oi=h.forwardRef(function(t,e){var n=t.children,r=t.x,o=t.y;return U.createElement("div",{ref:e,style:{position:"absolute",left:"".concat(r,"%"),top:"".concat(o,"%"),zIndex:1,transform:"translate(-50%, -50%)"}},n)}),ia=function(e){var n=e.color,r=e.onChange,o=e.prefixCls,i=e.onChangeComplete,a=e.disabled,s=h.useRef(),l=h.useRef(),c=h.useRef(n),d=mt(function(g){var y=fi({offset:g,targetRef:l,containerRef:s,color:n});c.current=y,r(y)}),u=Pi({color:n,containerRef:s,targetRef:l,calculate:function(){return hi(n)},onDragChange:d,onDragChangeComplete:function(){return i?.(c.current)},disabledDrag:a}),f=ge(u,2),m=f[0],b=f[1];return U.createElement("div",{ref:s,className:"".concat(o,"-select"),onMouseDown:b,onTouchStart:b},U.createElement(ji,{prefixCls:o},U.createElement(Oi,{x:m.x,y:m.y,ref:l},U.createElement(Ii,{color:n.toRgbString(),prefixCls:o})),U.createElement("div",{className:"".concat(o,"-saturation"),style:{backgroundColor:"hsl(".concat(n.toHsb().h,",100%, 50%)"),backgroundImage:"linear-gradient(0deg, #000, transparent),linear-gradient(90deg, #fff, hsla(0, 0%, 100%, 0))"}})))},sa=function(e,n){var r=Rt(e,{value:n}),o=ge(r,2),i=o[0],a=o[1],s=h.useMemo(function(){return gi(i)},[i]);return[s,a]},aa=function(e){var n=e.colors,r=e.children,o=e.direction,i=o===void 0?"to right":o,a=e.type,s=e.prefixCls,l=h.useMemo(function(){return n.map(function(c,d){var u=gi(c);return a==="alpha"&&d===n.length-1&&(u=new Wn(u.setA(1))),u.toRgbString()}).join(",")},[n,a]);return U.createElement("div",{className:"".concat(s,"-gradient"),style:{position:"absolute",inset:0,background:"linear-gradient(".concat(i,", ").concat(l,")")}},r)},la=function(e){var n=e.prefixCls,r=e.colors,o=e.disabled,i=e.onChange,a=e.onChangeComplete,s=e.color,l=e.type,c=h.useRef(),d=h.useRef(),u=h.useRef(s),f=function(P){return l==="hue"?P.getHue():P.a*100},m=mt(function(R){var P=fi({offset:R,targetRef:d,containerRef:c,color:s,type:l});u.current=P,i(f(P))}),b=Pi({color:s,targetRef:d,containerRef:c,calculate:function(){return hi(s,l)},onDragChange:m,onDragChangeComplete:function(){a(f(u.current))},direction:"x",disabledDrag:o}),g=ge(b,2),y=g[0],x=g[1],C=U.useMemo(function(){if(l==="hue"){var R=s.toHsb();R.s=1,R.b=1,R.a=1;var P=new Wn(R);return P}return s},[s,l]),S=U.useMemo(function(){return r.map(function(R){return"".concat(R.color," ").concat(R.percent,"%")})},[r]);return U.createElement("div",{ref:c,className:ue("".concat(n,"-slider"),"".concat(n,"-slider-").concat(l)),onMouseDown:x,onTouchStart:x},U.createElement(ji,{prefixCls:n},U.createElement(Oi,{x:y.x,y:y.y,ref:d},U.createElement(Ii,{size:"small",color:C.toHexString(),prefixCls:n})),U.createElement(aa,{colors:S,type:l,prefixCls:n})))};function ca(t){return h.useMemo(function(){var e=t||{},n=e.slider;return[n||la]},[t])}var ua=[{color:"rgb(255, 0, 0)",percent:0},{color:"rgb(255, 255, 0)",percent:17},{color:"rgb(0, 255, 0)",percent:33},{color:"rgb(0, 255, 255)",percent:50},{color:"rgb(0, 0, 255)",percent:67},{color:"rgb(255, 0, 255)",percent:83},{color:"rgb(255, 0, 0)",percent:100}],da=h.forwardRef(function(t,e){var n=t.value,r=t.defaultValue,o=t.prefixCls,i=o===void 0?ps:o,a=t.onChange,s=t.onChangeComplete,l=t.className,c=t.style,d=t.panelRender,u=t.disabledAlpha,f=u===void 0?!1:u,m=t.disabled,b=m===void 0?!1:m,g=t.components,y=ca(g),x=ge(y,1),C=x[0],S=sa(r||ms,n),R=ge(S,2),P=R[0],E=R[1],D=h.useMemo(function(){return P.setA(1).toRgbString()},[P]),T=function(L,ae){n||E(L),a?.(L,ae)},A=function(L){return new Wn(P.setHue(L))},$=function(L){return new Wn(P.setA(L/100))},I=function(L){T(A(L),{type:"hue",value:L})},O=function(L){T($(L),{type:"alpha",value:L})},z=function(L){s&&s(A(L))},N=function(L){s&&s($(L))},K=ue("".concat(i,"-panel"),l,Me({},"".concat(i,"-panel-disabled"),b)),H={prefixCls:i,disabled:b,color:P},q=U.createElement(U.Fragment,null,U.createElement(ia,Xe({onChange:T},H,{onChangeComplete:s})),U.createElement("div",{className:"".concat(i,"-slider-container")},U.createElement("div",{className:ue("".concat(i,"-slider-group"),Me({},"".concat(i,"-slider-group-disabled-alpha"),f))},U.createElement(C,Xe({},H,{type:"hue",colors:ua,min:0,max:359,value:P.getHue(),onChange:I,onChangeComplete:z})),!f&&U.createElement(C,Xe({},H,{type:"alpha",colors:[{percent:0,color:"rgba(255, 0, 4, 0)"},{percent:100,color:D}],min:0,max:100,value:P.a*100,onChange:O,onChangeComplete:N}))),U.createElement(pi,{color:P.toRgbString(),prefixCls:i})));return U.createElement("div",{className:K,style:c,ref:e},typeof d=="function"?d(q):q)});const nr=h.createContext(null);var fa=function(e){var n=e.activeTabOffset,r=e.horizontal,o=e.rtl,i=e.indicator,a=i===void 0?{}:i,s=a.size,l=a.align,c=l===void 0?"center":l,d=h.useState(),u=ge(d,2),f=u[0],m=u[1],b=h.useRef(),g=U.useCallback(function(x){return typeof s=="function"?s(x):typeof s=="number"?s:x},[s]);function y(){Xt.cancel(b.current)}return h.useEffect(function(){var x={};if(n)if(r){x.width=g(n.width);var C=o?"right":"left";c==="start"&&(x[C]=n[C]),c==="center"&&(x[C]=n[C]+n.width/2,x.transform=o?"translateX(50%)":"translateX(-50%)"),c==="end"&&(x[C]=n[C]+n.width,x.transform="translateX(-100%)")}else x.height=g(n.height),c==="start"&&(x.top=n.top),c==="center"&&(x.top=n.top+n.height/2,x.transform="translateY(-50%)"),c==="end"&&(x.top=n.top+n.height,x.transform="translateY(-100%)");return y(),b.current=Xt(function(){var S=f&&x&&Object.keys(x).every(function(R){var P=x[R],E=f[R];return typeof P=="number"&&typeof E=="number"?Math.round(P)===Math.round(E):P===E});S||m(x)}),y},[JSON.stringify(n),r,o,c,g]),{style:f}},Qr={width:0,height:0,left:0,top:0};function ha(t,e,n){return h.useMemo(function(){for(var r,o=new Map,i=e.get((r=t[0])===null||r===void 0?void 0:r.key)||Qr,a=i.left+i.width,s=0;s<t.length;s+=1){var l=t[s].key,c=e.get(l);if(!c){var d;c=e.get((d=t[s-1])===null||d===void 0?void 0:d.key)||Qr}var u=o.get(l)||Oe({},c);u.right=a-u.left-u.width,o.set(l,u)}return o},[t.map(function(r){return r.key}).join("_"),e,n])}function eo(t,e){var n=h.useRef(t),r=h.useState({}),o=ge(r,2),i=o[1];function a(s){var l=typeof s=="function"?s(n.current):s;l!==n.current&&e(l,n.current),n.current=l,i({})}return[n.current,a]}var ga=.1,to=.01,Ln=20,no=Math.pow(.995,Ln);function pa(t,e){var n=h.useState(),r=ge(n,2),o=r[0],i=r[1],a=h.useState(0),s=ge(a,2),l=s[0],c=s[1],d=h.useState(0),u=ge(d,2),f=u[0],m=u[1],b=h.useState(),g=ge(b,2),y=g[0],x=g[1],C=h.useRef();function S(A){var $=A.touches[0],I=$.screenX,O=$.screenY;i({x:I,y:O}),window.clearInterval(C.current)}function R(A){if(o){var $=A.touches[0],I=$.screenX,O=$.screenY;i({x:I,y:O});var z=I-o.x,N=O-o.y;e(z,N);var K=Date.now();c(K),m(K-l),x({x:z,y:N})}}function P(){if(o&&(i(null),x(null),y)){var A=y.x/f,$=y.y/f,I=Math.abs(A),O=Math.abs($);if(Math.max(I,O)<ga)return;var z=A,N=$;C.current=window.setInterval(function(){if(Math.abs(z)<to&&Math.abs(N)<to){window.clearInterval(C.current);return}z*=no,N*=no,e(z*Ln,N*Ln)},Ln)}}var E=h.useRef();function D(A){var $=A.deltaX,I=A.deltaY,O=0,z=Math.abs($),N=Math.abs(I);z===N?O=E.current==="x"?$:I:z>N?(O=$,E.current="x"):(O=I,E.current="y"),e(-O,-O)&&A.preventDefault()}var T=h.useRef(null);T.current={onTouchStart:S,onTouchMove:R,onTouchEnd:P,onWheel:D},h.useEffect(function(){function A(z){T.current.onTouchStart(z)}function $(z){T.current.onTouchMove(z)}function I(z){T.current.onTouchEnd(z)}function O(z){T.current.onWheel(z)}return document.addEventListener("touchmove",$,{passive:!1}),document.addEventListener("touchend",I,{passive:!0}),t.current.addEventListener("touchstart",A,{passive:!0}),t.current.addEventListener("wheel",O,{passive:!1}),function(){document.removeEventListener("touchmove",$),document.removeEventListener("touchend",I)}},[])}function Ti(t){var e=h.useState(0),n=ge(e,2),r=n[0],o=n[1],i=h.useRef(0),a=h.useRef();return a.current=t,vs(function(){var s;(s=a.current)===null||s===void 0||s.call(a)},[r]),function(){i.current===r&&(i.current+=1,o(i.current))}}function ma(t){var e=h.useRef([]),n=h.useState({}),r=ge(n,2),o=r[1],i=h.useRef(typeof t=="function"?t():t),a=Ti(function(){var l=i.current;e.current.forEach(function(c){l=c(l)}),e.current=[],i.current=l,o({})});function s(l){e.current.push(l),a()}return[i.current,s]}var ro={width:0,height:0,left:0,top:0,right:0};function va(t,e,n,r,o,i,a){var s=a.tabs,l=a.tabPosition,c=a.rtl,d,u,f;return["top","bottom"].includes(l)?(d="width",u=c?"right":"left",f=Math.abs(n)):(d="height",u="top",f=-n),h.useMemo(function(){if(!s.length)return[0,0];for(var m=s.length,b=m,g=0;g<m;g+=1){var y=t.get(s[g].key)||ro;if(Math.floor(y[u]+y[d])>Math.floor(f+e)){b=g-1;break}}for(var x=0,C=m-1;C>=0;C-=1){var S=t.get(s[C].key)||ro;if(S[u]<f){x=C+1;break}}return x>=b?[0,0]:[x,b]},[t,e,r,o,i,f,l,s.map(function(m){return m.key}).join("_"),c])}function oo(t){var e;return t instanceof Map?(e={},t.forEach(function(n,r){e[r]=n})):e=t,JSON.stringify(e)}var ba="TABS_DQ";function ki(t){return String(t).replace(/"/g,ba)}function Hr(t,e,n,r){return!(!n||r||t===!1||t===void 0&&(e===!1||e===null))}var Ai=h.forwardRef(function(t,e){var n=t.prefixCls,r=t.editable,o=t.locale,i=t.style;return!r||r.showAdd===!1?null:h.createElement("button",{ref:e,type:"button",className:"".concat(n,"-nav-add"),style:i,"aria-label":o?.addAriaLabel||"Add tab",onClick:function(s){r.onEdit("add",{event:s})}},r.addIcon||"+")}),io=h.forwardRef(function(t,e){var n=t.position,r=t.prefixCls,o=t.extra;if(!o)return null;var i,a={};return gt(o)==="object"&&!h.isValidElement(o)?a=o:a.right=o,n==="right"&&(i=a.right),n==="left"&&(i=a.left),i?h.createElement("div",{className:"".concat(r,"-extra-content"),ref:e},i):null}),ya=h.forwardRef(function(t,e){var n=t.prefixCls,r=t.id,o=t.tabs,i=t.locale,a=t.mobile,s=t.more,l=s===void 0?{}:s,c=t.style,d=t.className,u=t.editable,f=t.tabBarGutter,m=t.rtl,b=t.removeAriaLabel,g=t.onTabClick,y=t.getPopupContainer,x=t.popupClassName,C=h.useState(!1),S=ge(C,2),R=S[0],P=S[1],E=h.useState(null),D=ge(E,2),T=D[0],A=D[1],$=l.icon,I=$===void 0?"More":$,O="".concat(r,"-more-popup"),z="".concat(n,"-dropdown"),N=T!==null?"".concat(O,"-").concat(T):null,K=i?.dropdownAriaLabel;function H(se,Q){se.preventDefault(),se.stopPropagation(),u.onEdit("remove",{key:Q,event:se})}var q=h.createElement(bs,{onClick:function(Q){var le=Q.key,Z=Q.domEvent;g(le,Z),P(!1)},prefixCls:"".concat(z,"-menu"),id:O,tabIndex:-1,role:"listbox","aria-activedescendant":N,selectedKeys:[T],"aria-label":K!==void 0?K:"expanded dropdown"},o.map(function(se){var Q=se.closable,le=se.disabled,Z=se.closeIcon,ne=se.key,ce=se.label,Ce=Hr(Q,Z,u,le);return h.createElement(ys,{key:ne,id:"".concat(O,"-").concat(ne),role:"option","aria-controls":r&&"".concat(r,"-panel-").concat(ne),disabled:le},h.createElement("span",null,ce),Ce&&h.createElement("button",{type:"button","aria-label":b||"remove",tabIndex:0,className:"".concat(z,"-menu-item-remove"),onClick:function(he){he.stopPropagation(),H(he,ne)}},Z||u.removeIcon||"×"))}));function oe(se){for(var Q=o.filter(function(Ce){return!Ce.disabled}),le=Q.findIndex(function(Ce){return Ce.key===T})||0,Z=Q.length,ne=0;ne<Z;ne+=1){le=(le+se+Z)%Z;var ce=Q[le];if(!ce.disabled){A(ce.key);return}}}function L(se){var Q=se.which;if(!R){[_e.DOWN,_e.SPACE,_e.ENTER].includes(Q)&&(P(!0),se.preventDefault());return}switch(Q){case _e.UP:oe(-1),se.preventDefault();break;case _e.DOWN:oe(1),se.preventDefault();break;case _e.ESC:P(!1);break;case _e.SPACE:case _e.ENTER:T!==null&&g(T,se);break}}h.useEffect(function(){var se=document.getElementById(N);se&&se.scrollIntoView&&se.scrollIntoView(!1)},[T]),h.useEffect(function(){R||A(null)},[R]);var ae=Me({},m?"marginRight":"marginLeft",f);o.length||(ae.visibility="hidden",ae.order=1);var be=ue(Me({},"".concat(z,"-rtl"),m)),fe=a?null:h.createElement(Cs,Xe({prefixCls:z,overlay:q,visible:o.length?R:!1,onVisibleChange:P,overlayClassName:ue(be,x),mouseEnterDelay:.1,mouseLeaveDelay:.1,getPopupContainer:y},l),h.createElement("button",{type:"button",className:"".concat(n,"-nav-more"),style:ae,"aria-haspopup":"listbox","aria-controls":O,id:"".concat(r,"-more"),"aria-expanded":R,onKeyDown:L},I));return h.createElement("div",{className:ue("".concat(n,"-nav-operations"),d),style:c,ref:e},fe,h.createElement(Ai,{prefixCls:n,locale:i,editable:u}))});const Ca=h.memo(ya,function(t,e){return e.tabMoving});var xa=function(e){var n=e.prefixCls,r=e.id,o=e.active,i=e.focus,a=e.tab,s=a.key,l=a.label,c=a.disabled,d=a.closeIcon,u=a.icon,f=e.closable,m=e.renderWrapper,b=e.removeAriaLabel,g=e.editable,y=e.onClick,x=e.onFocus,C=e.onBlur,S=e.onKeyDown,R=e.onMouseDown,P=e.onMouseUp,E=e.style,D=e.tabCount,T=e.currentPosition,A="".concat(n,"-tab"),$=Hr(f,d,g,c);function I(H){c||y(H)}function O(H){H.preventDefault(),H.stopPropagation(),g.onEdit("remove",{key:s,event:H})}var z=h.useMemo(function(){return u&&typeof l=="string"?h.createElement("span",null,l):l},[l,u]),N=h.useRef(null);h.useEffect(function(){i&&N.current&&N.current.focus()},[i]);var K=h.createElement("div",{key:s,"data-node-key":ki(s),className:ue(A,Me(Me(Me(Me({},"".concat(A,"-with-remove"),$),"".concat(A,"-active"),o),"".concat(A,"-disabled"),c),"".concat(A,"-focus"),i)),style:E,onClick:I},h.createElement("div",{ref:N,role:"tab","aria-selected":o,id:r&&"".concat(r,"-tab-").concat(s),className:"".concat(A,"-btn"),"aria-controls":r&&"".concat(r,"-panel-").concat(s),"aria-disabled":c,tabIndex:c?null:o?0:-1,onClick:function(q){q.stopPropagation(),I(q)},onKeyDown:S,onMouseDown:R,onMouseUp:P,onFocus:x,onBlur:C},i&&h.createElement("div",{"aria-live":"polite",style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0}},"Tab ".concat(T," of ").concat(D)),u&&h.createElement("span",{className:"".concat(A,"-icon")},u),l&&z),$&&h.createElement("button",{type:"button",role:"tab","aria-label":b||"remove",tabIndex:o?0:-1,className:"".concat(A,"-remove"),onClick:function(q){q.stopPropagation(),O(q)}},d||g.removeIcon||"×"));return m?m(K):K},Sa=function(e,n){var r=e.offsetWidth,o=e.offsetHeight,i=e.offsetTop,a=e.offsetLeft,s=e.getBoundingClientRect(),l=s.width,c=s.height,d=s.left,u=s.top;return Math.abs(l-r)<1?[l,c,d-n.left,u-n.top]:[r,o,a,i]},Ut=function(e){var n=e.current||{},r=n.offsetWidth,o=r===void 0?0:r,i=n.offsetHeight,a=i===void 0?0:i;if(e.current){var s=e.current.getBoundingClientRect(),l=s.width,c=s.height;if(Math.abs(l-o)<1)return[l,c]}return[o,a]},Dn=function(e,n){return e[n?0:1]},so=h.forwardRef(function(t,e){var n=t.className,r=t.style,o=t.id,i=t.animated,a=t.activeKey,s=t.rtl,l=t.extra,c=t.editable,d=t.locale,u=t.tabPosition,f=t.tabBarGutter,m=t.children,b=t.onTabClick,g=t.onTabScroll,y=t.indicator,x=h.useContext(nr),C=x.prefixCls,S=x.tabs,R=h.useRef(null),P=h.useRef(null),E=h.useRef(null),D=h.useRef(null),T=h.useRef(null),A=h.useRef(null),$=h.useRef(null),I=u==="top"||u==="bottom",O=eo(0,function(de,V){I&&g&&g({direction:de>V?"left":"right"})}),z=ge(O,2),N=z[0],K=z[1],H=eo(0,function(de,V){!I&&g&&g({direction:de>V?"top":"bottom"})}),q=ge(H,2),oe=q[0],L=q[1],ae=h.useState([0,0]),be=ge(ae,2),fe=be[0],se=be[1],Q=h.useState([0,0]),le=ge(Q,2),Z=le[0],ne=le[1],ce=h.useState([0,0]),Ce=ge(ce,2),$e=Ce[0],he=Ce[1],xe=h.useState([0,0]),Re=ge(xe,2),ye=Re[0],ie=Re[1],p=ma(new Map),B=ge(p,2),w=B[0],M=B[1],j=ha(S,w,Z[0]),k=Dn(fe,I),Y=Dn(Z,I),W=Dn($e,I),X=Dn(ye,I),J=Math.floor(k)<Math.floor(Y+W),te=J?k-X:k-W,pe="".concat(C,"-nav-operations-hidden"),_=0,ee=0;I&&s?(_=0,ee=Math.max(0,Y-te)):(_=Math.min(0,te-Y),ee=0);function F(de){return de<_?_:de>ee?ee:de}var re=h.useRef(null),me=h.useState(),Se=ge(me,2),Ae=Se[0],We=Se[1];function Ne(){We(Date.now())}function Ee(){re.current&&clearTimeout(re.current)}pa(D,function(de,V){function ve(we,Be){we(function(Ve){var nt=F(Ve+Be);return nt})}return J?(I?ve(K,de):ve(L,V),Ee(),Ne(),!0):!1}),h.useEffect(function(){return Ee(),Ae&&(re.current=setTimeout(function(){We(0)},100)),Ee},[Ae]);var Te=va(j,te,I?N:oe,Y,W,X,Oe(Oe({},t),{},{tabs:S})),Pe=ge(Te,2),Ge=Pe[0],lt=Pe[1],ze=mt(function(){var de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a,V=j.get(de)||{width:0,height:0,left:0,right:0,top:0};if(I){var ve=N;s?V.right<N?ve=V.right:V.right+V.width>N+te&&(ve=V.right+V.width-te):V.left<-N?ve=-V.left:V.left+V.width>-N+te&&(ve=-(V.left+V.width-te)),L(0),K(F(ve))}else{var we=oe;V.top<-oe?we=-V.top:V.top+V.height>-oe+te&&(we=-(V.top+V.height-te)),K(0),L(F(we))}}),Le=h.useState(),Fe=ge(Le,2),ke=Fe[0],Qe=Fe[1],st=h.useState(!1),Je=ge(st,2),Sn=Je[0],wn=Je[1],ft=S.filter(function(de){return!de.disabled}).map(function(de){return de.key}),vt=function(V){var ve=ft.indexOf(ke||a),we=ft.length,Be=(ve+V+we)%we,Ve=ft[Be];Qe(Ve)},$n=function(V){var ve=V.code,we=s&&I,Be=ft[0],Ve=ft[ft.length-1];switch(ve){case"ArrowLeft":{I&&vt(we?1:-1);break}case"ArrowRight":{I&&vt(we?-1:1);break}case"ArrowUp":{V.preventDefault(),I||vt(-1);break}case"ArrowDown":{V.preventDefault(),I||vt(1);break}case"Home":{V.preventDefault(),Qe(Be);break}case"End":{V.preventDefault(),Qe(Ve);break}case"Enter":case"Space":{V.preventDefault(),b(ke??a,V);break}case"Backspace":case"Delete":{var nt=ft.indexOf(ke),Ke=S.find(function(it){return it.key===ke}),at=Hr(Ke?.closable,Ke?.closeIcon,c,Ke?.disabled);at&&(V.preventDefault(),V.stopPropagation(),c.onEdit("remove",{key:ke,event:V}),nt===ft.length-1?vt(-1):vt(1));break}}},Dt={};I?Dt[s?"marginRight":"marginLeft"]=f:Dt.marginTop=f;var Rn=S.map(function(de,V){var ve=de.key;return h.createElement(xa,{id:o,prefixCls:C,key:ve,tab:de,style:V===0?void 0:Dt,closable:de.closable,editable:c,active:ve===a,focus:ve===ke,renderWrapper:m,removeAriaLabel:d?.removeAriaLabel,tabCount:ft.length,currentPosition:V+1,onClick:function(Be){b(ve,Be)},onKeyDown:$n,onFocus:function(){Sn||Qe(ve),ze(ve),Ne(),D.current&&(s||(D.current.scrollLeft=0),D.current.scrollTop=0)},onBlur:function(){Qe(void 0)},onMouseDown:function(){wn(!0)},onMouseUp:function(){wn(!1)}})}),En=function(){return M(function(){var V,ve=new Map,we=(V=T.current)===null||V===void 0?void 0:V.getBoundingClientRect();return S.forEach(function(Be){var Ve,nt=Be.key,Ke=(Ve=T.current)===null||Ve===void 0?void 0:Ve.querySelector('[data-node-key="'.concat(ki(nt),'"]'));if(Ke){var at=Sa(Ke,we),it=ge(at,4),Mt=it[0],bt=it[1],qt=it[2],kn=it[3];ve.set(nt,{width:Mt,height:bt,left:qt,top:kn})}}),ve})};h.useEffect(function(){En()},[S.map(function(de){return de.key}).join("_")]);var Nt=Ti(function(){var de=Ut(R),V=Ut(P),ve=Ut(E);se([de[0]-V[0]-ve[0],de[1]-V[1]-ve[1]]);var we=Ut($);he(we);var Be=Ut(A);ie(Be);var Ve=Ut(T);ne([Ve[0]-we[0],Ve[1]-we[1]]),En()}),ln=S.slice(0,Ge),Mn=S.slice(lt+1),Pn=[].concat(Ue(ln),Ue(Mn)),In=j.get(a),jn=fa({activeTabOffset:In,horizontal:I,indicator:y,rtl:s}),On=jn.style;h.useEffect(function(){ze()},[a,_,ee,oo(In),oo(j),I]),h.useEffect(function(){Nt()},[s]);var Et=!!Pn.length,zt="".concat(C,"-nav-wrap"),Kt,Vt,cn,Tn;return I?s?(Vt=N>0,Kt=N!==ee):(Kt=N<0,Vt=N!==_):(cn=oe<0,Tn=oe!==_),h.createElement(ir,{onResize:Nt},h.createElement("div",{ref:xs(e,R),role:"tablist","aria-orientation":I?"horizontal":"vertical",className:ue("".concat(C,"-nav"),n),style:r,onKeyDown:function(){Ne()}},h.createElement(io,{ref:P,position:"left",extra:l,prefixCls:C}),h.createElement(ir,{onResize:Nt},h.createElement("div",{className:ue(zt,Me(Me(Me(Me({},"".concat(zt,"-ping-left"),Kt),"".concat(zt,"-ping-right"),Vt),"".concat(zt,"-ping-top"),cn),"".concat(zt,"-ping-bottom"),Tn)),ref:D},h.createElement(ir,{onResize:Nt},h.createElement("div",{ref:T,className:"".concat(C,"-nav-list"),style:{transform:"translate(".concat(N,"px, ").concat(oe,"px)"),transition:Ae?"none":void 0}},Rn,h.createElement(Ai,{ref:$,prefixCls:C,locale:d,editable:c,style:Oe(Oe({},Rn.length===0?void 0:Dt),{},{visibility:Et?"hidden":null})}),h.createElement("div",{className:ue("".concat(C,"-ink-bar"),Me({},"".concat(C,"-ink-bar-animated"),i.inkBar)),style:On}))))),h.createElement(Ca,Xe({},t,{removeAriaLabel:d?.removeAriaLabel,ref:A,prefixCls:C,tabs:Pn,className:!Et&&pe,tabMoving:!!Ae})),h.createElement(io,{ref:E,position:"right",extra:l,prefixCls:C})))}),Bi=h.forwardRef(function(t,e){var n=t.prefixCls,r=t.className,o=t.style,i=t.id,a=t.active,s=t.tabKey,l=t.children;return h.createElement("div",{id:i&&"".concat(i,"-panel-").concat(s),role:"tabpanel",tabIndex:a?0:-1,"aria-labelledby":i&&"".concat(i,"-tab-").concat(s),"aria-hidden":!a,style:o,className:ue(n,a&&"".concat(n,"-active"),r),ref:e},l)}),wa=["renderTabBar"],$a=["label","key"],Ra=function(e){var n=e.renderTabBar,r=kt(e,wa),o=h.useContext(nr),i=o.tabs;if(n){var a=Oe(Oe({},r),{},{panes:i.map(function(s){var l=s.label,c=s.key,d=kt(s,$a);return h.createElement(Bi,Xe({tab:l,key:c,tabKey:c},d))})});return n(a,so)}return h.createElement(so,r)},Ea=["key","forceRender","style","className","destroyInactiveTabPane"],Ma=function(e){var n=e.id,r=e.activeKey,o=e.animated,i=e.tabPosition,a=e.destroyInactiveTabPane,s=h.useContext(nr),l=s.prefixCls,c=s.tabs,d=o.tabPane,u="".concat(l,"-tabpane");return h.createElement("div",{className:ue("".concat(l,"-content-holder"))},h.createElement("div",{className:ue("".concat(l,"-content"),"".concat(l,"-content-").concat(i),Me({},"".concat(l,"-content-animated"),d))},c.map(function(f){var m=f.key,b=f.forceRender,g=f.style,y=f.className,x=f.destroyInactiveTabPane,C=kt(f,Ea),S=m===r;return h.createElement(mi,Xe({key:m,visible:S,forceRender:b,removeOnLeave:!!(a||x),leavedClassName:"".concat(u,"-hidden")},o.tabPaneMotion),function(R,P){var E=R.style,D=R.className;return h.createElement(Bi,Xe({},C,{prefixCls:u,id:n,tabKey:m,animated:d,active:S,style:Oe(Oe({},g),E),className:ue(y,D),ref:P}))})})))};function Pa(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{inkBar:!0,tabPane:!1},e;return t===!1?e={inkBar:!1,tabPane:!1}:t===!0?e={inkBar:!0,tabPane:!1}:e=Oe({inkBar:!0},gt(t)==="object"?t:{}),e.tabPaneMotion&&e.tabPane===void 0&&(e.tabPane=!0),!e.tabPaneMotion&&e.tabPane&&(e.tabPane=!1),e}var Ia=["id","prefixCls","className","items","direction","activeKey","defaultActiveKey","editable","animated","tabPosition","tabBarGutter","tabBarStyle","tabBarExtraContent","locale","more","destroyInactiveTabPane","renderTabBar","onChange","onTabClick","onTabScroll","getPopupContainer","popupClassName","indicator"],ao=0,ja=h.forwardRef(function(t,e){var n=t.id,r=t.prefixCls,o=r===void 0?"rc-tabs":r,i=t.className,a=t.items,s=t.direction,l=t.activeKey,c=t.defaultActiveKey,d=t.editable,u=t.animated,f=t.tabPosition,m=f===void 0?"top":f,b=t.tabBarGutter,g=t.tabBarStyle,y=t.tabBarExtraContent,x=t.locale,C=t.more,S=t.destroyInactiveTabPane,R=t.renderTabBar,P=t.onChange,E=t.onTabClick,D=t.onTabScroll,T=t.getPopupContainer,A=t.popupClassName,$=t.indicator,I=kt(t,Ia),O=h.useMemo(function(){return(a||[]).filter(function(ye){return ye&&gt(ye)==="object"&&"key"in ye})},[a]),z=s==="rtl",N=Pa(u),K=h.useState(!1),H=ge(K,2),q=H[0],oe=H[1];h.useEffect(function(){oe(Ss())},[]);var L=Rt(function(){var ye;return(ye=O[0])===null||ye===void 0?void 0:ye.key},{value:l,defaultValue:c}),ae=ge(L,2),be=ae[0],fe=ae[1],se=h.useState(function(){return O.findIndex(function(ye){return ye.key===be})}),Q=ge(se,2),le=Q[0],Z=Q[1];h.useEffect(function(){var ye=O.findIndex(function(p){return p.key===be});if(ye===-1){var ie;ye=Math.max(0,Math.min(le,O.length-1)),fe((ie=O[ye])===null||ie===void 0?void 0:ie.key)}Z(ye)},[O.map(function(ye){return ye.key}).join("_"),be,le]);var ne=Rt(null,{value:n}),ce=ge(ne,2),Ce=ce[0],$e=ce[1];h.useEffect(function(){n||($e("rc-tabs-".concat(ao)),ao+=1)},[]);function he(ye,ie){E?.(ye,ie);var p=ye!==be;fe(ye),p&&P?.(ye)}var xe={id:Ce,activeKey:be,animated:N,tabPosition:m,rtl:z,mobile:q},Re=Oe(Oe({},xe),{},{editable:d,locale:x,more:C,tabBarGutter:b,onTabClick:he,onTabScroll:D,extra:y,style:g,panes:null,getPopupContainer:T,popupClassName:A,indicator:$});return h.createElement(nr.Provider,{value:{tabs:O,prefixCls:o}},h.createElement("div",Xe({ref:e,id:n,className:ue(o,"".concat(o,"-").concat(m),Me(Me(Me({},"".concat(o,"-mobile"),q),"".concat(o,"-editable"),d),"".concat(o,"-rtl"),z),i)},I),h.createElement(Ra,Xe({},Re,{renderTabBar:R})),h.createElement(Ma,Xe({destroyInactiveTabPane:S},xe,{animated:N}))))});const Oa={motionAppear:!1,motionEnter:!0,motionLeave:!0};function Ta(t,e={inkBar:!0,tabPane:!1}){let n;return e===!1?n={inkBar:!1,tabPane:!1}:e===!0?n={inkBar:!0,tabPane:!0}:n=Object.assign({inkBar:!0},typeof e=="object"?e:{}),n.tabPane&&(n.tabPaneMotion=Object.assign(Object.assign({},Oa),{motionName:ws(t,"switch")})),n}var ka=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Aa(t){return t.filter(e=>e)}function Ba(t,e){if(t)return t.map(r=>{var o;const i=(o=r.destroyOnHidden)!==null&&o!==void 0?o:r.destroyInactiveTabPane;return Object.assign(Object.assign({},r),{destroyInactiveTabPane:i})});const n=vi(e).map(r=>{if(h.isValidElement(r)){const{key:o,props:i}=r,a=i||{},{tab:s}=a,l=ka(a,["tab"]);return Object.assign(Object.assign({key:String(o)},l),{label:s})}return null});return Aa(n)}const Da=t=>{const{componentCls:e,motionDurationSlow:n}=t;return[{[e]:{[`${e}-switch`]:{"&-appear, &-enter":{transition:"none","&-start":{opacity:0},"&-active":{opacity:1,transition:`opacity ${n}`}},"&-leave":{position:"absolute",transition:"none",inset:0,"&-start":{opacity:1},"&-active":{opacity:0,transition:`opacity ${n}`}}}}},[Ur(t,"slide-up"),Ur(t,"slide-down")]]},Na=t=>{const{componentCls:e,tabsCardPadding:n,cardBg:r,cardGutter:o,colorBorderSecondary:i,itemSelectedColor:a}=t;return{[`${e}-card`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{margin:0,padding:n,background:r,border:`${G(t.lineWidth)} ${t.lineType} ${i}`,transition:`all ${t.motionDurationSlow} ${t.motionEaseInOut}`},[`${e}-tab-active`]:{color:a,background:t.colorBgContainer},[`${e}-tab-focus:has(${e}-tab-btn:focus-visible)`]:Dr(t,-3),[`& ${e}-tab${e}-tab-focus ${e}-tab-btn:focus-visible`]:{outline:"none"},[`${e}-ink-bar`]:{visibility:"hidden"}},[`&${e}-top, &${e}-bottom`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab + ${e}-tab`]:{marginLeft:{_skip_check_:!0,value:G(o)}}}},[`&${e}-top`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{borderRadius:`${G(t.borderRadiusLG)} ${G(t.borderRadiusLG)} 0 0`},[`${e}-tab-active`]:{borderBottomColor:t.colorBgContainer}}},[`&${e}-bottom`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{borderRadius:`0 0 ${G(t.borderRadiusLG)} ${G(t.borderRadiusLG)}`},[`${e}-tab-active`]:{borderTopColor:t.colorBgContainer}}},[`&${e}-left, &${e}-right`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab + ${e}-tab`]:{marginTop:G(o)}}},[`&${e}-left`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{borderRadius:{_skip_check_:!0,value:`${G(t.borderRadiusLG)} 0 0 ${G(t.borderRadiusLG)}`}},[`${e}-tab-active`]:{borderRightColor:{_skip_check_:!0,value:t.colorBgContainer}}}},[`&${e}-right`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{borderRadius:{_skip_check_:!0,value:`0 ${G(t.borderRadiusLG)} ${G(t.borderRadiusLG)} 0`}},[`${e}-tab-active`]:{borderLeftColor:{_skip_check_:!0,value:t.colorBgContainer}}}}}}},za=t=>{const{componentCls:e,itemHoverColor:n,dropdownEdgeChildVerticalPadding:r}=t;return{[`${e}-dropdown`]:Object.assign(Object.assign({},sn(t)),{position:"absolute",top:-9999,left:{_skip_check_:!0,value:-9999},zIndex:t.zIndexPopup,display:"block","&-hidden":{display:"none"},[`${e}-dropdown-menu`]:{maxHeight:t.tabsDropdownHeight,margin:0,padding:`${G(r)} 0`,overflowX:"hidden",overflowY:"auto",textAlign:{_skip_check_:!0,value:"left"},listStyleType:"none",backgroundColor:t.colorBgContainer,backgroundClip:"padding-box",borderRadius:t.borderRadiusLG,outline:"none",boxShadow:t.boxShadowSecondary,"&-item":Object.assign(Object.assign({},Zn),{display:"flex",alignItems:"center",minWidth:t.tabsDropdownWidth,margin:0,padding:`${G(t.paddingXXS)} ${G(t.paddingSM)}`,color:t.colorText,fontWeight:"normal",fontSize:t.fontSize,lineHeight:t.lineHeight,cursor:"pointer",transition:`all ${t.motionDurationSlow}`,"> span":{flex:1,whiteSpace:"nowrap"},"&-remove":{flex:"none",marginLeft:{_skip_check_:!0,value:t.marginSM},color:t.colorIcon,fontSize:t.fontSizeSM,background:"transparent",border:0,cursor:"pointer","&:hover":{color:n}},"&:hover":{background:t.controlItemBgHover},"&-disabled":{"&, &:hover":{color:t.colorTextDisabled,background:"transparent",cursor:"not-allowed"}}})}})}},La=t=>{const{componentCls:e,margin:n,colorBorderSecondary:r,horizontalMargin:o,verticalItemPadding:i,verticalItemMargin:a,calc:s}=t;return{[`${e}-top, ${e}-bottom`]:{flexDirection:"column",[`> ${e}-nav, > div > ${e}-nav`]:{margin:o,"&::before":{position:"absolute",right:{_skip_check_:!0,value:0},left:{_skip_check_:!0,value:0},borderBottom:`${G(t.lineWidth)} ${t.lineType} ${r}`,content:"''"},[`${e}-ink-bar`]:{height:t.lineWidthBold,"&-animated":{transition:`width ${t.motionDurationSlow}, left ${t.motionDurationSlow},
            right ${t.motionDurationSlow}`}},[`${e}-nav-wrap`]:{"&::before, &::after":{top:0,bottom:0,width:t.controlHeight},"&::before":{left:{_skip_check_:!0,value:0},boxShadow:t.boxShadowTabsOverflowLeft},"&::after":{right:{_skip_check_:!0,value:0},boxShadow:t.boxShadowTabsOverflowRight},[`&${e}-nav-wrap-ping-left::before`]:{opacity:1},[`&${e}-nav-wrap-ping-right::after`]:{opacity:1}}}},[`${e}-top`]:{[`> ${e}-nav,
        > div > ${e}-nav`]:{"&::before":{bottom:0},[`${e}-ink-bar`]:{bottom:0}}},[`${e}-bottom`]:{[`> ${e}-nav, > div > ${e}-nav`]:{order:1,marginTop:n,marginBottom:0,"&::before":{top:0},[`${e}-ink-bar`]:{top:0}},[`> ${e}-content-holder, > div > ${e}-content-holder`]:{order:0}},[`${e}-left, ${e}-right`]:{[`> ${e}-nav, > div > ${e}-nav`]:{flexDirection:"column",minWidth:s(t.controlHeight).mul(1.25).equal(),[`${e}-tab`]:{padding:i,textAlign:"center"},[`${e}-tab + ${e}-tab`]:{margin:a},[`${e}-nav-wrap`]:{flexDirection:"column","&::before, &::after":{right:{_skip_check_:!0,value:0},left:{_skip_check_:!0,value:0},height:t.controlHeight},"&::before":{top:0,boxShadow:t.boxShadowTabsOverflowTop},"&::after":{bottom:0,boxShadow:t.boxShadowTabsOverflowBottom},[`&${e}-nav-wrap-ping-top::before`]:{opacity:1},[`&${e}-nav-wrap-ping-bottom::after`]:{opacity:1}},[`${e}-ink-bar`]:{width:t.lineWidthBold,"&-animated":{transition:`height ${t.motionDurationSlow}, top ${t.motionDurationSlow}`}},[`${e}-nav-list, ${e}-nav-operations`]:{flex:"1 0 auto",flexDirection:"column"}}},[`${e}-left`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-ink-bar`]:{right:{_skip_check_:!0,value:0}}},[`> ${e}-content-holder, > div > ${e}-content-holder`]:{marginLeft:{_skip_check_:!0,value:G(s(t.lineWidth).mul(-1).equal())},borderLeft:{_skip_check_:!0,value:`${G(t.lineWidth)} ${t.lineType} ${t.colorBorder}`},[`> ${e}-content > ${e}-tabpane`]:{paddingLeft:{_skip_check_:!0,value:t.paddingLG}}}},[`${e}-right`]:{[`> ${e}-nav, > div > ${e}-nav`]:{order:1,[`${e}-ink-bar`]:{left:{_skip_check_:!0,value:0}}},[`> ${e}-content-holder, > div > ${e}-content-holder`]:{order:0,marginRight:{_skip_check_:!0,value:s(t.lineWidth).mul(-1).equal()},borderRight:{_skip_check_:!0,value:`${G(t.lineWidth)} ${t.lineType} ${t.colorBorder}`},[`> ${e}-content > ${e}-tabpane`]:{paddingRight:{_skip_check_:!0,value:t.paddingLG}}}}}},_a=t=>{const{componentCls:e,cardPaddingSM:n,cardPaddingLG:r,cardHeightSM:o,cardHeightLG:i,horizontalItemPaddingSM:a,horizontalItemPaddingLG:s}=t;return{[e]:{"&-small":{[`> ${e}-nav`]:{[`${e}-tab`]:{padding:a,fontSize:t.titleFontSizeSM}}},"&-large":{[`> ${e}-nav`]:{[`${e}-tab`]:{padding:s,fontSize:t.titleFontSizeLG,lineHeight:t.lineHeightLG}}}},[`${e}-card`]:{[`&${e}-small`]:{[`> ${e}-nav`]:{[`${e}-tab`]:{padding:n},[`${e}-nav-add`]:{minWidth:o,minHeight:o}},[`&${e}-bottom`]:{[`> ${e}-nav ${e}-tab`]:{borderRadius:`0 0 ${G(t.borderRadius)} ${G(t.borderRadius)}`}},[`&${e}-top`]:{[`> ${e}-nav ${e}-tab`]:{borderRadius:`${G(t.borderRadius)} ${G(t.borderRadius)} 0 0`}},[`&${e}-right`]:{[`> ${e}-nav ${e}-tab`]:{borderRadius:{_skip_check_:!0,value:`0 ${G(t.borderRadius)} ${G(t.borderRadius)} 0`}}},[`&${e}-left`]:{[`> ${e}-nav ${e}-tab`]:{borderRadius:{_skip_check_:!0,value:`${G(t.borderRadius)} 0 0 ${G(t.borderRadius)}`}}}},[`&${e}-large`]:{[`> ${e}-nav`]:{[`${e}-tab`]:{padding:r},[`${e}-nav-add`]:{minWidth:i,minHeight:i}}}}}},Ha=t=>{const{componentCls:e,itemActiveColor:n,itemHoverColor:r,iconCls:o,tabsHorizontalItemMargin:i,horizontalItemPadding:a,itemSelectedColor:s,itemColor:l}=t,c=`${e}-tab`;return{[c]:{position:"relative",WebkitTouchCallout:"none",WebkitTapHighlightColor:"transparent",display:"inline-flex",alignItems:"center",padding:a,fontSize:t.titleFontSize,background:"transparent",border:0,outline:"none",cursor:"pointer",color:l,"&-btn, &-remove":{"&:focus:not(:focus-visible), &:active":{color:n}},"&-btn":{outline:"none",transition:`all ${t.motionDurationSlow}`,[`${c}-icon:not(:last-child)`]:{marginInlineEnd:t.marginSM}},"&-remove":Object.assign({flex:"none",marginRight:{_skip_check_:!0,value:t.calc(t.marginXXS).mul(-1).equal()},marginLeft:{_skip_check_:!0,value:t.marginXS},color:t.colorIcon,fontSize:t.fontSizeSM,background:"transparent",border:"none",outline:"none",cursor:"pointer",transition:`all ${t.motionDurationSlow}`,"&:hover":{color:t.colorTextHeading}},Fn(t)),"&:hover":{color:r},[`&${c}-active ${c}-btn`]:{color:s,textShadow:t.tabsActiveTextShadow},[`&${c}-focus ${c}-btn:focus-visible`]:Dr(t),[`&${c}-disabled`]:{color:t.colorTextDisabled,cursor:"not-allowed"},[`&${c}-disabled ${c}-btn, &${c}-disabled ${e}-remove`]:{"&:focus, &:active":{color:t.colorTextDisabled}},[`& ${c}-remove ${o}`]:{margin:0},[`${o}:not(:last-child)`]:{marginRight:{_skip_check_:!0,value:t.marginSM}}},[`${c} + ${c}`]:{margin:{_skip_check_:!0,value:i}}}},Wa=t=>{const{componentCls:e,tabsHorizontalItemMarginRTL:n,iconCls:r,cardGutter:o,calc:i}=t;return{[`${e}-rtl`]:{direction:"rtl",[`${e}-nav`]:{[`${e}-tab`]:{margin:{_skip_check_:!0,value:n},[`${e}-tab:last-of-type`]:{marginLeft:{_skip_check_:!0,value:0}},[r]:{marginRight:{_skip_check_:!0,value:0},marginLeft:{_skip_check_:!0,value:G(t.marginSM)}},[`${e}-tab-remove`]:{marginRight:{_skip_check_:!0,value:G(t.marginXS)},marginLeft:{_skip_check_:!0,value:G(i(t.marginXXS).mul(-1).equal())},[r]:{margin:0}}}},[`&${e}-left`]:{[`> ${e}-nav`]:{order:1},[`> ${e}-content-holder`]:{order:0}},[`&${e}-right`]:{[`> ${e}-nav`]:{order:0},[`> ${e}-content-holder`]:{order:1}},[`&${e}-card${e}-top, &${e}-card${e}-bottom`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab + ${e}-tab`]:{marginRight:{_skip_check_:!0,value:o},marginLeft:{_skip_check_:!0,value:0}}}}},[`${e}-dropdown-rtl`]:{direction:"rtl"},[`${e}-menu-item`]:{[`${e}-dropdown-rtl`]:{textAlign:{_skip_check_:!0,value:"right"}}}}},Fa=t=>{const{componentCls:e,tabsCardPadding:n,cardHeight:r,cardGutter:o,itemHoverColor:i,itemActiveColor:a,colorBorderSecondary:s}=t;return{[e]:Object.assign(Object.assign(Object.assign(Object.assign({},sn(t)),{display:"flex",[`> ${e}-nav, > div > ${e}-nav`]:{position:"relative",display:"flex",flex:"none",alignItems:"center",[`${e}-nav-wrap`]:{position:"relative",display:"flex",flex:"auto",alignSelf:"stretch",overflow:"hidden",whiteSpace:"nowrap",transform:"translate(0)","&::before, &::after":{position:"absolute",zIndex:1,opacity:0,transition:`opacity ${t.motionDurationSlow}`,content:"''",pointerEvents:"none"}},[`${e}-nav-list`]:{position:"relative",display:"flex",transition:`opacity ${t.motionDurationSlow}`},[`${e}-nav-operations`]:{display:"flex",alignSelf:"stretch"},[`${e}-nav-operations-hidden`]:{position:"absolute",visibility:"hidden",pointerEvents:"none"},[`${e}-nav-more`]:{position:"relative",padding:n,background:"transparent",border:0,color:t.colorText,"&::after":{position:"absolute",right:{_skip_check_:!0,value:0},bottom:0,left:{_skip_check_:!0,value:0},height:t.calc(t.controlHeightLG).div(8).equal(),transform:"translateY(100%)",content:"''"}},[`${e}-nav-add`]:Object.assign({minWidth:r,minHeight:r,marginLeft:{_skip_check_:!0,value:o},background:"transparent",border:`${G(t.lineWidth)} ${t.lineType} ${s}`,borderRadius:`${G(t.borderRadiusLG)} ${G(t.borderRadiusLG)} 0 0`,outline:"none",cursor:"pointer",color:t.colorText,transition:`all ${t.motionDurationSlow} ${t.motionEaseInOut}`,"&:hover":{color:i},"&:active, &:focus:not(:focus-visible)":{color:a}},Fn(t,-3))},[`${e}-extra-content`]:{flex:"none"},[`${e}-ink-bar`]:{position:"absolute",background:t.inkBarColor,pointerEvents:"none"}}),Ha(t)),{[`${e}-content`]:{position:"relative",width:"100%"},[`${e}-content-holder`]:{flex:"auto",minWidth:0,minHeight:0},[`${e}-tabpane`]:Object.assign(Object.assign({},Fn(t)),{"&-hidden":{display:"none"}})}),[`${e}-centered`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-nav-wrap`]:{[`&:not([class*='${e}-nav-wrap-ping']) > ${e}-nav-list`]:{margin:"auto"}}}}}},Xa=t=>{const{cardHeight:e,cardHeightSM:n,cardHeightLG:r,controlHeight:o,controlHeightLG:i}=t,a=e||i,s=n||o,l=r||i+8;return{zIndexPopup:t.zIndexPopupBase+50,cardBg:t.colorFillAlter,cardHeight:a,cardHeightSM:s,cardHeightLG:l,cardPadding:`${(a-t.fontHeight)/2-t.lineWidth}px ${t.padding}px`,cardPaddingSM:`${(s-t.fontHeight)/2-t.lineWidth}px ${t.paddingXS}px`,cardPaddingLG:`${(l-t.fontHeightLG)/2-t.lineWidth}px ${t.padding}px`,titleFontSize:t.fontSize,titleFontSizeLG:t.fontSizeLG,titleFontSizeSM:t.fontSize,inkBarColor:t.colorPrimary,horizontalMargin:`0 0 ${t.margin}px 0`,horizontalItemGutter:32,horizontalItemMargin:"",horizontalItemMarginRTL:"",horizontalItemPadding:`${t.paddingSM}px 0`,horizontalItemPaddingSM:`${t.paddingXS}px 0`,horizontalItemPaddingLG:`${t.padding}px 0`,verticalItemPadding:`${t.paddingXS}px ${t.paddingLG}px`,verticalItemMargin:`${t.margin}px 0 0 0`,itemColor:t.colorText,itemSelectedColor:t.colorPrimary,itemHoverColor:t.colorPrimaryHover,itemActiveColor:t.colorPrimaryActive,cardGutter:t.marginXXS/2}},Ya=rn("Tabs",t=>{const e=on(t,{tabsCardPadding:t.cardPadding,dropdownEdgeChildVerticalPadding:t.paddingXXS,tabsActiveTextShadow:"0 0 0.25px currentcolor",tabsDropdownHeight:200,tabsDropdownWidth:120,tabsHorizontalItemMargin:`0 0 0 ${G(t.horizontalItemGutter)}`,tabsHorizontalItemMarginRTL:`0 0 0 ${G(t.horizontalItemGutter)}`});return[_a(e),Wa(e),La(e),za(e),Na(e),Fa(e),Da(e)]},Xa),Ga=()=>null;var Ka=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Di=t=>{var e,n,r,o,i,a,s,l,c,d,u;const{type:f,className:m,rootClassName:b,size:g,onEdit:y,hideAdd:x,centered:C,addIcon:S,removeIcon:R,moreIcon:P,more:E,popupClassName:D,children:T,items:A,animated:$,style:I,indicatorSize:O,indicator:z,destroyInactiveTabPane:N,destroyOnHidden:K}=t,H=Ka(t,["type","className","rootClassName","size","onEdit","hideAdd","centered","addIcon","removeIcon","moreIcon","more","popupClassName","children","items","animated","style","indicatorSize","indicator","destroyInactiveTabPane","destroyOnHidden"]),{prefixCls:q}=H,{direction:oe,tabs:L,getPrefixCls:ae,getPopupContainer:be}=h.useContext(Bt),fe=ae("tabs",q),se=bi(fe),[Q,le,Z]=Ya(fe,se);let ne;f==="editable-card"&&(ne={onEdit:(ye,{key:ie,event:p})=>{y?.(ye==="add"?p:ie,ye)},removeIcon:(e=R??L?.removeIcon)!==null&&e!==void 0?e:h.createElement(yi,null),addIcon:(S??L?.addIcon)||h.createElement(Yn,null),showAdd:x!==!0});const ce=ae(),Ce=Qn(g),$e=Ba(A,T),he=Ta(fe,$),xe=Object.assign(Object.assign({},L?.style),I),Re={align:(n=z?.align)!==null&&n!==void 0?n:(r=L?.indicator)===null||r===void 0?void 0:r.align,size:(s=(i=(o=z?.size)!==null&&o!==void 0?o:O)!==null&&i!==void 0?i:(a=L?.indicator)===null||a===void 0?void 0:a.size)!==null&&s!==void 0?s:L?.indicatorSize};return Q(h.createElement(ja,Object.assign({direction:oe,getPopupContainer:be},H,{items:$e,className:ue({[`${fe}-${Ce}`]:Ce,[`${fe}-card`]:["card","editable-card"].includes(f),[`${fe}-editable-card`]:f==="editable-card",[`${fe}-centered`]:C},L?.className,m,b,le,Z,se),popupClassName:ue(D,le,Z,se),style:xe,editable:ne,more:Object.assign({icon:(u=(d=(c=(l=L?.more)===null||l===void 0?void 0:l.icon)!==null&&c!==void 0?c:L?.moreIcon)!==null&&d!==void 0?d:P)!==null&&u!==void 0?u:h.createElement($s,null),transitionName:`${ce}-slide-up`},E),prefixCls:fe,animated:he,indicator:Re,destroyInactiveTabPane:K??N})))};Di.TabPane=Ga;var Va=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Ni=t=>{var{prefixCls:e,className:n,hoverable:r=!0}=t,o=Va(t,["prefixCls","className","hoverable"]);const{getPrefixCls:i}=h.useContext(Bt),a=i("card",e),s=ue(`${a}-grid`,n,{[`${a}-grid-hoverable`]:r});return h.createElement("div",Object.assign({},o,{className:s}))},qa=t=>{const{antCls:e,componentCls:n,headerHeight:r,headerPadding:o,tabsMarginBottom:i}=t;return Object.assign(Object.assign({display:"flex",justifyContent:"center",flexDirection:"column",minHeight:r,marginBottom:-1,padding:`0 ${G(o)}`,color:t.colorTextHeading,fontWeight:t.fontWeightStrong,fontSize:t.headerFontSize,background:t.headerBg,borderBottom:`${G(t.lineWidth)} ${t.lineType} ${t.colorBorderSecondary}`,borderRadius:`${G(t.borderRadiusLG)} ${G(t.borderRadiusLG)} 0 0`},er()),{"&-wrapper":{width:"100%",display:"flex",alignItems:"center"},"&-title":Object.assign(Object.assign({display:"inline-block",flex:1},Zn),{[`
          > ${n}-typography,
          > ${n}-typography-edit-content
        `]:{insetInlineStart:0,marginTop:0,marginBottom:0}}),[`${e}-tabs-top`]:{clear:"both",marginBottom:i,color:t.colorText,fontWeight:"normal",fontSize:t.fontSize,"&-bar":{borderBottom:`${G(t.lineWidth)} ${t.lineType} ${t.colorBorderSecondary}`}}})},Ua=t=>{const{cardPaddingBase:e,colorBorderSecondary:n,cardShadow:r,lineWidth:o}=t;return{width:"33.33%",padding:e,border:0,borderRadius:0,boxShadow:`
      ${G(o)} 0 0 0 ${n},
      0 ${G(o)} 0 0 ${n},
      ${G(o)} ${G(o)} 0 0 ${n},
      ${G(o)} 0 0 0 ${n} inset,
      0 ${G(o)} 0 0 ${n} inset;
    `,transition:`all ${t.motionDurationMid}`,"&-hoverable:hover":{position:"relative",zIndex:1,boxShadow:r}}},Ja=t=>{const{componentCls:e,iconCls:n,actionsLiMargin:r,cardActionsIconSize:o,colorBorderSecondary:i,actionsBg:a}=t;return Object.assign(Object.assign({margin:0,padding:0,listStyle:"none",background:a,borderTop:`${G(t.lineWidth)} ${t.lineType} ${i}`,display:"flex",borderRadius:`0 0 ${G(t.borderRadiusLG)} ${G(t.borderRadiusLG)}`},er()),{"& > li":{margin:r,color:t.colorTextDescription,textAlign:"center","> span":{position:"relative",display:"block",minWidth:t.calc(t.cardActionsIconSize).mul(2).equal(),fontSize:t.fontSize,lineHeight:t.lineHeight,cursor:"pointer","&:hover":{color:t.colorPrimary,transition:`color ${t.motionDurationMid}`},[`a:not(${e}-btn), > ${n}`]:{display:"inline-block",width:"100%",color:t.colorIcon,lineHeight:G(t.fontHeight),transition:`color ${t.motionDurationMid}`,"&:hover":{color:t.colorPrimary}},[`> ${n}`]:{fontSize:o,lineHeight:G(t.calc(o).mul(t.lineHeight).equal())}},"&:not(:last-child)":{borderInlineEnd:`${G(t.lineWidth)} ${t.lineType} ${i}`}}})},Za=t=>Object.assign(Object.assign({margin:`${G(t.calc(t.marginXXS).mul(-1).equal())} 0`,display:"flex"},er()),{"&-avatar":{paddingInlineEnd:t.padding},"&-detail":{overflow:"hidden",flex:1,"> div:not(:last-child)":{marginBottom:t.marginXS}},"&-title":Object.assign({color:t.colorTextHeading,fontWeight:t.fontWeightStrong,fontSize:t.fontSizeLG},Zn),"&-description":{color:t.colorTextDescription}}),Qa=t=>{const{componentCls:e,colorFillAlter:n,headerPadding:r,bodyPadding:o}=t;return{[`${e}-head`]:{padding:`0 ${G(r)}`,background:n,"&-title":{fontSize:t.fontSize}},[`${e}-body`]:{padding:`${G(t.padding)} ${G(o)}`}}},el=t=>{const{componentCls:e}=t;return{overflow:"hidden",[`${e}-body`]:{userSelect:"none"}}},tl=t=>{const{componentCls:e,cardShadow:n,cardHeadPadding:r,colorBorderSecondary:o,boxShadowTertiary:i,bodyPadding:a,extraColor:s}=t;return{[e]:Object.assign(Object.assign({},sn(t)),{position:"relative",background:t.colorBgContainer,borderRadius:t.borderRadiusLG,[`&:not(${e}-bordered)`]:{boxShadow:i},[`${e}-head`]:qa(t),[`${e}-extra`]:{marginInlineStart:"auto",color:s,fontWeight:"normal",fontSize:t.fontSize},[`${e}-body`]:Object.assign({padding:a,borderRadius:`0 0 ${G(t.borderRadiusLG)} ${G(t.borderRadiusLG)}`},er()),[`${e}-grid`]:Ua(t),[`${e}-cover`]:{"> *":{display:"block",width:"100%",borderRadius:`${G(t.borderRadiusLG)} ${G(t.borderRadiusLG)} 0 0`}},[`${e}-actions`]:Ja(t),[`${e}-meta`]:Za(t)}),[`${e}-bordered`]:{border:`${G(t.lineWidth)} ${t.lineType} ${o}`,[`${e}-cover`]:{marginTop:-1,marginInlineStart:-1,marginInlineEnd:-1}},[`${e}-hoverable`]:{cursor:"pointer",transition:`box-shadow ${t.motionDurationMid}, border-color ${t.motionDurationMid}`,"&:hover":{borderColor:"transparent",boxShadow:n}},[`${e}-contain-grid`]:{borderRadius:`${G(t.borderRadiusLG)} ${G(t.borderRadiusLG)} 0 0 `,[`${e}-body`]:{display:"flex",flexWrap:"wrap"},[`&:not(${e}-loading) ${e}-body`]:{marginBlockStart:t.calc(t.lineWidth).mul(-1).equal(),marginInlineStart:t.calc(t.lineWidth).mul(-1).equal(),padding:0}},[`${e}-contain-tabs`]:{[`> div${e}-head`]:{minHeight:0,[`${e}-head-title, ${e}-extra`]:{paddingTop:r}}},[`${e}-type-inner`]:Qa(t),[`${e}-loading`]:el(t),[`${e}-rtl`]:{direction:"rtl"}}},nl=t=>{const{componentCls:e,bodyPaddingSM:n,headerPaddingSM:r,headerHeightSM:o,headerFontSizeSM:i}=t;return{[`${e}-small`]:{[`> ${e}-head`]:{minHeight:o,padding:`0 ${G(r)}`,fontSize:i,[`> ${e}-head-wrapper`]:{[`> ${e}-extra`]:{fontSize:t.fontSize}}},[`> ${e}-body`]:{padding:n}},[`${e}-small${e}-contain-tabs`]:{[`> ${e}-head`]:{[`${e}-head-title, ${e}-extra`]:{paddingTop:0,display:"flex",alignItems:"center"}}}}},rl=t=>{var e,n;return{headerBg:"transparent",headerFontSize:t.fontSizeLG,headerFontSizeSM:t.fontSize,headerHeight:t.fontSizeLG*t.lineHeightLG+t.padding*2,headerHeightSM:t.fontSize*t.lineHeight+t.paddingXS*2,actionsBg:t.colorBgContainer,actionsLiMargin:`${t.paddingSM}px 0`,tabsMarginBottom:-t.padding-t.lineWidth,extraColor:t.colorText,bodyPaddingSM:12,headerPaddingSM:12,bodyPadding:(e=t.bodyPadding)!==null&&e!==void 0?e:t.paddingLG,headerPadding:(n=t.headerPadding)!==null&&n!==void 0?n:t.paddingLG}},ol=rn("Card",t=>{const e=on(t,{cardShadow:t.boxShadowCard,cardHeadPadding:t.padding,cardPaddingBase:t.paddingLG,cardActionsIconSize:t.fontSize});return[tl(e),nl(e)]},rl);var lo=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const il=t=>{const{actionClasses:e,actions:n=[],actionStyle:r}=t;return h.createElement("ul",{className:e,style:r},n.map((o,i)=>{const a=`action-${i}`;return h.createElement("li",{style:{width:`${100/n.length}%`},key:a},h.createElement("span",null,o))}))},sl=h.forwardRef((t,e)=>{const{prefixCls:n,className:r,rootClassName:o,style:i,extra:a,headStyle:s={},bodyStyle:l={},title:c,loading:d,bordered:u,variant:f,size:m,type:b,cover:g,actions:y,tabList:x,children:C,activeTabKey:S,defaultActiveTabKey:R,tabBarExtraContent:P,hoverable:E,tabProps:D={},classNames:T,styles:A}=t,$=lo(t,["prefixCls","className","rootClassName","style","extra","headStyle","bodyStyle","title","loading","bordered","variant","size","type","cover","actions","tabList","children","activeTabKey","defaultActiveTabKey","tabBarExtraContent","hoverable","tabProps","classNames","styles"]),{getPrefixCls:I,direction:O,card:z}=h.useContext(Bt),[N]=Rs("card",f,u),K=j=>{var k;(k=t.onTabChange)===null||k===void 0||k.call(t,j)},H=j=>{var k;return ue((k=z?.classNames)===null||k===void 0?void 0:k[j],T?.[j])},q=j=>{var k;return Object.assign(Object.assign({},(k=z?.styles)===null||k===void 0?void 0:k[j]),A?.[j])},oe=h.useMemo(()=>{let j=!1;return h.Children.forEach(C,k=>{k?.type===Ni&&(j=!0)}),j},[C]),L=I("card",n),[ae,be,fe]=ol(L),se=h.createElement(Es,{loading:!0,active:!0,paragraph:{rows:4},title:!1},C),Q=S!==void 0,le=Object.assign(Object.assign({},D),{[Q?"activeKey":"defaultActiveKey"]:Q?S:R,tabBarExtraContent:P});let Z;const ne=Qn(m),ce=!ne||ne==="default"?"large":ne,Ce=x?h.createElement(Di,Object.assign({size:ce},le,{className:`${L}-head-tabs`,onChange:K,items:x.map(j=>{var{tab:k}=j,Y=lo(j,["tab"]);return Object.assign({label:k},Y)})})):null;if(c||a||Ce){const j=ue(`${L}-head`,H("header")),k=ue(`${L}-head-title`,H("title")),Y=ue(`${L}-extra`,H("extra")),W=Object.assign(Object.assign({},s),q("header"));Z=h.createElement("div",{className:j,style:W},h.createElement("div",{className:`${L}-head-wrapper`},c&&h.createElement("div",{className:k,style:q("title")},c),a&&h.createElement("div",{className:Y,style:q("extra")},a)),Ce)}const $e=ue(`${L}-cover`,H("cover")),he=g?h.createElement("div",{className:$e,style:q("cover")},g):null,xe=ue(`${L}-body`,H("body")),Re=Object.assign(Object.assign({},l),q("body")),ye=h.createElement("div",{className:xe,style:Re},d?se:C),ie=ue(`${L}-actions`,H("actions")),p=y?.length?h.createElement(il,{actionClasses:ie,actionStyle:q("actions"),actions:y}):null,B=tr($,["onTabChange"]),w=ue(L,z?.className,{[`${L}-loading`]:d,[`${L}-bordered`]:N!=="borderless",[`${L}-hoverable`]:E,[`${L}-contain-grid`]:oe,[`${L}-contain-tabs`]:x?.length,[`${L}-${ne}`]:ne,[`${L}-type-${b}`]:!!b,[`${L}-rtl`]:O==="rtl"},r,o,be,fe),M=Object.assign(Object.assign({},z?.style),i);return ae(h.createElement("div",Object.assign({ref:e},B,{className:w,style:M}),Z,he,ye,p))});var al=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const ll=t=>{const{prefixCls:e,className:n,avatar:r,title:o,description:i}=t,a=al(t,["prefixCls","className","avatar","title","description"]),{getPrefixCls:s}=h.useContext(Bt),l=s("card",e),c=ue(`${l}-meta`,n),d=r?h.createElement("div",{className:`${l}-meta-avatar`},r):null,u=o?h.createElement("div",{className:`${l}-meta-title`},o):null,f=i?h.createElement("div",{className:`${l}-meta-description`},i):null,m=u||f?h.createElement("div",{className:`${l}-meta-detail`},u,f):null;return h.createElement("div",Object.assign({},a,{className:c}),d,m)},ut=sl;ut.Grid=Ni;ut.Meta=ll;var co=function(e,n){if(!e)return null;var r={left:e.offsetLeft,right:e.parentElement.clientWidth-e.clientWidth-e.offsetLeft,width:e.clientWidth,top:e.offsetTop,bottom:e.parentElement.clientHeight-e.clientHeight-e.offsetTop,height:e.clientHeight};return n?{left:0,right:0,width:0,top:r.top,bottom:r.bottom,height:r.height}:{left:r.left,right:r.right,width:r.width,top:0,bottom:0,height:0}},yt=function(e){return e!==void 0?"".concat(e,"px"):void 0};function cl(t){var e=t.prefixCls,n=t.containerRef,r=t.value,o=t.getValueIndex,i=t.motionName,a=t.onMotionStart,s=t.onMotionEnd,l=t.direction,c=t.vertical,d=c===void 0?!1:c,u=h.useRef(null),f=h.useState(r),m=ge(f,2),b=m[0],g=m[1],y=function(K){var H,q=o(K),oe=(H=n.current)===null||H===void 0?void 0:H.querySelectorAll(".".concat(e,"-item"))[q];return oe?.offsetParent&&oe},x=h.useState(null),C=ge(x,2),S=C[0],R=C[1],P=h.useState(null),E=ge(P,2),D=E[0],T=E[1];Xn(function(){if(b!==r){var N=y(b),K=y(r),H=co(N,d),q=co(K,d);g(r),R(H),T(q),N&&K?a():s()}},[r]);var A=h.useMemo(function(){if(d){var N;return yt((N=S?.top)!==null&&N!==void 0?N:0)}return yt(l==="rtl"?-S?.right:S?.left)},[d,l,S]),$=h.useMemo(function(){if(d){var N;return yt((N=D?.top)!==null&&N!==void 0?N:0)}return yt(l==="rtl"?-D?.right:D?.left)},[d,l,D]),I=function(){return d?{transform:"translateY(var(--thumb-start-top))",height:"var(--thumb-start-height)"}:{transform:"translateX(var(--thumb-start-left))",width:"var(--thumb-start-width)"}},O=function(){return d?{transform:"translateY(var(--thumb-active-top))",height:"var(--thumb-active-height)"}:{transform:"translateX(var(--thumb-active-left))",width:"var(--thumb-active-width)"}},z=function(){R(null),T(null),s()};return!S||!D?null:h.createElement(mi,{visible:!0,motionName:i,motionAppear:!0,onAppearStart:I,onAppearActive:O,onVisibleChanged:z},function(N,K){var H=N.className,q=N.style,oe=Oe(Oe({},q),{},{"--thumb-start-left":A,"--thumb-start-width":yt(S?.width),"--thumb-active-left":$,"--thumb-active-width":yt(D?.width),"--thumb-start-top":A,"--thumb-start-height":yt(S?.height),"--thumb-active-top":$,"--thumb-active-height":yt(D?.height)}),L={ref:Nr(u,K),style:oe,className:ue("".concat(e,"-thumb"),H)};return h.createElement("div",L)})}var ul=["prefixCls","direction","vertical","options","disabled","defaultValue","value","name","onChange","className","motionName"];function dl(t){if(typeof t.title<"u")return t.title;if(gt(t.label)!=="object"){var e;return(e=t.label)===null||e===void 0?void 0:e.toString()}}function fl(t){return t.map(function(e){if(gt(e)==="object"&&e!==null){var n=dl(e);return Oe(Oe({},e),{},{title:n})}return{label:e?.toString(),title:e?.toString(),value:e}})}var hl=function(e){var n=e.prefixCls,r=e.className,o=e.disabled,i=e.checked,a=e.label,s=e.title,l=e.value,c=e.name,d=e.onChange,u=e.onFocus,f=e.onBlur,m=e.onKeyDown,b=e.onKeyUp,g=e.onMouseDown,y=function(C){o||d(C,l)};return h.createElement("label",{className:ue(r,Me({},"".concat(n,"-item-disabled"),o)),onMouseDown:g},h.createElement("input",{name:c,className:"".concat(n,"-item-input"),type:"radio",disabled:o,checked:i,onChange:y,onFocus:u,onBlur:f,onKeyDown:m,onKeyUp:b}),h.createElement("div",{className:"".concat(n,"-item-label"),title:s,"aria-selected":i},a))},gl=h.forwardRef(function(t,e){var n,r,o=t.prefixCls,i=o===void 0?"rc-segmented":o,a=t.direction,s=t.vertical,l=t.options,c=l===void 0?[]:l,d=t.disabled,u=t.defaultValue,f=t.value,m=t.name,b=t.onChange,g=t.className,y=g===void 0?"":g,x=t.motionName,C=x===void 0?"thumb-motion":x,S=kt(t,ul),R=h.useRef(null),P=h.useMemo(function(){return Nr(R,e)},[R,e]),E=h.useMemo(function(){return fl(c)},[c]),D=Rt((n=E[0])===null||n===void 0?void 0:n.value,{value:f,defaultValue:u}),T=ge(D,2),A=T[0],$=T[1],I=h.useState(!1),O=ge(I,2),z=O[0],N=O[1],K=function(xe,Re){$(Re),b?.(Re)},H=tr(S,["children"]),q=h.useState(!1),oe=ge(q,2),L=oe[0],ae=oe[1],be=h.useState(!1),fe=ge(be,2),se=fe[0],Q=fe[1],le=function(){Q(!0)},Z=function(){Q(!1)},ne=function(){ae(!1)},ce=function(xe){xe.key==="Tab"&&ae(!0)},Ce=function(xe){var Re=E.findIndex(function(B){return B.value===A}),ye=E.length,ie=(Re+xe+ye)%ye,p=E[ie];p&&($(p.value),b?.(p.value))},$e=function(xe){switch(xe.key){case"ArrowLeft":case"ArrowUp":Ce(-1);break;case"ArrowRight":case"ArrowDown":Ce(1);break}};return h.createElement("div",Xe({role:"radiogroup","aria-label":"segmented control",tabIndex:d?void 0:0},H,{className:ue(i,(r={},Me(r,"".concat(i,"-rtl"),a==="rtl"),Me(r,"".concat(i,"-disabled"),d),Me(r,"".concat(i,"-vertical"),s),r),y),ref:P}),h.createElement("div",{className:"".concat(i,"-group")},h.createElement(cl,{vertical:s,prefixCls:i,value:A,containerRef:R,motionName:"".concat(i,"-").concat(C),direction:a,getValueIndex:function(xe){return E.findIndex(function(Re){return Re.value===xe})},onMotionStart:function(){N(!0)},onMotionEnd:function(){N(!1)}}),E.map(function(he){var xe;return h.createElement(hl,Xe({},he,{name:m,key:he.value,prefixCls:i,className:ue(he.className,"".concat(i,"-item"),(xe={},Me(xe,"".concat(i,"-item-selected"),he.value===A&&!z),Me(xe,"".concat(i,"-item-focused"),se&&L&&he.value===A),xe)),checked:he.value===A,onChange:K,onFocus:le,onBlur:Z,onKeyDown:$e,onKeyUp:ce,onMouseDown:ne,disabled:!!d||!!he.disabled}))})))}),pl=gl;function uo(t,e){return{[`${t}, ${t}:hover, ${t}:focus`]:{color:e.colorTextDisabled,cursor:"not-allowed"}}}function fo(t){return{backgroundColor:t.itemSelectedBg,boxShadow:t.boxShadowTertiary}}const ml=Object.assign({overflow:"hidden"},Zn),vl=t=>{const{componentCls:e}=t,n=t.calc(t.controlHeight).sub(t.calc(t.trackPadding).mul(2)).equal(),r=t.calc(t.controlHeightLG).sub(t.calc(t.trackPadding).mul(2)).equal(),o=t.calc(t.controlHeightSM).sub(t.calc(t.trackPadding).mul(2)).equal();return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},sn(t)),{display:"inline-block",padding:t.trackPadding,color:t.itemColor,background:t.trackBg,borderRadius:t.borderRadius,transition:`all ${t.motionDurationMid} ${t.motionEaseInOut}`}),Fn(t)),{[`${e}-group`]:{position:"relative",display:"flex",alignItems:"stretch",justifyItems:"flex-start",flexDirection:"row",width:"100%"},[`&${e}-rtl`]:{direction:"rtl"},[`&${e}-vertical`]:{[`${e}-group`]:{flexDirection:"column"},[`${e}-thumb`]:{width:"100%",height:0,padding:`0 ${G(t.paddingXXS)}`}},[`&${e}-block`]:{display:"flex"},[`&${e}-block ${e}-item`]:{flex:1,minWidth:0},[`${e}-item`]:{position:"relative",textAlign:"center",cursor:"pointer",transition:`color ${t.motionDurationMid} ${t.motionEaseInOut}`,borderRadius:t.borderRadiusSM,transform:"translateZ(0)","&-selected":Object.assign(Object.assign({},fo(t)),{color:t.itemSelectedColor}),"&-focused":Object.assign({},Dr(t)),"&::after":{content:'""',position:"absolute",zIndex:-1,width:"100%",height:"100%",top:0,insetInlineStart:0,borderRadius:"inherit",opacity:0,transition:`opacity ${t.motionDurationMid}`,pointerEvents:"none"},[`&:hover:not(${e}-item-selected):not(${e}-item-disabled)`]:{color:t.itemHoverColor,"&::after":{opacity:1,backgroundColor:t.itemHoverBg}},[`&:active:not(${e}-item-selected):not(${e}-item-disabled)`]:{color:t.itemHoverColor,"&::after":{opacity:1,backgroundColor:t.itemActiveBg}},"&-label":Object.assign({minHeight:n,lineHeight:G(n),padding:`0 ${G(t.segmentedPaddingHorizontal)}`},ml),"&-icon + *":{marginInlineStart:t.calc(t.marginSM).div(2).equal()},"&-input":{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:0,opacity:0,pointerEvents:"none"}},[`${e}-thumb`]:Object.assign(Object.assign({},fo(t)),{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:"100%",padding:`${G(t.paddingXXS)} 0`,borderRadius:t.borderRadiusSM,transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOut}, height ${t.motionDurationSlow} ${t.motionEaseInOut}`,[`& ~ ${e}-item:not(${e}-item-selected):not(${e}-item-disabled)::after`]:{backgroundColor:"transparent"}}),[`&${e}-lg`]:{borderRadius:t.borderRadiusLG,[`${e}-item-label`]:{minHeight:r,lineHeight:G(r),padding:`0 ${G(t.segmentedPaddingHorizontal)}`,fontSize:t.fontSizeLG},[`${e}-item, ${e}-thumb`]:{borderRadius:t.borderRadius}},[`&${e}-sm`]:{borderRadius:t.borderRadiusSM,[`${e}-item-label`]:{minHeight:o,lineHeight:G(o),padding:`0 ${G(t.segmentedPaddingHorizontalSM)}`},[`${e}-item, ${e}-thumb`]:{borderRadius:t.borderRadiusXS}}}),uo(`&-disabled ${e}-item`,t)),uo(`${e}-item-disabled`,t)),{[`${e}-thumb-motion-appear-active`]:{transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOut}, width ${t.motionDurationSlow} ${t.motionEaseInOut}`,willChange:"transform, width"},[`&${e}-shape-round`]:{borderRadius:9999,[`${e}-item, ${e}-thumb`]:{borderRadius:9999}}})}},bl=t=>{const{colorTextLabel:e,colorText:n,colorFillSecondary:r,colorBgElevated:o,colorFill:i,lineWidthBold:a,colorBgLayout:s}=t;return{trackPadding:a,trackBg:s,itemColor:e,itemHoverColor:n,itemHoverBg:r,itemSelectedBg:o,itemActiveBg:i,itemSelectedColor:n}},yl=rn("Segmented",t=>{const{lineWidth:e,calc:n}=t,r=on(t,{segmentedPaddingHorizontal:n(t.controlPaddingHorizontal).sub(e).equal(),segmentedPaddingHorizontalSM:n(t.controlPaddingHorizontalSM).sub(e).equal()});return[vl(r)]},bl);var ho=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Cl(t){return typeof t=="object"&&!!t?.icon}const xl=h.forwardRef((t,e)=>{const n=Ms(),{prefixCls:r,className:o,rootClassName:i,block:a,options:s=[],size:l="middle",style:c,vertical:d,shape:u="default",name:f=n}=t,m=ho(t,["prefixCls","className","rootClassName","block","options","size","style","vertical","shape","name"]),{getPrefixCls:b,direction:g,className:y,style:x}=zr("segmented"),C=b("segmented",r),[S,R,P]=yl(C),E=Qn(l),D=h.useMemo(()=>s.map($=>{if(Cl($)){const{icon:I,label:O}=$,z=ho($,["icon","label"]);return Object.assign(Object.assign({},z),{label:h.createElement(h.Fragment,null,h.createElement("span",{className:`${C}-item-icon`},I),O&&h.createElement("span",null,O))})}return $}),[s,C]),T=ue(o,i,y,{[`${C}-block`]:a,[`${C}-sm`]:E==="small",[`${C}-lg`]:E==="large",[`${C}-vertical`]:d,[`${C}-shape-${u}`]:u==="round"},R,P),A=Object.assign(Object.assign({},x),c);return S(h.createElement(pl,Object.assign({},m,{name:f,className:T,style:A,options:D,ref:e,prefixCls:C,direction:g,vertical:d})))}),Sl=xl,zi=U.createContext({}),Li=U.createContext({}),_i=({prefixCls:t,value:e,onChange:n})=>{const r=()=>{if(n&&e&&!e.cleared){const o=e.toHsb();o.a=0;const i=dt(o);i.cleared=!0,n(i)}};return U.createElement("div",{className:`${t}-clear`,onClick:r})},Hi="hex",Wi="rgb",Fi="hsb",Wt=({prefixCls:t,min:e=0,max:n=100,value:r,onChange:o,className:i,formatter:a})=>{const s=`${t}-steppers`,[l,c]=h.useState(0),d=Number.isNaN(r)?l:r;return U.createElement(He,{className:ue(s,i),min:e,max:n,value:d,formatter:a,size:"small",onChange:u=>{c(u||0),o?.(u)}})},wl=({prefixCls:t,value:e,onChange:n})=>{const r=`${t}-alpha-input`,[o,i]=h.useState(()=>dt(e||"#000")),a=e||o,s=l=>{const c=a.toHsb();c.a=(l||0)/100;const d=dt(c);i(d),n?.(d)};return U.createElement(Wt,{value:Lr(a),prefixCls:t,formatter:l=>`${l}%`,className:r,onChange:s})},$l=/(^#[\da-f]{6}$)|(^#[\da-f]{8}$)/i,Rl=t=>$l.test(`#${t}`),El=({prefixCls:t,value:e,onChange:n})=>{const r=`${t}-hex-input`,[o,i]=h.useState(()=>e?An(e.toHexString()):void 0);h.useEffect(()=>{e&&i(An(e.toHexString()))},[e]);const a=s=>{const l=s.target.value;i(An(l)),Rl(An(l,!0))&&n?.(dt(l))};return U.createElement(Ps,{className:r,value:o,prefix:"#",onChange:a,size:"small"})},Ml=({prefixCls:t,value:e,onChange:n})=>{const r=`${t}-hsb-input`,[o,i]=h.useState(()=>dt(e||"#000")),a=e||o,s=(l,c)=>{const d=a.toHsb();d[c]=c==="h"?l:(l||0)/100;const u=dt(d);i(u),n?.(u)};return U.createElement("div",{className:r},U.createElement(Wt,{max:360,min:0,value:Number(a.toHsb().h),prefixCls:t,className:r,formatter:l=>sr(l||0).toString(),onChange:l=>s(Number(l),"h")}),U.createElement(Wt,{max:100,min:0,value:Number(a.toHsb().s)*100,prefixCls:t,className:r,formatter:l=>`${sr(l||0)}%`,onChange:l=>s(Number(l),"s")}),U.createElement(Wt,{max:100,min:0,value:Number(a.toHsb().b)*100,prefixCls:t,className:r,formatter:l=>`${sr(l||0)}%`,onChange:l=>s(Number(l),"b")}))},Pl=({prefixCls:t,value:e,onChange:n})=>{const r=`${t}-rgb-input`,[o,i]=h.useState(()=>dt(e||"#000")),a=e||o,s=(l,c)=>{const d=a.toRgb();d[c]=l||0;const u=dt(d);i(u),n?.(u)};return U.createElement("div",{className:r},U.createElement(Wt,{max:255,min:0,value:Number(a.toRgb().r),prefixCls:t,className:r,onChange:l=>s(Number(l),"r")}),U.createElement(Wt,{max:255,min:0,value:Number(a.toRgb().g),prefixCls:t,className:r,onChange:l=>s(Number(l),"g")}),U.createElement(Wt,{max:255,min:0,value:Number(a.toRgb().b),prefixCls:t,className:r,onChange:l=>s(Number(l),"b")}))},Il=[Hi,Fi,Wi].map(t=>({value:t,label:t.toUpperCase()})),jl=t=>{const{prefixCls:e,format:n,value:r,disabledAlpha:o,onFormatChange:i,onChange:a,disabledFormat:s}=t,[l,c]=Rt(Hi,{value:n,onChange:i}),d=`${e}-input`,u=m=>{c(m)},f=h.useMemo(()=>{const m={value:r,prefixCls:e,onChange:a};switch(l){case Fi:return U.createElement(Ml,Object.assign({},m));case Wi:return U.createElement(Pl,Object.assign({},m));default:return U.createElement(El,Object.assign({},m))}},[l,e,r,a]);return U.createElement("div",{className:`${d}-container`},!s&&U.createElement(_t,{value:l,variant:"borderless",getPopupContainer:m=>m,popupMatchSelectWidth:68,placement:"bottomRight",onChange:u,className:`${e}-format-select`,size:"small",options:Il}),U.createElement("div",{className:d},f),!o&&U.createElement(wl,{prefixCls:e,value:r,onChange:a}))};function wr(t,e,n){return(t-e)/(n-e)}function Wr(t,e,n,r){var o=wr(e,n,r),i={};switch(t){case"rtl":i.right="".concat(o*100,"%"),i.transform="translateX(50%)";break;case"btt":i.bottom="".concat(o*100,"%"),i.transform="translateY(50%)";break;case"ttb":i.top="".concat(o*100,"%"),i.transform="translateY(-50%)";break;default:i.left="".concat(o*100,"%"),i.transform="translateX(-50%)";break}return i}function Ht(t,e){return Array.isArray(t)?t[e]:t}var Gt=h.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0,styles:{},classNames:{}}),Xi=h.createContext({}),Ol=["prefixCls","value","valueIndex","onStartMove","onDelete","style","render","dragging","draggingDelete","onOffsetChange","onChangeComplete","onFocus","onMouseEnter"],go=h.forwardRef(function(t,e){var n=t.prefixCls,r=t.value,o=t.valueIndex,i=t.onStartMove,a=t.onDelete,s=t.style,l=t.render,c=t.dragging,d=t.draggingDelete,u=t.onOffsetChange,f=t.onChangeComplete,m=t.onFocus,b=t.onMouseEnter,g=kt(t,Ol),y=h.useContext(Gt),x=y.min,C=y.max,S=y.direction,R=y.disabled,P=y.keyboard,E=y.range,D=y.tabIndex,T=y.ariaLabelForHandle,A=y.ariaLabelledByForHandle,$=y.ariaRequired,I=y.ariaValueTextFormatterForHandle,O=y.styles,z=y.classNames,N="".concat(n,"-handle"),K=function(le){R||i(le,o)},H=function(le){m?.(le,o)},q=function(le){b(le,o)},oe=function(le){if(!R&&P){var Z=null;switch(le.which||le.keyCode){case _e.LEFT:Z=S==="ltr"||S==="btt"?-1:1;break;case _e.RIGHT:Z=S==="ltr"||S==="btt"?1:-1;break;case _e.UP:Z=S!=="ttb"?1:-1;break;case _e.DOWN:Z=S!=="ttb"?-1:1;break;case _e.HOME:Z="min";break;case _e.END:Z="max";break;case _e.PAGE_UP:Z=2;break;case _e.PAGE_DOWN:Z=-2;break;case _e.BACKSPACE:case _e.DELETE:a(o);break}Z!==null&&(le.preventDefault(),u(Z,o))}},L=function(le){switch(le.which||le.keyCode){case _e.LEFT:case _e.RIGHT:case _e.UP:case _e.DOWN:case _e.HOME:case _e.END:case _e.PAGE_UP:case _e.PAGE_DOWN:f?.();break}},ae=Wr(S,r,x,C),be={};if(o!==null){var fe;be={tabIndex:R?null:Ht(D,o),role:"slider","aria-valuemin":x,"aria-valuemax":C,"aria-valuenow":r,"aria-disabled":R,"aria-label":Ht(T,o),"aria-labelledby":Ht(A,o),"aria-required":Ht($,o),"aria-valuetext":(fe=Ht(I,o))===null||fe===void 0?void 0:fe(r),"aria-orientation":S==="ltr"||S==="rtl"?"horizontal":"vertical",onMouseDown:K,onTouchStart:K,onFocus:H,onMouseEnter:q,onKeyDown:oe,onKeyUp:L}}var se=h.createElement("div",Xe({ref:e,className:ue(N,Me(Me(Me({},"".concat(N,"-").concat(o+1),o!==null&&E),"".concat(N,"-dragging"),c),"".concat(N,"-dragging-delete"),d),z.handle),style:Oe(Oe(Oe({},ae),s),O.handle)},be,g));return l&&(se=l(se,{index:o,prefixCls:n,value:r,dragging:c,draggingDelete:d})),se}),Tl=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","activeHandleRender","draggingIndex","draggingDelete","onFocus"],kl=h.forwardRef(function(t,e){var n=t.prefixCls,r=t.style,o=t.onStartMove,i=t.onOffsetChange,a=t.values,s=t.handleRender,l=t.activeHandleRender,c=t.draggingIndex,d=t.draggingDelete,u=t.onFocus,f=kt(t,Tl),m=h.useRef({}),b=h.useState(!1),g=ge(b,2),y=g[0],x=g[1],C=h.useState(-1),S=ge(C,2),R=S[0],P=S[1],E=function(I){P(I),x(!0)},D=function(I,O){E(O),u?.(I)},T=function(I,O){E(O)};h.useImperativeHandle(e,function(){return{focus:function(I){var O;(O=m.current[I])===null||O===void 0||O.focus()},hideHelp:function(){Is.flushSync(function(){x(!1)})}}});var A=Oe({prefixCls:n,onStartMove:o,onOffsetChange:i,render:s,onFocus:D,onMouseEnter:T},f);return h.createElement(h.Fragment,null,a.map(function($,I){var O=c===I;return h.createElement(go,Xe({ref:function(N){N?m.current[I]=N:delete m.current[I]},dragging:O,draggingDelete:O&&d,style:Ht(r,I),key:I,value:$,valueIndex:I},A))}),l&&y&&h.createElement(go,Xe({key:"a11y"},A,{value:a[R],valueIndex:null,dragging:c!==-1,draggingDelete:d,render:l,style:{pointerEvents:"none"},tabIndex:null,"aria-hidden":!0})))}),Al=function(e){var n=e.prefixCls,r=e.style,o=e.children,i=e.value,a=e.onClick,s=h.useContext(Gt),l=s.min,c=s.max,d=s.direction,u=s.includedStart,f=s.includedEnd,m=s.included,b="".concat(n,"-text"),g=Wr(d,i,l,c);return h.createElement("span",{className:ue(b,Me({},"".concat(b,"-active"),m&&u<=i&&i<=f)),style:Oe(Oe({},g),r),onMouseDown:function(x){x.stopPropagation()},onClick:function(){a(i)}},o)},Bl=function(e){var n=e.prefixCls,r=e.marks,o=e.onClick,i="".concat(n,"-mark");return r.length?h.createElement("div",{className:i},r.map(function(a){var s=a.value,l=a.style,c=a.label;return h.createElement(Al,{key:s,prefixCls:i,style:l,value:s,onClick:o},c)})):null},Dl=function(e){var n=e.prefixCls,r=e.value,o=e.style,i=e.activeStyle,a=h.useContext(Gt),s=a.min,l=a.max,c=a.direction,d=a.included,u=a.includedStart,f=a.includedEnd,m="".concat(n,"-dot"),b=d&&u<=r&&r<=f,g=Oe(Oe({},Wr(c,r,s,l)),typeof o=="function"?o(r):o);return b&&(g=Oe(Oe({},g),typeof i=="function"?i(r):i)),h.createElement("span",{className:ue(m,Me({},"".concat(m,"-active"),b)),style:g})},Nl=function(e){var n=e.prefixCls,r=e.marks,o=e.dots,i=e.style,a=e.activeStyle,s=h.useContext(Gt),l=s.min,c=s.max,d=s.step,u=h.useMemo(function(){var f=new Set;if(r.forEach(function(b){f.add(b.value)}),o&&d!==null)for(var m=l;m<=c;)f.add(m),m+=d;return Array.from(f)},[l,c,d,o,r]);return h.createElement("div",{className:"".concat(n,"-step")},u.map(function(f){return h.createElement(Dl,{prefixCls:n,key:f,value:f,style:i,activeStyle:a})}))},po=function(e){var n=e.prefixCls,r=e.style,o=e.start,i=e.end,a=e.index,s=e.onStartMove,l=e.replaceCls,c=h.useContext(Gt),d=c.direction,u=c.min,f=c.max,m=c.disabled,b=c.range,g=c.classNames,y="".concat(n,"-track"),x=wr(o,u,f),C=wr(i,u,f),S=function(D){!m&&s&&s(D,-1)},R={};switch(d){case"rtl":R.right="".concat(x*100,"%"),R.width="".concat(C*100-x*100,"%");break;case"btt":R.bottom="".concat(x*100,"%"),R.height="".concat(C*100-x*100,"%");break;case"ttb":R.top="".concat(x*100,"%"),R.height="".concat(C*100-x*100,"%");break;default:R.left="".concat(x*100,"%"),R.width="".concat(C*100-x*100,"%")}var P=l||ue(y,Me(Me({},"".concat(y,"-").concat(a+1),a!==null&&b),"".concat(n,"-track-draggable"),s),g.track);return h.createElement("div",{className:P,style:Oe(Oe({},R),r),onMouseDown:S,onTouchStart:S})},zl=function(e){var n=e.prefixCls,r=e.style,o=e.values,i=e.startPoint,a=e.onStartMove,s=h.useContext(Gt),l=s.included,c=s.range,d=s.min,u=s.styles,f=s.classNames,m=h.useMemo(function(){if(!c){if(o.length===0)return[];var g=i??d,y=o[0];return[{start:Math.min(g,y),end:Math.max(g,y)}]}for(var x=[],C=0;C<o.length-1;C+=1)x.push({start:o[C],end:o[C+1]});return x},[o,c,i,d]);if(!l)return null;var b=m!=null&&m.length&&(f.tracks||u.tracks)?h.createElement(po,{index:null,prefixCls:n,start:m[0].start,end:m[m.length-1].end,replaceCls:ue(f.tracks,"".concat(n,"-tracks")),style:u.tracks}):null;return h.createElement(h.Fragment,null,b,m.map(function(g,y){var x=g.start,C=g.end;return h.createElement(po,{index:y,prefixCls:n,style:Oe(Oe({},Ht(r,y)),u.track),start:x,end:C,key:y,onStartMove:a})}))},Ll=130;function mo(t){var e="targetTouches"in t?t.targetTouches[0]:t;return{pageX:e.pageX,pageY:e.pageY}}function _l(t,e,n,r,o,i,a,s,l,c,d){var u=h.useState(null),f=ge(u,2),m=f[0],b=f[1],g=h.useState(-1),y=ge(g,2),x=y[0],C=y[1],S=h.useState(!1),R=ge(S,2),P=R[0],E=R[1],D=h.useState(n),T=ge(D,2),A=T[0],$=T[1],I=h.useState(n),O=ge(I,2),z=O[0],N=O[1],K=h.useRef(null),H=h.useRef(null),q=h.useRef(null),oe=h.useContext(Xi),L=oe.onDragStart,ae=oe.onDragChange;Xn(function(){x===-1&&$(n)},[n,x]),h.useEffect(function(){return function(){document.removeEventListener("mousemove",K.current),document.removeEventListener("mouseup",H.current),q.current&&(q.current.removeEventListener("touchmove",K.current),q.current.removeEventListener("touchend",H.current))}},[]);var be=function(Z,ne,ce){ne!==void 0&&b(ne),$(Z);var Ce=Z;ce&&(Ce=Z.filter(function($e,he){return he!==x})),a(Ce),ae&&ae({rawValues:Z,deleteIndex:ce?x:-1,draggingIndex:x,draggingValue:ne})},fe=mt(function(le,Z,ne){if(le===-1){var ce=z[0],Ce=z[z.length-1],$e=r-ce,he=o-Ce,xe=Z*(o-r);xe=Math.max(xe,$e),xe=Math.min(xe,he);var Re=i(ce+xe);xe=Re-ce;var ye=z.map(function(w){return w+xe});be(ye)}else{var ie=(o-r)*Z,p=Ue(A);p[le]=z[le];var B=l(p,ie,le,"dist");be(B.values,B.value,ne)}}),se=function(Z,ne,ce){Z.stopPropagation();var Ce=ce||n,$e=Ce[ne];C(ne),b($e),N(Ce),$(Ce),E(!1);var he=mo(Z),xe=he.pageX,Re=he.pageY,ye=!1;L&&L({rawValues:Ce,draggingIndex:ne,draggingValue:$e});var ie=function(w){w.preventDefault();var M=mo(w),j=M.pageX,k=M.pageY,Y=j-xe,W=k-Re,X=t.current.getBoundingClientRect(),J=X.width,te=X.height,pe,_;switch(e){case"btt":pe=-W/te,_=Y;break;case"ttb":pe=W/te,_=Y;break;case"rtl":pe=-Y/J,_=W;break;default:pe=Y/J,_=W}ye=c?Math.abs(_)>Ll&&d<A.length:!1,E(ye),fe(ne,pe,ye)},p=function B(w){w.preventDefault(),document.removeEventListener("mouseup",B),document.removeEventListener("mousemove",ie),q.current&&(q.current.removeEventListener("touchmove",K.current),q.current.removeEventListener("touchend",H.current)),K.current=null,H.current=null,q.current=null,s(ye),C(-1),E(!1)};document.addEventListener("mouseup",p),document.addEventListener("mousemove",ie),Z.currentTarget.addEventListener("touchend",p),Z.currentTarget.addEventListener("touchmove",ie),K.current=ie,H.current=p,q.current=Z.currentTarget},Q=h.useMemo(function(){var le=Ue(n).sort(function($e,he){return $e-he}),Z=Ue(A).sort(function($e,he){return $e-he}),ne={};Z.forEach(function($e){ne[$e]=(ne[$e]||0)+1}),le.forEach(function($e){ne[$e]=(ne[$e]||0)-1});var ce=c?1:0,Ce=Object.values(ne).reduce(function($e,he){return $e+Math.abs(he)},0);return Ce<=ce?A:n},[n,A,c]);return[x,m,P,Q,se]}function Hl(t,e,n,r,o,i){var a=h.useCallback(function(m){return Math.max(t,Math.min(e,m))},[t,e]),s=h.useCallback(function(m){if(n!==null){var b=t+Math.round((a(m)-t)/n)*n,g=function(S){return(String(S).split(".")[1]||"").length},y=Math.max(g(n),g(e),g(t)),x=Number(b.toFixed(y));return t<=x&&x<=e?x:null}return null},[n,t,e,a]),l=h.useCallback(function(m){var b=a(m),g=r.map(function(C){return C.value});n!==null&&g.push(s(m)),g.push(t,e);var y=g[0],x=e-t;return g.forEach(function(C){var S=Math.abs(b-C);S<=x&&(y=C,x=S)}),y},[t,e,r,n,a,s]),c=function m(b,g,y){var x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof g=="number"){var C,S=b[y],R=S+g,P=[];r.forEach(function($){P.push($.value)}),P.push(t,e),P.push(s(S));var E=g>0?1:-1;x==="unit"?P.push(s(S+E*n)):P.push(s(R)),P=P.filter(function($){return $!==null}).filter(function($){return g<0?$<=S:$>=S}),x==="unit"&&(P=P.filter(function($){return $!==S}));var D=x==="unit"?S:R;C=P[0];var T=Math.abs(C-D);if(P.forEach(function($){var I=Math.abs($-D);I<T&&(C=$,T=I)}),C===void 0)return g<0?t:e;if(x==="dist")return C;if(Math.abs(g)>1){var A=Ue(b);return A[y]=C,m(A,g-E,y,x)}return C}else{if(g==="min")return t;if(g==="max")return e}},d=function(b,g,y){var x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",C=b[y],S=c(b,g,y,x);return{value:S,changed:S!==C}},u=function(b){return i===null&&b===0||typeof i=="number"&&b<i},f=function(b,g,y){var x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",C=b.map(l),S=C[y],R=c(C,g,y,x);if(C[y]=R,o===!1){var P=i||0;y>0&&C[y-1]!==S&&(C[y]=Math.max(C[y],C[y-1]+P)),y<C.length-1&&C[y+1]!==S&&(C[y]=Math.min(C[y],C[y+1]-P))}else if(typeof i=="number"||i===null){for(var E=y+1;E<C.length;E+=1)for(var D=!0;u(C[E]-C[E-1])&&D;){var T=d(C,1,E);C[E]=T.value,D=T.changed}for(var A=y;A>0;A-=1)for(var $=!0;u(C[A]-C[A-1])&&$;){var I=d(C,-1,A-1);C[A-1]=I.value,$=I.changed}for(var O=C.length-1;O>0;O-=1)for(var z=!0;u(C[O]-C[O-1])&&z;){var N=d(C,-1,O-1);C[O-1]=N.value,z=N.changed}for(var K=0;K<C.length-1;K+=1)for(var H=!0;u(C[K+1]-C[K])&&H;){var q=d(C,1,K+1);C[K+1]=q.value,H=q.changed}}return{value:C[y],values:C}};return[l,f]}function Wl(t){return h.useMemo(function(){if(t===!0||!t)return[!!t,!1,!1,0];var e=t.editable,n=t.draggableTrack,r=t.minCount,o=t.maxCount;return[!0,e,!e&&n,r||0,o]},[t])}var Fl=h.forwardRef(function(t,e){var n=t.prefixCls,r=n===void 0?"rc-slider":n,o=t.className,i=t.style,a=t.classNames,s=t.styles,l=t.id,c=t.disabled,d=c===void 0?!1:c,u=t.keyboard,f=u===void 0?!0:u,m=t.autoFocus,b=t.onFocus,g=t.onBlur,y=t.min,x=y===void 0?0:y,C=t.max,S=C===void 0?100:C,R=t.step,P=R===void 0?1:R,E=t.value,D=t.defaultValue,T=t.range,A=t.count,$=t.onChange,I=t.onBeforeChange,O=t.onAfterChange,z=t.onChangeComplete,N=t.allowCross,K=N===void 0?!0:N,H=t.pushable,q=H===void 0?!1:H,oe=t.reverse,L=t.vertical,ae=t.included,be=ae===void 0?!0:ae,fe=t.startPoint,se=t.trackStyle,Q=t.handleStyle,le=t.railStyle,Z=t.dotStyle,ne=t.activeDotStyle,ce=t.marks,Ce=t.dots,$e=t.handleRender,he=t.activeHandleRender,xe=t.track,Re=t.tabIndex,ye=Re===void 0?0:Re,ie=t.ariaLabelForHandle,p=t.ariaLabelledByForHandle,B=t.ariaRequired,w=t.ariaValueTextFormatterForHandle,M=h.useRef(null),j=h.useRef(null),k=h.useMemo(function(){return L?oe?"ttb":"btt":oe?"rtl":"ltr"},[oe,L]),Y=Wl(T),W=ge(Y,5),X=W[0],J=W[1],te=W[2],pe=W[3],_=W[4],ee=h.useMemo(function(){return isFinite(x)?x:0},[x]),F=h.useMemo(function(){return isFinite(S)?S:100},[S]),re=h.useMemo(function(){return P!==null&&P<=0?1:P},[P]),me=h.useMemo(function(){return typeof q=="boolean"?q?re:!1:q>=0?q:!1},[q,re]),Se=h.useMemo(function(){return Object.keys(ce||{}).map(function(de){var V=ce[de],ve={value:Number(de)};return V&&gt(V)==="object"&&!h.isValidElement(V)&&("label"in V||"style"in V)?(ve.style=V.style,ve.label=V.label):ve.label=V,ve}).filter(function(de){var V=de.label;return V||typeof V=="number"}).sort(function(de,V){return de.value-V.value})},[ce]),Ae=Hl(ee,F,re,Se,K,me),We=ge(Ae,2),Ne=We[0],Ee=We[1],Te=Rt(D,{value:E}),Pe=ge(Te,2),Ge=Pe[0],lt=Pe[1],ze=h.useMemo(function(){var de=Ge==null?[]:Array.isArray(Ge)?Ge:[Ge],V=ge(de,1),ve=V[0],we=ve===void 0?ee:ve,Be=Ge===null?[]:[we];if(X){if(Be=Ue(de),A||Ge===void 0){var Ve=A>=0?A+1:2;for(Be=Be.slice(0,Ve);Be.length<Ve;){var nt;Be.push((nt=Be[Be.length-1])!==null&&nt!==void 0?nt:ee)}}Be.sort(function(Ke,at){return Ke-at})}return Be.forEach(function(Ke,at){Be[at]=Ne(Ke)}),Be},[Ge,X,ee,A,Ne]),Le=function(V){return X?V:V[0]},Fe=mt(function(de){var V=Ue(de).sort(function(ve,we){return ve-we});$&&!js(V,ze,!0)&&$(Le(V)),lt(V)}),ke=mt(function(de){de&&M.current.hideHelp();var V=Le(ze);O?.(V),Jr(!O,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),z?.(V)}),Qe=function(V){if(!(d||!J||ze.length<=pe)){var ve=Ue(ze);ve.splice(V,1),I?.(Le(ve)),Fe(ve);var we=Math.max(0,V-1);M.current.hideHelp(),M.current.focus(we)}},st=_l(j,k,ze,ee,F,Ne,Fe,ke,Ee,J,pe),Je=ge(st,5),Sn=Je[0],wn=Je[1],ft=Je[2],vt=Je[3],$n=Je[4],Dt=function(V,ve){if(!d){var we=Ue(ze),Be=0,Ve=0,nt=F-ee;ze.forEach(function(bt,qt){var kn=Math.abs(V-bt);kn<=nt&&(nt=kn,Be=qt),bt<V&&(Ve=qt)});var Ke=Be;J&&nt!==0&&(!_||ze.length<_)?(we.splice(Ve+1,0,V),Ke=Ve+1):we[Be]=V,X&&!ze.length&&A===void 0&&we.push(V);var at=Le(we);if(I?.(at),Fe(we),ve){var it,Mt;(it=document.activeElement)===null||it===void 0||(Mt=it.blur)===null||Mt===void 0||Mt.call(it),M.current.focus(Ke),$n(ve,Ke,we)}else O?.(at),Jr(!O,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),z?.(at)}},Rn=function(V){V.preventDefault();var ve=j.current.getBoundingClientRect(),we=ve.width,Be=ve.height,Ve=ve.left,nt=ve.top,Ke=ve.bottom,at=ve.right,it=V.clientX,Mt=V.clientY,bt;switch(k){case"btt":bt=(Ke-Mt)/Be;break;case"ttb":bt=(Mt-nt)/Be;break;case"rtl":bt=(at-it)/we;break;default:bt=(it-Ve)/we}var qt=ee+bt*(F-ee);Dt(Ne(qt),V)},En=h.useState(null),Nt=ge(En,2),ln=Nt[0],Mn=Nt[1],Pn=function(V,ve){if(!d){var we=Ee(ze,V,ve);I?.(Le(ze)),Fe(we.values),Mn(we.value)}};h.useEffect(function(){if(ln!==null){var de=ze.indexOf(ln);de>=0&&M.current.focus(de)}Mn(null)},[ln]);var In=h.useMemo(function(){return te&&re===null?!1:te},[te,re]),jn=mt(function(de,V){$n(de,V),I?.(Le(ze))}),On=Sn!==-1;h.useEffect(function(){if(!On){var de=ze.lastIndexOf(wn);M.current.focus(de)}},[On]);var Et=h.useMemo(function(){return Ue(vt).sort(function(de,V){return de-V})},[vt]),zt=h.useMemo(function(){return X?[Et[0],Et[Et.length-1]]:[ee,Et[0]]},[Et,X,ee]),Kt=ge(zt,2),Vt=Kt[0],cn=Kt[1];h.useImperativeHandle(e,function(){return{focus:function(){M.current.focus(0)},blur:function(){var V,ve=document,we=ve.activeElement;(V=j.current)!==null&&V!==void 0&&V.contains(we)&&we?.blur()}}}),h.useEffect(function(){m&&M.current.focus(0)},[]);var Tn=h.useMemo(function(){return{min:ee,max:F,direction:k,disabled:d,keyboard:f,step:re,included:be,includedStart:Vt,includedEnd:cn,range:X,tabIndex:ye,ariaLabelForHandle:ie,ariaLabelledByForHandle:p,ariaRequired:B,ariaValueTextFormatterForHandle:w,styles:s||{},classNames:a||{}}},[ee,F,k,d,f,re,be,Vt,cn,X,ye,ie,p,B,w,s,a]);return h.createElement(Gt.Provider,{value:Tn},h.createElement("div",{ref:j,className:ue(r,o,Me(Me(Me(Me({},"".concat(r,"-disabled"),d),"".concat(r,"-vertical"),L),"".concat(r,"-horizontal"),!L),"".concat(r,"-with-marks"),Se.length)),style:i,onMouseDown:Rn,id:l},h.createElement("div",{className:ue("".concat(r,"-rail"),a?.rail),style:Oe(Oe({},le),s?.rail)}),xe!==!1&&h.createElement(zl,{prefixCls:r,style:se,values:ze,startPoint:fe,onStartMove:In?jn:void 0}),h.createElement(Nl,{prefixCls:r,marks:Se,dots:Ce,style:Z,activeStyle:ne}),h.createElement(kl,{ref:M,prefixCls:r,style:Q,values:vt,draggingIndex:Sn,draggingDelete:ft,onStartMove:jn,onOffsetChange:Pn,onFocus:b,onBlur:g,handleRender:$e,activeHandleRender:he,onChangeComplete:ke,onDelete:J?Qe:void 0}),h.createElement(Bl,{prefixCls:r,marks:Se,onClick:Dt})))});const Yi=h.createContext({}),vo=h.forwardRef((t,e)=>{const{open:n,draggingDelete:r,value:o}=t,i=h.useRef(null),a=n&&!r,s=h.useRef(null);function l(){Xt.cancel(s.current),s.current=null}function c(){s.current=Xt(()=>{var d;(d=i.current)===null||d===void 0||d.forceAlign(),s.current=null})}return h.useEffect(()=>(a?c():l(),l),[a,t.title,o]),h.createElement(Ci,Object.assign({ref:Nr(i,e)},t,{open:a}))}),Xl=t=>{const{componentCls:e,antCls:n,controlSize:r,dotSize:o,marginFull:i,marginPart:a,colorFillContentHover:s,handleColorDisabled:l,calc:c,handleSize:d,handleSizeHover:u,handleActiveColor:f,handleActiveOutlineColor:m,handleLineWidth:b,handleLineWidthHover:g,motionDurationMid:y}=t;return{[e]:Object.assign(Object.assign({},sn(t)),{position:"relative",height:r,margin:`${G(a)} ${G(i)}`,padding:0,cursor:"pointer",touchAction:"none","&-vertical":{margin:`${G(i)} ${G(a)}`},[`${e}-rail`]:{position:"absolute",backgroundColor:t.railBg,borderRadius:t.borderRadiusXS,transition:`background-color ${y}`},[`${e}-track,${e}-tracks`]:{position:"absolute",transition:`background-color ${y}`},[`${e}-track`]:{backgroundColor:t.trackBg,borderRadius:t.borderRadiusXS},[`${e}-track-draggable`]:{boxSizing:"content-box",backgroundClip:"content-box",border:"solid rgba(0,0,0,0)"},"&:hover":{[`${e}-rail`]:{backgroundColor:t.railHoverBg},[`${e}-track`]:{backgroundColor:t.trackHoverBg},[`${e}-dot`]:{borderColor:s},[`${e}-handle::after`]:{boxShadow:`0 0 0 ${G(b)} ${t.colorPrimaryBorderHover}`},[`${e}-dot-active`]:{borderColor:t.dotActiveBorderColor}},[`${e}-handle`]:{position:"absolute",width:d,height:d,outline:"none",userSelect:"none","&-dragging-delete":{opacity:0},"&::before":{content:'""',position:"absolute",insetInlineStart:c(b).mul(-1).equal(),insetBlockStart:c(b).mul(-1).equal(),width:c(d).add(c(b).mul(2)).equal(),height:c(d).add(c(b).mul(2)).equal(),backgroundColor:"transparent"},"&::after":{content:'""',position:"absolute",insetBlockStart:0,insetInlineStart:0,width:d,height:d,backgroundColor:t.colorBgElevated,boxShadow:`0 0 0 ${G(b)} ${t.handleColor}`,outline:"0px solid transparent",borderRadius:"50%",cursor:"pointer",transition:`
            inset-inline-start ${y},
            inset-block-start ${y},
            width ${y},
            height ${y},
            box-shadow ${y},
            outline ${y}
          `},"&:hover, &:active, &:focus":{"&::before":{insetInlineStart:c(u).sub(d).div(2).add(g).mul(-1).equal(),insetBlockStart:c(u).sub(d).div(2).add(g).mul(-1).equal(),width:c(u).add(c(g).mul(2)).equal(),height:c(u).add(c(g).mul(2)).equal()},"&::after":{boxShadow:`0 0 0 ${G(g)} ${f}`,outline:`6px solid ${m}`,width:u,height:u,insetInlineStart:t.calc(d).sub(u).div(2).equal(),insetBlockStart:t.calc(d).sub(u).div(2).equal()}}},[`&-lock ${e}-handle`]:{"&::before, &::after":{transition:"none"}},[`${e}-mark`]:{position:"absolute",fontSize:t.fontSize},[`${e}-mark-text`]:{position:"absolute",display:"inline-block",color:t.colorTextDescription,textAlign:"center",wordBreak:"keep-all",cursor:"pointer",userSelect:"none","&-active":{color:t.colorText}},[`${e}-step`]:{position:"absolute",background:"transparent",pointerEvents:"none"},[`${e}-dot`]:{position:"absolute",width:o,height:o,backgroundColor:t.colorBgElevated,border:`${G(b)} solid ${t.dotBorderColor}`,borderRadius:"50%",cursor:"pointer",transition:`border-color ${t.motionDurationSlow}`,pointerEvents:"auto","&-active":{borderColor:t.dotActiveBorderColor}},[`&${e}-disabled`]:{cursor:"not-allowed",[`${e}-rail`]:{backgroundColor:`${t.railBg} !important`},[`${e}-track`]:{backgroundColor:`${t.trackBgDisabled} !important`},[`
          ${e}-dot
        `]:{backgroundColor:t.colorBgElevated,borderColor:t.trackBgDisabled,boxShadow:"none",cursor:"not-allowed"},[`${e}-handle::after`]:{backgroundColor:t.colorBgElevated,cursor:"not-allowed",width:d,height:d,boxShadow:`0 0 0 ${G(b)} ${l}`,insetInlineStart:0,insetBlockStart:0},[`
          ${e}-mark-text,
          ${e}-dot
        `]:{cursor:"not-allowed !important"}},[`&-tooltip ${n}-tooltip-inner`]:{minWidth:"unset"}})}},Gi=(t,e)=>{const{componentCls:n,railSize:r,handleSize:o,dotSize:i,marginFull:a,calc:s}=t,l=e?"paddingBlock":"paddingInline",c=e?"width":"height",d=e?"height":"width",u=e?"insetBlockStart":"insetInlineStart",f=e?"top":"insetInlineStart",m=s(r).mul(3).sub(o).div(2).equal(),b=s(o).sub(r).div(2).equal(),g=e?{borderWidth:`${G(b)} 0`,transform:`translateY(${G(s(b).mul(-1).equal())})`}:{borderWidth:`0 ${G(b)}`,transform:`translateX(${G(t.calc(b).mul(-1).equal())})`};return{[l]:r,[d]:s(r).mul(3).equal(),[`${n}-rail`]:{[c]:"100%",[d]:r},[`${n}-track,${n}-tracks`]:{[d]:r},[`${n}-track-draggable`]:Object.assign({},g),[`${n}-handle`]:{[u]:m},[`${n}-mark`]:{insetInlineStart:0,top:0,[f]:s(r).mul(3).add(e?0:a).equal(),[c]:"100%"},[`${n}-step`]:{insetInlineStart:0,top:0,[f]:r,[c]:"100%",[d]:r},[`${n}-dot`]:{position:"absolute",[u]:s(r).sub(i).div(2).equal()}}},Yl=t=>{const{componentCls:e,marginPartWithMark:n}=t;return{[`${e}-horizontal`]:Object.assign(Object.assign({},Gi(t,!0)),{[`&${e}-with-marks`]:{marginBottom:n}})}},Gl=t=>{const{componentCls:e}=t;return{[`${e}-vertical`]:Object.assign(Object.assign({},Gi(t,!1)),{height:"100%"})}},Kl=t=>{const n=t.controlHeightLG/4,r=t.controlHeightSM/2,o=t.lineWidth+1,i=t.lineWidth+1*1.5,a=t.colorPrimary,s=new br(a).setA(.2).toRgbString();return{controlSize:n,railSize:4,handleSize:n,handleSizeHover:r,dotSize:8,handleLineWidth:o,handleLineWidthHover:i,railBg:t.colorFillTertiary,railHoverBg:t.colorFillSecondary,trackBg:t.colorPrimaryBorder,trackHoverBg:t.colorPrimaryBorderHover,handleColor:t.colorPrimaryBorder,handleActiveColor:a,handleActiveOutlineColor:s,handleColorDisabled:new br(t.colorTextDisabled).onBackground(t.colorBgContainer).toHexString(),dotBorderColor:t.colorBorderSecondary,dotActiveBorderColor:t.colorPrimaryBorder,trackBgDisabled:t.colorBgContainerDisabled}},Vl=rn("Slider",t=>{const e=on(t,{marginPart:t.calc(t.controlHeight).sub(t.controlSize).div(2).equal(),marginFull:t.calc(t.controlSize).div(2).equal(),marginPartWithMark:t.calc(t.controlHeightLG).sub(t.controlSize).equal()});return[Xl(e),Yl(e),Gl(e)]},Kl);function lr(){const[t,e]=h.useState(!1),n=h.useRef(null),r=()=>{Xt.cancel(n.current)},o=i=>{r(),i?e(i):n.current=Xt(()=>{e(i)})};return h.useEffect(()=>r,[]),[t,o]}var ql=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Ul(t,e){return t||t===null?t:e||e===null?e:n=>typeof n=="number"?n.toString():""}const Ki=U.forwardRef((t,e)=>{const{prefixCls:n,range:r,className:o,rootClassName:i,style:a,disabled:s,tooltipPrefixCls:l,tipFormatter:c,tooltipVisible:d,getTooltipPopupContainer:u,tooltipPlacement:f,tooltip:m={},onChangeComplete:b,classNames:g,styles:y}=t,x=ql(t,["prefixCls","range","className","rootClassName","style","disabled","tooltipPrefixCls","tipFormatter","tooltipVisible","getTooltipPopupContainer","tooltipPlacement","tooltip","onChangeComplete","classNames","styles"]),{vertical:C}=t,{getPrefixCls:S,direction:R,className:P,style:E,classNames:D,styles:T,getPopupContainer:A}=zr("slider"),$=U.useContext(xi),I=s??$,{handleRender:O,direction:z}=U.useContext(Yi),K=(z||R)==="rtl",[H,q]=lr(),[oe,L]=lr(),ae=Object.assign({},m),{open:be,placement:fe,getPopupContainer:se,prefixCls:Q,formatter:le}=ae,Z=be??d,ne=(H||oe)&&Z!==!1,ce=Ul(le,c),[Ce,$e]=lr(),he=X=>{b?.(X),$e(!1)},xe=(X,J)=>X||(J?K?"left":"right":"top"),Re=S("slider",n),[ye,ie,p]=Vl(Re),B=ue(o,P,D.root,g?.root,i,{[`${Re}-rtl`]:K,[`${Re}-lock`]:Ce},ie,p);K&&!x.vertical&&(x.reverse=!x.reverse),U.useEffect(()=>{const X=()=>{Xt(()=>{L(!1)},1)};return document.addEventListener("mouseup",X),()=>{document.removeEventListener("mouseup",X)}},[]);const w=r&&!Z,M=O||((X,J)=>{const{index:te}=J,pe=X.props;function _(me,Se,Ae){var We,Ne,Ee,Te;Ae&&((Ne=(We=x)[me])===null||Ne===void 0||Ne.call(We,Se)),(Te=(Ee=pe)[me])===null||Te===void 0||Te.call(Ee,Se)}const ee=Object.assign(Object.assign({},pe),{onMouseEnter:me=>{q(!0),_("onMouseEnter",me)},onMouseLeave:me=>{q(!1),_("onMouseLeave",me)},onMouseDown:me=>{L(!0),$e(!0),_("onMouseDown",me)},onFocus:me=>{var Se;L(!0),(Se=x.onFocus)===null||Se===void 0||Se.call(x,me),_("onFocus",me,!0)},onBlur:me=>{var Se;L(!1),(Se=x.onBlur)===null||Se===void 0||Se.call(x,me),_("onBlur",me,!0)}}),F=U.cloneElement(X,ee),re=(!!Z||ne)&&ce!==null;return w?F:U.createElement(vo,Object.assign({},ae,{prefixCls:S("tooltip",Q??l),title:ce?ce(J.value):"",value:J.value,open:re,placement:xe(fe??f,C),key:te,classNames:{root:`${Re}-tooltip`},getPopupContainer:se||u||A}),F)}),j=w?(X,J)=>{const te=U.cloneElement(X,{style:Object.assign(Object.assign({},X.props.style),{visibility:"hidden"})});return U.createElement(vo,Object.assign({},ae,{prefixCls:S("tooltip",Q??l),title:ce?ce(J.value):"",open:ce!==null&&ne,placement:xe(fe??f,C),key:"tooltip",classNames:{root:`${Re}-tooltip`},getPopupContainer:se||u||A,draggingDelete:J.draggingDelete}),te)}:void 0,k=Object.assign(Object.assign(Object.assign(Object.assign({},T.root),E),y?.root),a),Y=Object.assign(Object.assign({},T.tracks),y?.tracks),W=ue(D.tracks,g?.tracks);return ye(U.createElement(Fl,Object.assign({},x,{classNames:Object.assign({handle:ue(D.handle,g?.handle),rail:ue(D.rail,g?.rail),track:ue(D.track,g?.track)},W?{tracks:W}:{}),styles:Object.assign({handle:Object.assign(Object.assign({},T.handle),y?.handle),rail:Object.assign(Object.assign({},T.rail),y?.rail),track:Object.assign(Object.assign({},T.track),y?.track)},Object.keys(Y).length?{tracks:Y}:{}),step:x.step,range:r,className:B,style:k,disabled:I,ref:e,prefixCls:Re,handleRender:M,activeHandleRender:j,onChangeComplete:he})))});var Jl=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Vi=t=>{const{prefixCls:e,colors:n,type:r,color:o,range:i=!1,className:a,activeIndex:s,onActive:l,onDragStart:c,onDragChange:d,onKeyDelete:u}=t,f=Jl(t,["prefixCls","colors","type","color","range","className","activeIndex","onActive","onDragStart","onDragChange","onKeyDelete"]),m=Object.assign(Object.assign({},f),{track:!1}),b=h.useMemo(()=>`linear-gradient(90deg, ${n.map(E=>`${E.color} ${E.percent}%`).join(", ")})`,[n]),g=h.useMemo(()=>!o||!r?null:r==="alpha"?o.toRgbString():`hsl(${o.toHsb().h}, 100%, 50%)`,[o,r]),y=mt(c),x=mt(d),C=h.useMemo(()=>({onDragStart:y,onDragChange:x}),[]),S=mt((P,E)=>{const{onFocus:D,style:T,className:A,onKeyDown:$}=P.props,I=Object.assign({},T);return r==="gradient"&&(I.background=Si(n,E.value)),h.cloneElement(P,{onFocus:O=>{l?.(E.index),D?.(O)},style:I,className:ue(A,{[`${e}-slider-handle-active`]:s===E.index}),onKeyDown:O=>{(O.key==="Delete"||O.key==="Backspace")&&u&&u(E.index),$?.(O)}})}),R=h.useMemo(()=>({direction:"ltr",handleRender:S}),[]);return h.createElement(Yi.Provider,{value:R},h.createElement(Xi.Provider,{value:C},h.createElement(Ki,Object.assign({},m,{className:ue(a,`${e}-slider`),tooltip:{open:!1},range:{editable:i,minCount:2},styles:{rail:{background:b},handle:g?{background:g}:{}},classNames:{rail:`${e}-slider-rail`,handle:`${e}-slider-handle`}}))))},Zl=t=>{const{value:e,onChange:n,onChangeComplete:r}=t,o=a=>n(a[0]),i=a=>r(a[0]);return h.createElement(Vi,Object.assign({},t,{value:[e],onChange:o,onChangeComplete:i}))};function bo(t){return Ue(t).sort((e,n)=>e.percent-n.percent)}const Ql=t=>{const{prefixCls:e,mode:n,onChange:r,onChangeComplete:o,onActive:i,activeIndex:a,onGradientDragging:s,colors:l}=t,c=n==="gradient",d=h.useMemo(()=>l.map(x=>({percent:x.percent,color:x.color.toRgbString()})),[l]),u=h.useMemo(()=>d.map(x=>x.percent),[d]),f=h.useRef(d),m=({rawValues:x,draggingIndex:C,draggingValue:S})=>{if(x.length>d.length){const R=Si(d,S),P=Ue(d);P.splice(C,0,{percent:S,color:R}),f.current=P}else f.current=d;s(!0),r(new xt(bo(f.current)),!0)},b=({deleteIndex:x,draggingIndex:C,draggingValue:S})=>{let R=Ue(f.current);x!==-1?R.splice(x,1):(R[C]=Object.assign(Object.assign({},R[C]),{percent:S}),R=bo(R)),r(new xt(R),!0)},g=x=>{const C=Ue(d);C.splice(x,1);const S=new xt(C);r(S),o(S)},y=x=>{o(new xt(d)),a>=x.length&&i(x.length-1),s(!1)};return c?h.createElement(Vi,{min:0,max:100,prefixCls:e,className:`${e}-gradient-slider`,colors:d,color:null,value:u,range:!0,onChangeComplete:y,disabled:!1,type:"gradient",activeIndex:a,onActive:i,onDragStart:m,onDragChange:b,onKeyDelete:g}):null},ec=h.memo(Ql);var tc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const nc={slider:Zl},yo=()=>{const t=h.useContext(zi),{mode:e,onModeChange:n,modeOptions:r,prefixCls:o,allowClear:i,value:a,disabledAlpha:s,onChange:l,onClear:c,onChangeComplete:d,activeIndex:u,gradientDragging:f}=t,m=tc(t,["mode","onModeChange","modeOptions","prefixCls","allowClear","value","disabledAlpha","onChange","onClear","onChangeComplete","activeIndex","gradientDragging"]),b=U.useMemo(()=>a.cleared?[{percent:0,color:new xt("")},{percent:100,color:new xt("")}]:a.getColors(),[a]),g=!a.isGradient(),[y,x]=U.useState(a);Xn(()=>{var N;g||x((N=b[u])===null||N===void 0?void 0:N.color)},[f,u]);const C=U.useMemo(()=>{var N;return g?a:f?y:(N=b[u])===null||N===void 0?void 0:N.color},[a,u,g,y,f]),[S,R]=U.useState(C),[P,E]=U.useState(0),D=S?.equals(C)?C:S;Xn(()=>{R(C)},[P,C?.toHexString()]);const T=(N,K)=>{let H=dt(N);if(a.cleared){const oe=H.toRgb();if(!oe.r&&!oe.g&&!oe.b&&K){const{type:L,value:ae=0}=K;H=new xt({h:L==="hue"?ae:0,s:1,b:1,a:L==="alpha"?ae/100:1})}else H=zn(H)}if(e==="single")return H;const q=Ue(b);return q[u]=Object.assign(Object.assign({},q[u]),{color:H}),new xt(q)},A=(N,K,H)=>{const q=T(N,H);R(q.isGradient()?q.getColors()[u].color:q),l(q,K)},$=(N,K)=>{d(T(N,K)),E(H=>H+1)},I=N=>{l(T(N))};let O=null;const z=r.length>1;return(i||z)&&(O=U.createElement("div",{className:`${o}-operation`},z&&U.createElement(Sl,{size:"small",options:r,value:e,onChange:n}),U.createElement(_i,Object.assign({prefixCls:o,value:a,onChange:N=>{l(N),c?.()}},m)))),U.createElement(U.Fragment,null,O,U.createElement(ec,Object.assign({},t,{colors:b})),U.createElement(da,{prefixCls:o,value:D?.toHsb(),disabledAlpha:s,onChange:(N,K)=>{A(N,!0,K)},onChangeComplete:(N,K)=>{$(N,K)},components:nc}),U.createElement(jl,Object.assign({value:C,onChange:I,prefixCls:o,disabledAlpha:s},m)))},Co=()=>{const{prefixCls:t,value:e,presets:n,onChange:r}=h.useContext(Li);return Array.isArray(n)?U.createElement(Os,{value:e,presets:n,prefixCls:t,onChange:r}):null},rc=t=>{const{prefixCls:e,presets:n,panelRender:r,value:o,onChange:i,onClear:a,allowClear:s,disabledAlpha:l,mode:c,onModeChange:d,modeOptions:u,onChangeComplete:f,activeIndex:m,onActive:b,format:g,onFormatChange:y,gradientDragging:x,onGradientDragging:C,disabledFormat:S}=t,R=`${e}-inner`,P=U.useMemo(()=>({prefixCls:e,value:o,onChange:i,onClear:a,allowClear:s,disabledAlpha:l,mode:c,onModeChange:d,modeOptions:u,onChangeComplete:f,activeIndex:m,onActive:b,format:g,onFormatChange:y,gradientDragging:x,onGradientDragging:C,disabledFormat:S}),[e,o,i,a,s,l,c,d,u,f,m,b,g,y,x,C,S]),E=U.useMemo(()=>({prefixCls:e,value:o,presets:n,onChange:i}),[e,o,n,i]),D=U.createElement("div",{className:`${R}-content`},U.createElement(yo,null),Array.isArray(n)&&U.createElement(_r,null),U.createElement(Co,null));return U.createElement(zi.Provider,{value:P},U.createElement(Li.Provider,{value:E},U.createElement("div",{className:R},typeof r=="function"?r(D,{components:{Picker:yo,Presets:Co}}):D)))};var oc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const ic=h.forwardRef((t,e)=>{const{color:n,prefixCls:r,open:o,disabled:i,format:a,className:s,showText:l,activeIndex:c}=t,d=oc(t,["color","prefixCls","open","disabled","format","className","showText","activeIndex"]),u=`${r}-trigger`,f=`${u}-text`,m=`${f}-cell`,[b]=wi("ColorPicker"),g=U.useMemo(()=>{if(!l)return"";if(typeof l=="function")return l(n);if(n.cleared)return b.transparent;if(n.isGradient())return n.getColors().map((S,R)=>{const P=c!==-1&&c!==R;return U.createElement("span",{key:R,className:ue(m,P&&`${m}-inactive`)},S.color.toRgbString()," ",S.percent,"%")});const x=n.toHexString().toUpperCase(),C=Lr(n);switch(a){case"rgb":return n.toRgbString();case"hsb":return n.toHsbString();default:return C<100?`${x.slice(0,7)},${C}%`:x}},[n,a,l,c]),y=h.useMemo(()=>n.cleared?U.createElement(_i,{prefixCls:r}):U.createElement(pi,{prefixCls:r,color:n.toCssString()}),[n,r]);return U.createElement("div",Object.assign({ref:e,className:ue(u,s,{[`${u}-active`]:o,[`${u}-disabled`]:i})},Ts(d)),y,l&&U.createElement("div",{className:f},g))});function sc(t,e,n){const[r]=wi("ColorPicker"),[o,i]=Rt(t,{value:e}),[a,s]=h.useState("single"),[l,c]=h.useMemo(()=>{const g=(Array.isArray(n)?n:[n]).filter(S=>S);g.length||g.push("single");const y=new Set(g),x=[],C=(S,R)=>{y.has(S)&&x.push({label:R,value:S})};return C("single",r.singleColor),C("gradient",r.gradientColor),[x,y]},[n]),[d,u]=h.useState(null),f=mt(g=>{u(g),i(g)}),m=h.useMemo(()=>{const g=dt(o||"");return g.equals(d)?d:g},[o,d]),b=h.useMemo(()=>{var g;return c.has(a)?a:(g=l[0])===null||g===void 0?void 0:g.value},[c,a,l]);return h.useEffect(()=>{s(m.isGradient()?"gradient":"single")},[m]),[m,f,b,s,l]}const qi=(t,e)=>({backgroundImage:`conic-gradient(${e} 25%, transparent 25% 50%, ${e} 50% 75%, transparent 75% 100%)`,backgroundSize:`${t} ${t}`}),xo=(t,e)=>{const{componentCls:n,borderRadiusSM:r,colorPickerInsetShadow:o,lineWidth:i,colorFillSecondary:a}=t;return{[`${n}-color-block`]:Object.assign(Object.assign({position:"relative",borderRadius:r,width:e,height:e,boxShadow:o,flex:"none"},qi("50%",t.colorFillSecondary)),{[`${n}-color-block-inner`]:{width:"100%",height:"100%",boxShadow:`inset 0 0 0 ${G(i)} ${a}`,borderRadius:"inherit"}})}},ac=t=>{const{componentCls:e,antCls:n,fontSizeSM:r,lineHeightSM:o,colorPickerAlphaInputWidth:i,marginXXS:a,paddingXXS:s,controlHeightSM:l,marginXS:c,fontSizeIcon:d,paddingXS:u,colorTextPlaceholder:f,colorPickerInputNumberHandleWidth:m,lineWidth:b}=t;return{[`${e}-input-container`]:{display:"flex",[`${e}-steppers${n}-input-number`]:{fontSize:r,lineHeight:o,[`${n}-input-number-input`]:{paddingInlineStart:s,paddingInlineEnd:0},[`${n}-input-number-handler-wrap`]:{width:m}},[`${e}-steppers${e}-alpha-input`]:{flex:`0 0 ${G(i)}`,marginInlineStart:a},[`${e}-format-select${n}-select`]:{marginInlineEnd:c,width:"auto","&-single":{[`${n}-select-selector`]:{padding:0,border:0},[`${n}-select-arrow`]:{insetInlineEnd:0},[`${n}-select-selection-item`]:{paddingInlineEnd:t.calc(d).add(a).equal(),fontSize:r,lineHeight:G(l)},[`${n}-select-item-option-content`]:{fontSize:r,lineHeight:o},[`${n}-select-dropdown`]:{[`${n}-select-item`]:{minHeight:"auto"}}}},[`${e}-input`]:{gap:a,alignItems:"center",flex:1,width:0,[`${e}-hsb-input,${e}-rgb-input`]:{display:"flex",gap:a,alignItems:"center"},[`${e}-steppers`]:{flex:1},[`${e}-hex-input${n}-input-affix-wrapper`]:{flex:1,padding:`0 ${G(u)}`,[`${n}-input`]:{fontSize:r,textTransform:"uppercase",lineHeight:G(t.calc(l).sub(t.calc(b).mul(2)).equal())},[`${n}-input-prefix`]:{color:f}}}}}},lc=t=>{const{componentCls:e,controlHeightLG:n,borderRadiusSM:r,colorPickerInsetShadow:o,marginSM:i,colorBgElevated:a,colorFillSecondary:s,lineWidthBold:l,colorPickerHandlerSize:c}=t;return{userSelect:"none",[`${e}-select`]:{[`${e}-palette`]:{minHeight:t.calc(n).mul(4).equal(),overflow:"hidden",borderRadius:r},[`${e}-saturation`]:{position:"absolute",borderRadius:"inherit",boxShadow:o,inset:0},marginBottom:i},[`${e}-handler`]:{width:c,height:c,border:`${G(l)} solid ${a}`,position:"relative",borderRadius:"50%",cursor:"pointer",boxShadow:`${o}, 0 0 0 1px ${s}`}}},cc=t=>{const{componentCls:e,antCls:n,colorTextQuaternary:r,paddingXXS:o,colorPickerPresetColorSize:i,fontSizeSM:a,colorText:s,lineHeightSM:l,lineWidth:c,borderRadius:d,colorFill:u,colorWhite:f,marginXXS:m,paddingXS:b,fontHeightSM:g}=t;return{[`${e}-presets`]:{[`${n}-collapse-item > ${n}-collapse-header`]:{padding:0,[`${n}-collapse-expand-icon`]:{height:g,color:r,paddingInlineEnd:o}},[`${n}-collapse`]:{display:"flex",flexDirection:"column",gap:m},[`${n}-collapse-item > ${n}-collapse-content > ${n}-collapse-content-box`]:{padding:`${G(b)} 0`},"&-label":{fontSize:a,color:s,lineHeight:l},"&-items":{display:"flex",flexWrap:"wrap",gap:t.calc(m).mul(1.5).equal(),[`${e}-presets-color`]:{position:"relative",cursor:"pointer",width:i,height:i,"&::before":{content:'""',pointerEvents:"none",width:t.calc(i).add(t.calc(c).mul(4)).equal(),height:t.calc(i).add(t.calc(c).mul(4)).equal(),position:"absolute",top:t.calc(c).mul(-2).equal(),insetInlineStart:t.calc(c).mul(-2).equal(),borderRadius:d,border:`${G(c)} solid transparent`,transition:`border-color ${t.motionDurationMid} ${t.motionEaseInBack}`},"&:hover::before":{borderColor:u},"&::after":{boxSizing:"border-box",position:"absolute",top:"50%",insetInlineStart:"21.5%",display:"table",width:t.calc(i).div(13).mul(5).equal(),height:t.calc(i).div(13).mul(8).equal(),border:`${G(t.lineWidthBold)} solid ${t.colorWhite}`,borderTop:0,borderInlineStart:0,transform:"rotate(45deg) scale(0) translate(-50%,-50%)",opacity:0,content:'""',transition:`all ${t.motionDurationFast} ${t.motionEaseInBack}, opacity ${t.motionDurationFast}`},[`&${e}-presets-color-checked`]:{"&::after":{opacity:1,borderColor:f,transform:"rotate(45deg) scale(1) translate(-50%,-50%)",transition:`transform ${t.motionDurationMid} ${t.motionEaseOutBack} ${t.motionDurationFast}`},[`&${e}-presets-color-bright`]:{"&::after":{borderColor:"rgba(0, 0, 0, 0.45)"}}}}},"&-empty":{fontSize:a,color:r}}}},uc=t=>{const{componentCls:e,colorPickerInsetShadow:n,colorBgElevated:r,colorFillSecondary:o,lineWidthBold:i,colorPickerHandlerSizeSM:a,colorPickerSliderHeight:s,marginSM:l,marginXS:c}=t,d=t.calc(a).sub(t.calc(i).mul(2).equal()).equal(),u=t.calc(a).add(t.calc(i).mul(2).equal()).equal(),f={"&:after":{transform:"scale(1)",boxShadow:`${n}, 0 0 0 1px ${t.colorPrimaryActive}`}};return{[`${e}-slider`]:[qi(G(s),t.colorFillSecondary),{margin:0,padding:0,height:s,borderRadius:t.calc(s).div(2).equal(),"&-rail":{height:s,borderRadius:t.calc(s).div(2).equal(),boxShadow:n},[`& ${e}-slider-handle`]:{width:d,height:d,top:0,borderRadius:"100%","&:before":{display:"block",position:"absolute",background:"transparent",left:{_skip_check_:!0,value:"50%"},top:"50%",transform:"translate(-50%, -50%)",width:u,height:u,borderRadius:"100%"},"&:after":{width:a,height:a,border:`${G(i)} solid ${r}`,boxShadow:`${n}, 0 0 0 1px ${o}`,outline:"none",insetInlineStart:t.calc(i).mul(-1).equal(),top:t.calc(i).mul(-1).equal(),background:"transparent",transition:"none"},"&:focus":f}}],[`${e}-slider-container`]:{display:"flex",gap:l,marginBottom:l,[`${e}-slider-group`]:{flex:1,flexDirection:"column",justifyContent:"space-between",display:"flex","&-disabled-alpha":{justifyContent:"center"}}},[`${e}-gradient-slider`]:{marginBottom:c,[`& ${e}-slider-handle`]:{"&:after":{transform:"scale(0.8)"},"&-active, &:focus":f}}}},$r=(t,e,n)=>({borderInlineEndWidth:t.lineWidth,borderColor:e,boxShadow:`0 0 0 ${G(t.controlOutlineWidth)} ${n}`,outline:0}),dc=t=>{const{componentCls:e}=t;return{"&-rtl":{[`${e}-presets-color`]:{"&::after":{direction:"ltr"}},[`${e}-clear`]:{"&::after":{direction:"ltr"}}}}},So=(t,e,n)=>{const{componentCls:r,borderRadiusSM:o,lineWidth:i,colorSplit:a,colorBorder:s,red6:l}=t;return{[`${r}-clear`]:Object.assign(Object.assign({width:e,height:e,borderRadius:o,border:`${G(i)} solid ${a}`,position:"relative",overflow:"hidden",cursor:"inherit",transition:`all ${t.motionDurationFast}`},n),{"&::after":{content:'""',position:"absolute",insetInlineEnd:t.calc(i).mul(-1).equal(),top:t.calc(i).mul(-1).equal(),display:"block",width:40,height:2,transformOrigin:"calc(100% - 1px) 1px",transform:"rotate(-45deg)",backgroundColor:l},"&:hover":{borderColor:s}})}},fc=t=>{const{componentCls:e,colorError:n,colorWarning:r,colorErrorHover:o,colorWarningHover:i,colorErrorOutline:a,colorWarningOutline:s}=t;return{[`&${e}-status-error`]:{borderColor:n,"&:hover":{borderColor:o},[`&${e}-trigger-active`]:Object.assign({},$r(t,n,a))},[`&${e}-status-warning`]:{borderColor:r,"&:hover":{borderColor:i},[`&${e}-trigger-active`]:Object.assign({},$r(t,r,s))}}},hc=t=>{const{componentCls:e,controlHeightLG:n,controlHeightSM:r,controlHeight:o,controlHeightXS:i,borderRadius:a,borderRadiusSM:s,borderRadiusXS:l,borderRadiusLG:c,fontSizeLG:d}=t;return{[`&${e}-lg`]:{minWidth:n,minHeight:n,borderRadius:c,[`${e}-color-block, ${e}-clear`]:{width:o,height:o,borderRadius:a},[`${e}-trigger-text`]:{fontSize:d}},[`&${e}-sm`]:{minWidth:r,minHeight:r,borderRadius:s,[`${e}-color-block, ${e}-clear`]:{width:i,height:i,borderRadius:l},[`${e}-trigger-text`]:{lineHeight:G(i)}}}},gc=t=>{const{antCls:e,componentCls:n,colorPickerWidth:r,colorPrimary:o,motionDurationMid:i,colorBgElevated:a,colorTextDisabled:s,colorText:l,colorBgContainerDisabled:c,borderRadius:d,marginXS:u,marginSM:f,controlHeight:m,controlHeightSM:b,colorBgTextActive:g,colorPickerPresetColorSize:y,colorPickerPreviewSize:x,lineWidth:C,colorBorder:S,paddingXXS:R,fontSize:P,colorPrimaryHover:E,controlOutline:D}=t;return[{[n]:Object.assign({[`${n}-inner`]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({"&-content":{display:"flex",flexDirection:"column",width:r,[`& > ${e}-divider`]:{margin:`${G(f)} 0 ${G(u)}`}},[`${n}-panel`]:Object.assign({},lc(t))},uc(t)),xo(t,x)),ac(t)),cc(t)),So(t,y,{marginInlineStart:"auto"})),{[`${n}-operation`]:{display:"flex",justifyContent:"space-between",marginBottom:u}}),"&-trigger":Object.assign(Object.assign(Object.assign(Object.assign({minWidth:m,minHeight:m,borderRadius:d,border:`${G(C)} solid ${S}`,cursor:"pointer",display:"inline-flex",alignItems:"flex-start",justifyContent:"center",transition:`all ${i}`,background:a,padding:t.calc(R).sub(C).equal(),[`${n}-trigger-text`]:{marginInlineStart:u,marginInlineEnd:t.calc(u).sub(t.calc(R).sub(C)).equal(),fontSize:P,color:l,alignSelf:"center","&-cell":{"&:not(:last-child):after":{content:'", "'},"&-inactive":{color:s}}},"&:hover":{borderColor:E},[`&${n}-trigger-active`]:Object.assign({},$r(t,o,D)),"&-disabled":{color:s,background:c,cursor:"not-allowed","&:hover":{borderColor:g},[`${n}-trigger-text`]:{color:s}}},So(t,b)),xo(t,b)),fc(t)),hc(t))},dc(t))},ks(t,{focusElCls:`${n}-trigger-active`})]},pc=rn("ColorPicker",t=>{const{colorTextQuaternary:e,marginSM:n}=t,r=8,o=on(t,{colorPickerWidth:234,colorPickerHandlerSize:16,colorPickerHandlerSizeSM:12,colorPickerAlphaInputWidth:44,colorPickerInputNumberHandleWidth:16,colorPickerPresetColorSize:24,colorPickerInsetShadow:`inset 0 0 1px 0 ${e}`,colorPickerSliderHeight:r,colorPickerPreviewSize:t.calc(r).mul(2).add(n).equal()});return[gc(o)]});var mc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Qt=t=>{const{mode:e,value:n,defaultValue:r,format:o,defaultFormat:i,allowClear:a=!1,presets:s,children:l,trigger:c="click",open:d,disabled:u,placement:f="bottomLeft",arrow:m=!0,panelRender:b,showText:g,style:y,className:x,size:C,rootClassName:S,prefixCls:R,styles:P,disabledAlpha:E=!1,onFormatChange:D,onChange:T,onClear:A,onOpenChange:$,onChangeComplete:I,getPopupContainer:O,autoAdjustOverflow:z=!0,destroyTooltipOnHide:N,destroyOnHidden:K,disabledFormat:H}=t,q=mc(t,["mode","value","defaultValue","format","defaultFormat","allowClear","presets","children","trigger","open","disabled","placement","arrow","panelRender","showText","style","className","size","rootClassName","prefixCls","styles","disabledAlpha","onFormatChange","onChange","onClear","onOpenChange","onChangeComplete","getPopupContainer","autoAdjustOverflow","destroyTooltipOnHide","destroyOnHidden","disabledFormat"]),{getPrefixCls:oe,direction:L,colorPicker:ae}=h.useContext(Bt),be=h.useContext(xi),fe=u??be,[se,Q]=Rt(!1,{value:d,postState:Ee=>!fe&&Ee,onChange:$}),[le,Z]=Rt(o,{value:o,defaultValue:i,onChange:D}),ne=oe("color-picker",R),[ce,Ce,$e,he,xe]=sc(r,n,e),Re=h.useMemo(()=>Lr(ce)<100,[ce]),[ye,ie]=U.useState(null),p=Ee=>{if(I){let Te=dt(Ee);E&&Re&&(Te=zn(Ee)),I(Te)}},B=(Ee,Te)=>{let Pe=dt(Ee);E&&Re&&(Pe=zn(Pe)),Ce(Pe),ie(null),T&&T(Pe,Pe.toCssString()),Te||p(Pe)},[w,M]=U.useState(0),[j,k]=U.useState(!1),Y=Ee=>{if(he(Ee),Ee==="single"&&ce.isGradient())M(0),B(new xt(ce.getColors()[0].color)),ie(ce);else if(Ee==="gradient"&&!ce.isGradient()){const Te=Re?zn(ce):ce;B(new xt(ye||[{percent:0,color:Te},{percent:100,color:Te}]))}},{status:W}=U.useContext(As),{compactSize:X,compactItemClassnames:J}=Bs(ne,L),te=Qn(Ee=>{var Te;return(Te=C??X)!==null&&Te!==void 0?Te:Ee}),pe=bi(ne),[_,ee,F]=pc(ne,pe),re={[`${ne}-rtl`]:L},me=ue(S,F,pe,re),Se=ue(Ds(ne,W),{[`${ne}-sm`]:te==="small",[`${ne}-lg`]:te==="large"},J,ae?.className,me,x,ee),Ae=ue(ne,me),We={open:se,trigger:c,placement:f,arrow:m,rootClassName:S,getPopupContainer:O,autoAdjustOverflow:z,destroyOnHidden:K??!!N},Ne=Object.assign(Object.assign({},ae?.style),y);return _(U.createElement(Ns,Object.assign({style:P?.popup,styles:{body:P?.popupOverlayInner},onOpenChange:Ee=>{(!Ee||!fe)&&Q(Ee)},content:U.createElement(zs,{form:!0},U.createElement(rc,{mode:$e,onModeChange:Y,modeOptions:xe,prefixCls:ne,value:ce,allowClear:a,disabled:fe,disabledAlpha:E,presets:s,panelRender:b,format:le,onFormatChange:Z,onChange:B,onChangeComplete:p,onClear:A,activeIndex:w,onActive:M,gradientDragging:j,onGradientDragging:k,disabledFormat:H})),classNames:{root:Ae}},We),l||U.createElement(ic,Object.assign({activeIndex:se?w:-1,open:se,className:Se,style:Ne,prefixCls:ne,disabled:fe,showText:g,format:le},q,{color:ce}))))},vc=Ls(Qt,void 0,t=>Object.assign(Object.assign({},t),{placement:"bottom",autoAdjustOverflow:!1}),"color-picker",t=>t);Qt._InternalPanelDoNotUseOrYouWillBeFired=vc;var bc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-in",theme:"outlined"},yc=function(e,n){return h.createElement(Yt,Xe({},e,{ref:n,icon:bc}))},Cc=h.forwardRef(yc),xc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-out",theme:"outlined"},Sc=function(e,n){return h.createElement(Yt,Xe({},e,{ref:n,icon:xc}))},wc=h.forwardRef(Sc);function $c(t,e,n){return typeof n=="boolean"?n:t.length?!0:vi(e).some(o=>o.type===$i)}var Ui=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function rr({suffixCls:t,tagName:e,displayName:n}){return r=>h.forwardRef((i,a)=>h.createElement(r,Object.assign({ref:a,suffixCls:t,tagName:e},i)))}const Fr=h.forwardRef((t,e)=>{const{prefixCls:n,suffixCls:r,className:o,tagName:i}=t,a=Ui(t,["prefixCls","suffixCls","className","tagName"]),{getPrefixCls:s}=h.useContext(Bt),l=s("layout",n),[c,d,u]=Ri(l),f=r?`${l}-${r}`:l;return c(h.createElement(i,Object.assign({className:ue(n||f,o,d,u),ref:e},a)))}),Rc=h.forwardRef((t,e)=>{const{direction:n}=h.useContext(Bt),[r,o]=h.useState([]),{prefixCls:i,className:a,rootClassName:s,children:l,hasSider:c,tagName:d,style:u}=t,f=Ui(t,["prefixCls","className","rootClassName","children","hasSider","tagName","style"]),m=tr(f,["suffixCls"]),{getPrefixCls:b,className:g,style:y}=zr("layout"),x=b("layout",i),C=$c(r,l,c),[S,R,P]=Ri(x),E=ue(x,{[`${x}-has-sider`]:C,[`${x}-rtl`]:n==="rtl"},g,a,s,R,P),D=h.useMemo(()=>({siderHook:{addSider:T=>{o(A=>[].concat(Ue(A),[T]))},removeSider:T=>{o(A=>A.filter($=>$!==T))}}}),[]);return S(h.createElement(_s.Provider,{value:D},h.createElement(d,Object.assign({ref:e,className:E,style:Object.assign(Object.assign({},y),u)},m),l)))}),Ec=rr({tagName:"div",displayName:"Layout"})(Rc),Mc=rr({suffixCls:"header",tagName:"header",displayName:"Header"})(Fr),Pc=rr({suffixCls:"footer",tagName:"footer",displayName:"Footer"})(Fr),Ic=rr({suffixCls:"content",tagName:"main",displayName:"Content"})(Fr),Cn=Ec;Cn.Header=Mc;Cn.Footer=Pc;Cn.Content=Ic;Cn.Sider=$i;Cn._InternalSiderContext=Hs;var jc={percent:0,prefixCls:"rc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,trailColor:"#D9D9D9",trailWidth:1,gapPosition:"bottom"},Oc=function(){var e=h.useRef([]),n=h.useRef(null);return h.useEffect(function(){var r=Date.now(),o=!1;e.current.forEach(function(i){if(i){o=!0;var a=i.style;a.transitionDuration=".3s, .3s, .3s, .06s",n.current&&r-n.current<100&&(a.transitionDuration="0s, 0s")}}),o&&(n.current=Date.now())}),e.current},wo=0,Tc=Ws();function kc(){var t;return Tc?(t=wo,wo+=1):t="TEST_OR_SSR",t}const Ac=(function(t){var e=h.useState(),n=ge(e,2),r=n[0],o=n[1];return h.useEffect(function(){o("rc_progress_".concat(kc()))},[]),t||r});var $o=function(e){var n=e.bg,r=e.children;return h.createElement("div",{style:{width:"100%",height:"100%",background:n}},r)};function Ro(t,e){return Object.keys(t).map(function(n){var r=parseFloat(n),o="".concat(Math.floor(r*e),"%");return"".concat(t[n]," ").concat(o)})}var Bc=h.forwardRef(function(t,e){var n=t.prefixCls,r=t.color,o=t.gradientId,i=t.radius,a=t.style,s=t.ptg,l=t.strokeLinecap,c=t.strokeWidth,d=t.size,u=t.gapDegree,f=r&&gt(r)==="object",m=f?"#FFF":void 0,b=d/2,g=h.createElement("circle",{className:"".concat(n,"-circle-path"),r:i,cx:b,cy:b,stroke:m,strokeLinecap:l,strokeWidth:c,opacity:s===0?0:1,style:a,ref:e});if(!f)return g;var y="".concat(o,"-conic"),x=u?"".concat(180+u/2,"deg"):"0deg",C=Ro(r,(360-u)/360),S=Ro(r,1),R="conic-gradient(from ".concat(x,", ").concat(C.join(", "),")"),P="linear-gradient(to ".concat(u?"bottom":"top",", ").concat(S.join(", "),")");return h.createElement(h.Fragment,null,h.createElement("mask",{id:y},g),h.createElement("foreignObject",{x:0,y:0,width:d,height:d,mask:"url(#".concat(y,")")},h.createElement($o,{bg:P},h.createElement($o,{bg:R}))))}),gn=100,cr=function(e,n,r,o,i,a,s,l,c,d){var u=arguments.length>10&&arguments[10]!==void 0?arguments[10]:0,f=r/100*360*((360-a)/360),m=a===0?0:{bottom:0,top:180,left:90,right:-90}[s],b=(100-o)/100*n;c==="round"&&o!==100&&(b+=d/2,b>=n&&(b=n-.01));var g=gn/2;return{stroke:typeof l=="string"?l:void 0,strokeDasharray:"".concat(n,"px ").concat(e),strokeDashoffset:b+u,transform:"rotate(".concat(i+f+m,"deg)"),transformOrigin:"".concat(g,"px ").concat(g,"px"),transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s, opacity .3s ease 0s",fillOpacity:0}},Dc=["id","prefixCls","steps","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","style","className","strokeColor","percent"];function Eo(t){var e=t??[];return Array.isArray(e)?e:[e]}var Nc=function(e){var n=Oe(Oe({},jc),e),r=n.id,o=n.prefixCls,i=n.steps,a=n.strokeWidth,s=n.trailWidth,l=n.gapDegree,c=l===void 0?0:l,d=n.gapPosition,u=n.trailColor,f=n.strokeLinecap,m=n.style,b=n.className,g=n.strokeColor,y=n.percent,x=kt(n,Dc),C=gn/2,S=Ac(r),R="".concat(S,"-gradient"),P=C-a/2,E=Math.PI*2*P,D=c>0?90+c/2:-90,T=E*((360-c)/360),A=gt(i)==="object"?i:{count:i,gap:2},$=A.count,I=A.gap,O=Eo(y),z=Eo(g),N=z.find(function(be){return be&&gt(be)==="object"}),K=N&&gt(N)==="object",H=K?"butt":f,q=cr(E,T,0,100,D,c,d,u,H,a),oe=Oc(),L=function(){var fe=0;return O.map(function(se,Q){var le=z[Q]||z[z.length-1],Z=cr(E,T,fe,se,D,c,d,le,H,a);return fe+=se,h.createElement(Bc,{key:Q,color:le,ptg:se,radius:P,prefixCls:o,gradientId:R,style:Z,strokeLinecap:H,strokeWidth:a,gapDegree:c,ref:function(ce){oe[Q]=ce},size:gn})}).reverse()},ae=function(){var fe=Math.round($*(O[0]/100)),se=100/$,Q=0;return new Array($).fill(null).map(function(le,Z){var ne=Z<=fe-1?z[0]:u,ce=ne&&gt(ne)==="object"?"url(#".concat(R,")"):void 0,Ce=cr(E,T,Q,se,D,c,d,ne,"butt",a,I);return Q+=(T-Ce.strokeDashoffset+I)*100/T,h.createElement("circle",{key:Z,className:"".concat(o,"-circle-path"),r:P,cx:C,cy:C,stroke:ce,strokeWidth:a,opacity:1,style:Ce,ref:function(he){oe[Z]=he}})})};return h.createElement("svg",Xe({className:ue("".concat(o,"-circle"),b),viewBox:"0 0 ".concat(gn," ").concat(gn),style:m,id:r,role:"presentation"},x),!$&&h.createElement("circle",{className:"".concat(o,"-circle-trail"),r:P,cx:C,cy:C,stroke:u,strokeLinecap:H,strokeWidth:s||a,style:q}),$?ae():L())};function Ot(t){return!t||t<0?0:t>100?100:t}function Kn({success:t,successPercent:e}){let n=e;return t&&"progress"in t&&(n=t.progress),t&&"percent"in t&&(n=t.percent),n}const zc=({percent:t,success:e,successPercent:n})=>{const r=Ot(Kn({success:e,successPercent:n}));return[r,Ot(Ot(t)-r)]},Lc=({success:t={},strokeColor:e})=>{const{strokeColor:n}=t;return[n||yr.green,e||null]},or=(t,e,n)=>{var r,o,i,a;let s=-1,l=-1;if(e==="step"){const c=n.steps,d=n.strokeWidth;typeof t=="string"||typeof t>"u"?(s=t==="small"?2:14,l=d??8):typeof t=="number"?[s,l]=[t,t]:[s=14,l=8]=Array.isArray(t)?t:[t.width,t.height],s*=c}else if(e==="line"){const c=n?.strokeWidth;typeof t=="string"||typeof t>"u"?l=c||(t==="small"?6:8):typeof t=="number"?[s,l]=[t,t]:[s=-1,l=8]=Array.isArray(t)?t:[t.width,t.height]}else(e==="circle"||e==="dashboard")&&(typeof t=="string"||typeof t>"u"?[s,l]=t==="small"?[60,60]:[120,120]:typeof t=="number"?[s,l]=[t,t]:Array.isArray(t)&&(s=(o=(r=t[0])!==null&&r!==void 0?r:t[1])!==null&&o!==void 0?o:120,l=(a=(i=t[0])!==null&&i!==void 0?i:t[1])!==null&&a!==void 0?a:120));return[s,l]},_c=3,Hc=t=>_c/t*100,Wc=t=>{const{prefixCls:e,trailColor:n=null,strokeLinecap:r="round",gapPosition:o,gapDegree:i,width:a=120,type:s,children:l,success:c,size:d=a,steps:u}=t,[f,m]=or(d,"circle");let{strokeWidth:b}=t;b===void 0&&(b=Math.max(Hc(f),6));const g={width:f,height:m,fontSize:f*.15+6},y=h.useMemo(()=>{if(i||i===0)return i;if(s==="dashboard")return 75},[i,s]),x=zc(t),C=o||s==="dashboard"&&"bottom"||void 0,S=Object.prototype.toString.call(t.strokeColor)==="[object Object]",R=Lc({success:c,strokeColor:t.strokeColor}),P=ue(`${e}-inner`,{[`${e}-circle-gradient`]:S}),E=h.createElement(Nc,{steps:u,percent:u?x[1]:x,strokeWidth:b,trailWidth:b,strokeColor:u?R[1]:R,strokeLinecap:r,trailColor:n,prefixCls:e,gapDegree:y,gapPosition:C}),D=f<=20,T=h.createElement("div",{className:P,style:g},E,!D&&l);return D?h.createElement(Ci,{title:l},T):T},Vn="--progress-line-stroke-color",Ji="--progress-percent",Mo=t=>{const e=t?"100%":"-100%";return new Fs(`antProgress${t?"RTL":"LTR"}Active`,{"0%":{transform:`translateX(${e}) scaleX(0)`,opacity:.1},"20%":{transform:`translateX(${e}) scaleX(0)`,opacity:.5},to:{transform:"translateX(0) scaleX(1)",opacity:0}})},Fc=t=>{const{componentCls:e,iconCls:n}=t;return{[e]:Object.assign(Object.assign({},sn(t)),{display:"inline-block","&-rtl":{direction:"rtl"},"&-line":{position:"relative",width:"100%",fontSize:t.fontSize},[`${e}-outer`]:{display:"inline-flex",alignItems:"center",width:"100%"},[`${e}-inner`]:{position:"relative",display:"inline-block",width:"100%",flex:1,overflow:"hidden",verticalAlign:"middle",backgroundColor:t.remainingColor,borderRadius:t.lineBorderRadius},[`${e}-inner:not(${e}-circle-gradient)`]:{[`${e}-circle-path`]:{stroke:t.defaultColor}},[`${e}-success-bg, ${e}-bg`]:{position:"relative",background:t.defaultColor,borderRadius:t.lineBorderRadius,transition:`all ${t.motionDurationSlow} ${t.motionEaseInOutCirc}`},[`${e}-layout-bottom`]:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",[`${e}-text`]:{width:"max-content",marginInlineStart:0,marginTop:t.marginXXS}},[`${e}-bg`]:{overflow:"hidden","&::after":{content:'""',background:{_multi_value_:!0,value:["inherit",`var(${Vn})`]},height:"100%",width:`calc(1 / var(${Ji}) * 100%)`,display:"block"},[`&${e}-bg-inner`]:{minWidth:"max-content","&::after":{content:"none"},[`${e}-text-inner`]:{color:t.colorWhite,[`&${e}-text-bright`]:{color:"rgba(0, 0, 0, 0.45)"}}}},[`${e}-success-bg`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,backgroundColor:t.colorSuccess},[`${e}-text`]:{display:"inline-block",marginInlineStart:t.marginXS,color:t.colorText,lineHeight:1,width:"2em",whiteSpace:"nowrap",textAlign:"start",verticalAlign:"middle",wordBreak:"normal",[n]:{fontSize:t.fontSize},[`&${e}-text-outer`]:{width:"max-content"},[`&${e}-text-outer${e}-text-start`]:{width:"max-content",marginInlineStart:0,marginInlineEnd:t.marginXS}},[`${e}-text-inner`]:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",marginInlineStart:0,padding:`0 ${G(t.paddingXXS)}`,[`&${e}-text-start`]:{justifyContent:"start"},[`&${e}-text-end`]:{justifyContent:"end"}},[`&${e}-status-active`]:{[`${e}-bg::before`]:{position:"absolute",inset:0,backgroundColor:t.colorBgContainer,borderRadius:t.lineBorderRadius,opacity:0,animationName:Mo(),animationDuration:t.progressActiveMotionDuration,animationTimingFunction:t.motionEaseOutQuint,animationIterationCount:"infinite",content:'""'}},[`&${e}-rtl${e}-status-active`]:{[`${e}-bg::before`]:{animationName:Mo(!0)}},[`&${e}-status-exception`]:{[`${e}-bg`]:{backgroundColor:t.colorError},[`${e}-text`]:{color:t.colorError}},[`&${e}-status-exception ${e}-inner:not(${e}-circle-gradient)`]:{[`${e}-circle-path`]:{stroke:t.colorError}},[`&${e}-status-success`]:{[`${e}-bg`]:{backgroundColor:t.colorSuccess},[`${e}-text`]:{color:t.colorSuccess}},[`&${e}-status-success ${e}-inner:not(${e}-circle-gradient)`]:{[`${e}-circle-path`]:{stroke:t.colorSuccess}}})}},Xc=t=>{const{componentCls:e,iconCls:n}=t;return{[e]:{[`${e}-circle-trail`]:{stroke:t.remainingColor},[`&${e}-circle ${e}-inner`]:{position:"relative",lineHeight:1,backgroundColor:"transparent"},[`&${e}-circle ${e}-text`]:{position:"absolute",insetBlockStart:"50%",insetInlineStart:0,width:"100%",margin:0,padding:0,color:t.circleTextColor,fontSize:t.circleTextFontSize,lineHeight:1,whiteSpace:"normal",textAlign:"center",transform:"translateY(-50%)",[n]:{fontSize:t.circleIconFontSize}},[`${e}-circle&-status-exception`]:{[`${e}-text`]:{color:t.colorError}},[`${e}-circle&-status-success`]:{[`${e}-text`]:{color:t.colorSuccess}}},[`${e}-inline-circle`]:{lineHeight:1,[`${e}-inner`]:{verticalAlign:"bottom"}}}},Yc=t=>{const{componentCls:e}=t;return{[e]:{[`${e}-steps`]:{display:"inline-block","&-outer":{display:"flex",flexDirection:"row",alignItems:"center"},"&-item":{flexShrink:0,minWidth:t.progressStepMinWidth,marginInlineEnd:t.progressStepMarginInlineEnd,backgroundColor:t.remainingColor,transition:`all ${t.motionDurationSlow}`,"&-active":{backgroundColor:t.defaultColor}}}}}},Gc=t=>{const{componentCls:e,iconCls:n}=t;return{[e]:{[`${e}-small&-line, ${e}-small&-line ${e}-text ${n}`]:{fontSize:t.fontSizeSM}}}},Kc=t=>({circleTextColor:t.colorText,defaultColor:t.colorInfo,remainingColor:t.colorFillSecondary,lineBorderRadius:100,circleTextFontSize:"1em",circleIconFontSize:`${t.fontSize/t.fontSizeSM}em`}),Vc=rn("Progress",t=>{const e=t.calc(t.marginXXS).div(2).equal(),n=on(t,{progressStepMarginInlineEnd:e,progressStepMinWidth:e,progressActiveMotionDuration:"2.4s"});return[Fc(n),Xc(n),Yc(n),Gc(n)]},Kc);var qc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Uc=t=>{let e=[];return Object.keys(t).forEach(n=>{const r=parseFloat(n.replace(/%/g,""));Number.isNaN(r)||e.push({key:r,value:t[n]})}),e=e.sort((n,r)=>n.key-r.key),e.map(({key:n,value:r})=>`${r} ${n}%`).join(", ")},Jc=(t,e)=>{const{from:n=yr.blue,to:r=yr.blue,direction:o=e==="rtl"?"to left":"to right"}=t,i=qc(t,["from","to","direction"]);if(Object.keys(i).length!==0){const s=Uc(i),l=`linear-gradient(${o}, ${s})`;return{background:l,[Vn]:l}}const a=`linear-gradient(${o}, ${n}, ${r})`;return{background:a,[Vn]:a}},Zc=t=>{const{prefixCls:e,direction:n,percent:r,size:o,strokeWidth:i,strokeColor:a,strokeLinecap:s="round",children:l,trailColor:c=null,percentPosition:d,success:u}=t,{align:f,type:m}=d,b=a&&typeof a!="string"?Jc(a,n):{[Vn]:a,background:a},g=s==="square"||s==="butt"?0:void 0,y=o??[-1,i||(o==="small"?6:8)],[x,C]=or(y,"line",{strokeWidth:i}),S={backgroundColor:c||void 0,borderRadius:g},R=Object.assign(Object.assign({width:`${Ot(r)}%`,height:C,borderRadius:g},b),{[Ji]:Ot(r)/100}),P=Kn(t),E={width:`${Ot(P)}%`,height:C,borderRadius:g,backgroundColor:u?.strokeColor},D={width:x<0?"100%":x},T=h.createElement("div",{className:`${e}-inner`,style:S},h.createElement("div",{className:ue(`${e}-bg`,`${e}-bg-${m}`),style:R},m==="inner"&&l),P!==void 0&&h.createElement("div",{className:`${e}-success-bg`,style:E})),A=m==="outer"&&f==="start",$=m==="outer"&&f==="end";return m==="outer"&&f==="center"?h.createElement("div",{className:`${e}-layout-bottom`},T,l):h.createElement("div",{className:`${e}-outer`,style:D},A&&l,T,$&&l)},Qc=t=>{const{size:e,steps:n,rounding:r=Math.round,percent:o=0,strokeWidth:i=8,strokeColor:a,trailColor:s=null,prefixCls:l,children:c}=t,d=r(n*(o/100)),f=e??[e==="small"?2:14,i],[m,b]=or(f,"step",{steps:n,strokeWidth:i}),g=m/n,y=Array.from({length:n});for(let x=0;x<n;x++){const C=Array.isArray(a)?a[x]:a;y[x]=h.createElement("div",{key:x,className:ue(`${l}-steps-item`,{[`${l}-steps-item-active`]:x<=d-1}),style:{backgroundColor:x<=d-1?C:s,width:g,height:b}})}return h.createElement("div",{className:`${l}-steps-outer`},y,c)};var eu=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const tu=["normal","exception","active","success"],Po=h.forwardRef((t,e)=>{const{prefixCls:n,className:r,rootClassName:o,steps:i,strokeColor:a,percent:s=0,size:l="default",showInfo:c=!0,type:d="line",status:u,format:f,style:m,percentPosition:b={}}=t,g=eu(t,["prefixCls","className","rootClassName","steps","strokeColor","percent","size","showInfo","type","status","format","style","percentPosition"]),{align:y="end",type:x="outer"}=b,C=Array.isArray(a)?a[0]:a,S=typeof a=="string"||Array.isArray(a)?a:void 0,R=h.useMemo(()=>{if(C){const L=typeof C=="string"?C:Object.values(C)[0];return new br(L).isLight()}return!1},[a]),P=h.useMemo(()=>{var L,ae;const be=Kn(t);return parseInt(be!==void 0?(L=be??0)===null||L===void 0?void 0:L.toString():(ae=s??0)===null||ae===void 0?void 0:ae.toString(),10)},[s,t.success,t.successPercent]),E=h.useMemo(()=>!tu.includes(u)&&P>=100?"success":u||"normal",[u,P]),{getPrefixCls:D,direction:T,progress:A}=h.useContext(Bt),$=D("progress",n),[I,O,z]=Vc($),N=d==="line",K=N&&!i,H=h.useMemo(()=>{if(!c)return null;const L=Kn(t);let ae;const be=f||(se=>`${se}%`),fe=N&&R&&x==="inner";return x==="inner"||f||E!=="exception"&&E!=="success"?ae=be(Ot(s),Ot(L)):E==="exception"?ae=N?h.createElement(Xs,null):h.createElement(yi,null):E==="success"&&(ae=N?h.createElement(Ys,null):h.createElement(Ei,null)),h.createElement("span",{className:ue(`${$}-text`,{[`${$}-text-bright`]:fe,[`${$}-text-${y}`]:K,[`${$}-text-${x}`]:K}),title:typeof ae=="string"?ae:void 0},ae)},[c,s,P,E,d,$,f]);let q;d==="line"?q=i?h.createElement(Qc,Object.assign({},t,{strokeColor:S,prefixCls:$,steps:typeof i=="object"?i.count:i}),H):h.createElement(Zc,Object.assign({},t,{strokeColor:C,prefixCls:$,direction:T,percentPosition:{align:y,type:x}}),H):(d==="circle"||d==="dashboard")&&(q=h.createElement(Wc,Object.assign({},t,{strokeColor:C,prefixCls:$,progressStatus:E}),H));const oe=ue($,`${$}-status-${E}`,{[`${$}-${d==="dashboard"&&"circle"||d}`]:d!=="line",[`${$}-inline-circle`]:d==="circle"&&or(l,"circle")[0]<=20,[`${$}-line`]:K,[`${$}-line-align-${y}`]:K,[`${$}-line-position-${x}`]:K,[`${$}-steps`]:i,[`${$}-show-info`]:c,[`${$}-${l}`]:typeof l=="string",[`${$}-rtl`]:T==="rtl"},A?.className,r,o,O,z);return I(h.createElement("div",Object.assign({ref:e,style:Object.assign(Object.assign({},A?.style),m),className:oe,role:"progressbar","aria-valuenow":P,"aria-valuemin":0,"aria-valuemax":100},tr(g,["trailColor","strokeWidth","width","gapDegree","gapPosition","strokeLinecap","success","successPercent"])),q))});var nu={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},ru=function(e,n){return h.createElement(Yt,Xe({},e,{ref:n,icon:nu}))},ou=h.forwardRef(ru),iu={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"},su=function(e,n){return h.createElement(Yt,Xe({},e,{ref:n,icon:iu}))},au=h.forwardRef(su),lu={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.3 506.3L781.7 405.6a7.23 7.23 0 00-11.7 5.7V476H548V254h64.8c6 0 9.4-7 5.7-11.7L517.7 114.7a7.14 7.14 0 00-11.3 0L405.6 242.3a7.23 7.23 0 005.7 11.7H476v222H254v-64.8c0-6-7-9.4-11.7-5.7L114.7 506.3a7.14 7.14 0 000 11.3l127.5 100.8c4.7 3.7 11.7.4 11.7-5.7V548h222v222h-64.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V548h222v64.8c0 6 7 9.4 11.7 5.7l127.5-100.8a7.3 7.3 0 00.1-11.4z"}}]},name:"drag",theme:"outlined"},cu=function(e,n){return h.createElement(Yt,Xe({},e,{ref:n,icon:lu}))},uu=h.forwardRef(cu),du={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M342 88H120c-17.7 0-32 14.3-32 32v224c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V168h174c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zm578 576h-48c-8.8 0-16 7.2-16 16v176H682c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h222c17.7 0 32-14.3 32-32V680c0-8.8-7.2-16-16-16zM342 856H168V680c0-8.8-7.2-16-16-16h-48c-8.8 0-16 7.2-16 16v224c0 17.7 14.3 32 32 32h222c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zM904 88H682c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h174v176c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V120c0-17.7-14.3-32-32-32z"}}]},name:"expand",theme:"outlined"},fu=function(e,n){return h.createElement(Yt,Xe({},e,{ref:n,icon:du}))},hu=h.forwardRef(fu),gu={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},pu=function(e,n){return h.createElement(Yt,Xe({},e,{ref:n,icon:gu}))},Zi=h.forwardRef(pu);function mu(t,e,n,r){const o=t&&typeof t=="object"?{...t}:{};return o[e]=o[e]&&typeof o[e]=="object"?{...o[e]}:{},o[e][n]=r,o.lastUpdated=new Date().toISOString(),o}const vu=({visible:t,jsonKey:e,displayLabel:n,entityData:r,onSave:o,onClose:i,settingsKey:a})=>{const[s]=ar.useForm(),[l,c]=h.useState(!1),[d]=h.useState(()=>Gs),u=async()=>{try{c(!0);const b=(await s.validateFields()).name.trim();!d.isSignedIn&&d.restoreSession&&(console.log("📚 SaveAsModal: Attempting to restore session..."),d.restoreSession());const g=d.isSignedIn&&d.accessToken;if(console.log("📚 SaveAsModal: Auth check:",{isSignedIn:d.isSignedIn,hasToken:!!d.accessToken,isAuthenticated:g}),!g){en.error("Not signed in to Google Drive. Please sign in first."),c(!1);return}const y=a||e,x=d.getSettings(),C=x[`${y}LibraryFile`]||"library.json",S=x[`${y}Folder`]||"/",R=S==="/"?`/${C}`:`${S}/${C}`;console.log(`📚 SaveAsModal (${e}): Saving "${b}" to: ${R}`,{settingsKey:y,fileName:C,folderPath:S});let P=null;const E=await d.findFile(C,S);if(E.found?(P=E.fileId,console.log("📚 SaveAsModal: Library file found:",P)):(console.log("📚 SaveAsModal: Library file not found, creating new file..."),P=(await d.createNewLibrary(C,S)).fileId,console.log("📚 SaveAsModal: New library file created:",P)),!P)throw new Error("Failed to find or create library file");let D;try{D=await d.loadLibraryById(P),console.log("📚 SaveAsModal: Loaded current library:",D)}catch(A){console.warn("📚 SaveAsModal: Could not load library, starting fresh:",A),D={}}const T=mu(D,e,b,r);console.log("📚 SaveAsModal: Merged library:",{[e]:Object.keys(T[e]||{})}),await d.saveLibraryToFile(P,T),console.log(`📚 SaveAsModal: Successfully saved ${n}: "${b}"`),en.success(`${n} "${b}" saved successfully`),await o(b,r),s.resetFields(),i()}catch(m){console.error("📚 SaveAsModal: Error saving:",m),en.error(m.message||`Failed to save ${n.toLowerCase()}`)}finally{c(!1)}},f=()=>{s.resetFields(),i()};return v.jsx(Ks,{open:t,title:`Save ${n} As`,onCancel:f,footer:[v.jsx(je,{onClick:f,disabled:l,children:"Cancel"},"cancel"),v.jsx(je,{type:"primary",icon:v.jsx(Zi,{}),loading:l,onClick:u,children:"Save"},"save")],width:500,children:v.jsx(ar,{form:s,layout:"vertical",style:{marginTop:24},children:v.jsx(ar.Item,{label:`${n} Name`,name:"name",rules:[{required:!0,message:`Please enter a ${n.toLowerCase()} name`},{min:1,message:"Name must be at least 1 character"},{max:100,message:"Name must be less than 100 characters"}],tooltip:`Choose a unique name for this ${n.toLowerCase()}`,children:v.jsx(Vs,{placeholder:`Enter ${n.toLowerCase()} name`,autoFocus:!0,autoComplete:"off",onPressEnter:()=>u()})})})})};class Ze{grid;colors;metadata;constructor(e=0,n=0,r=null,o={},i={},a="MC"){if(r)this.grid=r;else{this.grid=[];for(let s=0;s<n;s++)this.grid.push(new Array(e).fill(a))}this.colors=o,this.metadata=i}static fromJSON(e){return new Ze(0,0,e.grid||[],e.colors||{},e.metadata||{})}toJSON(){return{grid:this.grid,colors:this.colors,metadata:this.metadata}}setColor(e,n,r){this.colors[e]={id:e,color:n,label:r||e}}setStitch(e,n,r){e>=0&&e<this.grid.length&&n>=0&&n<this.grid[e].length&&(this.grid[e][n]=r)}getRowCount(){return this.grid.length}getStitchCount(){return this.grid.length>0?this.grid[0].length:0}getColorsUsed(){const e=new Set;return this.grid.forEach(n=>{n.forEach(r=>{r&&e.add(r)})}),Array.from(e).map(n=>this.colors[n]).filter(Boolean)}getRowInstructions(e){if(e<0||e>=this.grid.length)return[];const n=this.grid[e],r=[];let o=null,i=0;for(let a=0;a<n.length;a++){const s=n[a];s===o?i++:(o!==null&&r.push({colorId:o,color:this.colors[o],stitchCount:i}),o=s,i=1)}return o!==null&&r.push({colorId:o,color:this.colors[o],stitchCount:i}),r}resizeToFit(e,n,r="MC"){const o=this.getStitchCount(),i=this.getRowCount();if(o===0||i===0)return;const a=[];for(let s=0;s<n;s++){const l=[],c=Math.floor(s*i/n);for(let d=0;d<e;d++){const u=Math.floor(d*o/e);l.push(this.grid[c]?this.grid[c][u]:r)}a.push(l)}this.grid=a}extractSection(e,n,r=0,o=null){o=o||this.getRowCount();const i=[];for(let a=r;a<Math.min(o,this.getRowCount());a++){const s=[];for(let l=e;l<Math.min(n,this.getStitchCount());l++)s.push(this.grid[a]?this.grid[a][l]:"MC");i.push(s)}return new Ze(0,0,i,this.colors,{...this.metadata,isSection:!0,originalStitchRange:[e,n],originalRowRange:[r,o]})}}class _n{rows;colorworkMapping;constructor(){this.rows=[],this.colorworkMapping=null}addRow(e){this.rows.push(e)}setColorworkMapping(e,n){this.colorworkMapping={mappedRows:e,colorworkPattern:n}}generateKnittingInstructions(){return this.generateShapingInstructions()}generateColorworkInstructions(){return this.colorworkMapping?this.colorworkMapping.mappedRows.map((e,n)=>({row:n+1,machineRow:this.rows[n]?.rowNumber||n+1,colorwork:this.generateRowColorworkSequence(e.colorwork),stitchCount:e.totalStitches})):[]}generateRowColorworkSequence(e){const n=[];let r=null,o=0;for(const i of e)i===r?o++:(r!==null&&n.push({colorId:r,stitchCount:o}),r=i,o=1);return r!==null&&n.push({colorId:r,stitchCount:o}),n}hasColorwork(){return this.colorworkMapping!==null}generateShapingInstructions(){if(this.rows.length===0)return[];const e=[],n=this.rows[0].leftStitchesInWork,r=this.rows[0].rightStitchesInWork,o=this.rows[this.rows.length-1].leftStitchesInWork,i=this.rows[this.rows.length-1].rightStitchesInWork;if(n===o&&r===i)e.push(`Knit ${this.rows.length} rows (RC=${this.rows[this.rows.length-1].rowNumber}, ${this.rows[this.rows.length-1].leftStitchesInWork+this.rows[this.rows.length-1].rightStitchesInWork} sts in work).`);else{const a=this.rows[0];let s=1,l=a;for(const c of this.rows){const d=c.leftStitchesInWork-l.leftStitchesInWork,u=c.rightStitchesInWork-l.rightStitchesInWork;if(d===0&&u===0){s++;continue}else{let f="";d>0?f+=`Increase ${d} stitch${d>1?"es":""} on the left. `:d<0&&(f+=`Decrease ${-d} stitch${d<-1?"es":""} on the left. `),u>0?f+=`Increase ${u} stitch${u>1?"es":""} on the right. `:u<0&&(f+=`Decrease ${-u} stitch${u<-1?"es":""} on the right. `),l=c,f=s>1?`${f}Knit ${s} rows. `:`${f}Knit 1 row. `,f+=`(RC=${c.rowNumber}, ${c.leftStitchesInWork+c.rightStitchesInWork} sts in work)`,s=1,e.push(f)}}}return e}}_n.Row=class{constructor(t,e,n){this.rowNumber=t,this.leftStitchesInWork=e,this.rightStitchesInWork=n,this.colorwork=null}setColorwork(t,e){this.colorwork={colors:t,pattern:e}}getColorworkInstructions(){if(!this.colorwork)return null;const t=[];let e=null,n=0;for(const r of this.colorwork.colors)if(r===e)n++;else{if(e!==null){const o=this.colorwork.pattern.colors[e];t.push({colorId:e,colorLabel:o?.label||e,colorHex:o?.color||"#000000",stitchCount:n})}e=r,n=1}if(e!==null){const r=this.colorwork.pattern.colors[e];t.push({colorId:e,colorLabel:r?.label||e,colorHex:r?.color||"#000000",stitchCount:n})}return t}};class Xr{constructor(e,n,r=1){this.stitchesPerFourInches=e,this.rowsPerFourInches=n,this.scalingFactor=r}getStitchesPerInch(){return this.stitchesPerFourInches/4}getRowsPerInch(){return this.rowsPerFourInches/4}getEffectiveStitchesPerInch(){return this.getStitchesPerInch()/this.scalingFactor}getEffectiveRowsPerInch(){return this.getRowsPerInch()/this.scalingFactor}}const Qi=new Xr(19,30);class tt{height;baseA;baseB;baseBHorizontalOffset;successors;modificationScale;finishingSteps;label;constructor(e,n,r,o=0,i=[],a=[],s=1,l=null){this.height=e,this.baseA=n,this.baseB=r,this.baseBHorizontalOffset=o,this.successors=i,this.modificationScale=s,this.finishingSteps=a,this.label=l}setSizeModifier(e){this.modificationScale=e}getHeight(){return this.height*this.modificationScale}getLowerBase(){return this.baseA*this.modificationScale}getUpperBase(){return this.baseB*this.modificationScale}getOffset(){return this.baseBHorizontalOffset*this.modificationScale}static fromObject(e){if(!e||typeof e!="object"||Array.isArray(e)&&e.length===0)return null;const n=Array.isArray(e.successors)?e.successors.map(u=>tt.fromObject(u)).filter(u=>u!=null):[],r=typeof e.height=="number"?e.height:Number(e.height)||0,o=typeof e.baseA=="number"?e.baseA:Number(e.baseA)||0,i=typeof e.baseB=="number"?e.baseB:Number(e.baseB)||0,a=typeof e.baseBHorizontalOffset=="number"?e.baseBHorizontalOffset:Number(e.baseBHorizontalOffset)||0,s=Array.isArray(e.finishingSteps)?e.finishingSteps:e.finishingSteps?[e.finishingSteps]:[],l=typeof e.sizeModifier=="number"?e.sizeModifier:Number(e.sizeModifier)||1,c=typeof e.label=="string"?e.label:e.label==null?null:String(e.label),d=new tt(r,o,i,a,n,s,l,c);try{e.id?d.id=e.id:e._id?d.id=e._id:(tt._nextId||(tt._nextId=1),d.id=`trap-${tt._nextId++}`)}catch{d.id=e&&(e.id||e._id)?e.id||e._id:`trap-${Date.now()}`}return d.label=c===void 0?null:c,d.isHem=!!e.isHem,d.shortRows=Array.isArray(e.shortRows)?e.shortRows.map(u=>({...u})):[],d}toJSON(){return{height:this.height,baseA:this.baseA,baseB:this.baseB,baseBHorizontalOffset:this.baseBHorizontalOffset,successors:(this.successors||[]).map(e=>typeof e.toJSON=="function"?e.toJSON():e),finishingSteps:this.finishingSteps||[],sizeModifier:this.modificationScale||1,label:this.label||null,isHem:!!this.isHem,shortRows:Array.isArray(this.shortRows)?this.shortRows.map(e=>({...e})):[]}}getUpperBaseWidthInStitches(e=Qi){return Math.round(this.getUpperBase()*e.getStitchesPerInch())}getStitchPlan(e,n,r=1){const o=e.getStitchesPerInch()*n,i=e.getRowsPerInch()*n,a=Math.round(this.getLowerBase()*o),s=Math.floor(a/2),l=a%2===0?s:s+1,c=Math.round(this.getHeight()*i),d=this.getUpperBase()-this.getLowerBase(),u=d/2-this.getOffset(),f=d/2+this.getOffset(),m=Math.round(u*o),b=Math.round(f*o),g=Math.abs(m/c),y=Math.abs(b/c);let x=0,C=0;const S=new _n(e,n);let R=new _n.Row(r-1,s,l);for(let P=r;P<r+c;P++){let E=0,D=0;for(x+=g,C+=y;x>=1;)m>0?E+=1:E-=1,x-=1;for(;C>=1;)b>0?D+=1:D-=1,C-=1;const T=R.leftStitchesInWork+E,A=R.rightStitchesInWork+D,$=new _n.Row(P,T,A);S.addRow($),R=$}return S}generateKnittingInstructions(e,n,r=1,o=!1,i=null){const a=this.getStitchPlan(e,n,r),s=[];if(o&&a.rows.length>0&&s.push(`Cast on ${a.rows[0].leftStitchesInWork+a.rows[0].rightStitchesInWork} stitches.`),s.push(...a.generateKnittingInstructions(i)),s.push(...this.finishingSteps),this.successors.length>1){s.push(`Divide into ${this.successors.length} sections:`);for(let l=0;l<this.successors.length;l++){const c=this.successors[l],d=c.getUpperBaseWidthInStitches(e,n);if(c.getHeight()>0){s.push(`Section ${l+1}: ${d} stitches`);const u=c.generateKnittingInstructions(e,n,a.rows.length>0?a.rows[a.rows.length-1].rowNumber+1:r,!1,i?i.getChild(a.rows.length):null);s.push(...u)}else s.push(`Section ${l+1}: bind off ${c.getUpperBaseWidthInStitches(e,n)} stitches.`)}}else if(this.successors.length===1){const l=this.successors[0],c=l.getUpperBaseWidthInStitches(e,n);if(l.getHeight()>0){const d=l.generateKnittingInstructions(e,n,a.rows.length>0?a.rows[a.rows.length-1].rowNumber+1:r,!1,i?i.getChild(a.rows.length):null);s.push(...d)}else s.push(`Bind off ${c} stitches.`)}else a.rows.length>0&&s.push(`Bind off ${a.rows[a.rows.length-1].leftStitchesInWork+a.rows[a.rows.length-1].rightStitchesInWork} stitches.`);return s}}class tn{shape;gauge;sizeModifier;visualMotif;constructor(e,n=Qi,r=1.006,o=null){e instanceof tt||(e=tt.fromObject(e)||new tt(0,0,0,0,[],[],1,null)),this.shape=e,this.gauge=n,this.sizeModifier=r,this.visualMotif=o,this.shape&&typeof this.shape.setSizeModifier=="function"&&this.shape.setSizeModifier(r)}generateKnittingInstructions(){return this.shape?this.shape.generateKnittingInstructions(this.gauge,this.sizeModifier,1,!0,this.visualMotif):[]}static fromObject(e){const n=e&&(e.shapes||e.shape||e)||null,r=tt.fromObject(n)||new tt(0,0,0,0,[],[],1,null);return new tn(r,e?.gauge,e?.sizeModifier,e?.visualMotif)}toJSON(){return{shapes:this.shape&&typeof this.shape.toJSON=="function"?this.shape.toJSON():this.shape,gauge:this.gauge,sizeModifier:this.sizeModifier,visualMotif:this.visualMotif}}}class es{constructor(){this.defaultStretchMode="repeat",this.defaultAlignmentMode="center"}combinePatterns(e,n,r={}){const{stretchMode:o=this.defaultStretchMode,alignmentMode:i=this.defaultAlignmentMode}=r,a=this.generatePanelStitchPlan(e),s=this.mapColorworkToShape(a,n,{stretchMode:o,alignmentMode:i});return a.setColorworkMapping(s,n),s.forEach((l,c)=>{a.rows[c]&&a.rows[c].setColorwork(l.colorwork,n)}),new Yr(e,n,s,a)}generatePanelStitchPlan(e){if(!e.shape)return{rows:[]};const n=e.gauge,r=e.sizeModifier;return e.shape.getStitchPlan(n,r,1)}mapColorworkToShape(e,n,r={}){const{stretchMode:o,alignmentMode:i}=r,a=[];if(!e.rows||e.rows.length===0)return a;const s=n.getRowCount();for(let l=0;l<e.rows.length;l++){const c=e.rows[l],d=c.leftStitchesInWork+c.rightStitchesInWork,u=this.mapRowIndex(l,e.rows.length,s,o),f=this.mapRowStitches(n,u,d,c.leftStitchesInWork,{stretchMode:o,alignmentMode:i});a.push({panelRow:l+1,machineRow:c.rowNumber,leftStitches:c.leftStitchesInWork,rightStitches:c.rightStitchesInWork,totalStitches:d,colorwork:f,colorworkRowIndex:u})}return a}mapRowIndex(e,n,r,o){if(r===0)return 0;switch(o){case"stretch":return Math.floor(e*r/n);case"repeat":return e%r;case"center":{const i=Math.floor((n-r)/2);return e<i||e>=i+r?-1:e-i}default:return e%r}}mapRowStitches(e,n,r,o,i={}){const{stretchMode:a}=i;if(n<0||n>=e.getRowCount())return Array(r).fill("MC");const s=e.grid[n],l=s.length,c=[];for(let d=0;d<r;d++){let u;switch(a){case"stretch":u=Math.floor(d*l/r);break;case"repeat":u=d%l;break;case"center":{const m=Math.floor((r-l)/2);if(d<m||d>=m+l){c.push("MC");continue}u=d-m;break}default:u=d%l}const f=s[u]||"MC";c.push(f)}return c}handleShapingEdgeCases(e){return e}}class Yr{constructor(e,n,r,o){this.panel=e,this.colorworkPattern=n,this.mappedRows=r,this.stitchPlan=o,this.metadata={created:new Date().toISOString(),panelType:"shaped",hasColorwork:!0}}getRowCount(){return this.mappedRows.length}getRowColorwork(e){return e<0||e>=this.mappedRows.length?null:this.mappedRows[e]}getColorsUsed(){return this.colorworkPattern.getColorsUsed()}toJSON(){return{panel:{shape:this.panel.shape,gauge:this.panel.gauge,sizeModifier:this.panel.sizeModifier},colorworkPattern:this.colorworkPattern.toJSON(),mappedRows:this.mappedRows,metadata:this.metadata}}static fromJSON(e){const n=new tn(tt.fromJSON(e.panel.shape),new Xr(e.panel.gauge.stitchesPerFourInches,e.panel.gauge.rowsPerFourInches),e.panel.sizeModifier),r=Ze.fromJSON(e.colorworkPattern);return new Yr(n,r,e.mappedRows,e.stitchPlan)}}class bu{constructor(){this.cellSize=20,this.showGrid=!0,this.showRowNumbers=!0,this.showStitchNumbers=!1}generateChart(e,n={}){const{cellSize:r=this.cellSize,showGrid:o=this.showGrid,showRowNumbers:i=this.showRowNumbers,showStitchNumbers:a=this.showStitchNumbers,width:s=null,height:l=null}=n,c=e.getRowCount(),d=e.getStitchCount();if(c===0||d===0)return this.createEmptyChart();const u=s||d*r+(a?30:10),f=l||c*r+(i?30:10);return{svg:this.renderSVG(e,{cellSize:r,showGrid:o,showRowNumbers:i,showStitchNumbers:a}),dimensions:{width:u,height:f},cellSize:r,pattern:e}}generateRowInstructions(e){const n=[];for(let r=0;r<e.getRowCount();r++){const o=e.getRowInstructions(r);n.push({row:r+1,stitches:o,totalStitches:e.getStitchCount(),description:this.formatRowInstructions(o,r+1)})}return n}renderSVG(e,n={}){const{cellSize:r=this.cellSize,showGrid:o=this.showGrid,showRowNumbers:i=this.showRowNumbers,showStitchNumbers:a=this.showStitchNumbers}=n,s=e.getRowCount(),l=e.getStitchCount(),c=i?30:5,d=a?30:5,u=l*r+c+5,f=s*r+d+5,m=[];m.push(`<rect width="${u}" height="${f}" fill="white" stroke="none"/>`);for(let g=0;g<s;g++)for(let y=0;y<l;y++){const x=c+y*r,C=d+g*r,S=e.grid[g][y],R=e.colors[S],P=R?R.color:"#ffffff";m.push(`<rect x="${x}" y="${C}" width="${r}" height="${r}" fill="${P}" stroke="${o?"#cccccc":"none"}" stroke-width="0.5"/>`)}if(i)for(let g=0;g<s;g++){const y=d+g*r+r/2;m.push(`<text x="20" y="${y+4}" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">${s-g}</text>`)}if(a)for(let g=0;g<l;g++){const y=c+g*r+r/2;m.push(`<text x="${y}" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">${g+1}</text>`)}return`<svg width="${u}" height="${f}" xmlns="http://www.w3.org/2000/svg">
            ${m.join(`
`)}
        </svg>`}formatRowInstructions(e,n){if(e.length===0)return`Row ${n}: No stitches`;const r=e.map(o=>{const i=o.color?o.color.label:o.colorId;return`${o.stitchCount} ${i}`});return`Row ${n}: ${r.join(", ")}`}createEmptyChart(){return{svg:'<svg width="100" height="50" xmlns="http://www.w3.org/2000/svg"><text x="50" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#666">No Pattern</text></svg>',dimensions:{width:100,height:50},cellSize:this.cellSize,pattern:null}}generateLegend(e){return e.getColorsUsed().map(r=>({id:r.id,label:r.label,color:r.color,description:`${r.label} (${r.color})`}))}}class Io{constructor(e,n,r,o,i=null){this.row=e,this.machineRow=n,this.shaping=r,this.colorwork=o,this.visualChart=i}hasShaping(){return this.shaping&&(this.shaping.description.includes("Increase")||this.shaping.description.includes("Decrease"))}hasColorwork(){return this.colorwork&&this.colorwork.colorSequence&&this.colorwork.colorSequence.length>0}toString(){let e=`Row ${this.row}`;return this.machineRow&&this.machineRow!==this.row&&(e+=` (RC: ${this.machineRow})`),this.hasShaping()&&(e+=`: ${this.shaping.description}`),this.hasColorwork()&&(e+=` Colorwork: ${this.colorwork.description}`),e}}class ts{constructor(){this.colorworkVisualizer=new bu}generateInstructions(e,n="compact"){const r=this.generateCombinedInstructions(e);switch(n){case"compact":return this.formatCompactInstructions(r);case"detailed":return r;case"visual":return this.formatVisualInstructions(r);default:return r}}formatCompactInstructions(e){return e.filter(n=>n.hasShaping()||n.hasColorwork()||n.row%5===1).slice(0,10)}formatVisualInstructions(e){return e.filter(n=>n.visualChart).slice(0,5)}generateCombinedInstructions(e){const n=this.generateShapingInstructions(e.panel),r=this.generateColorworkInstructions(e);return this.synchronizeInstructions(n,r,e)}generateShapingInstructions(e){return e.generateKnittingInstructions()}generateColorworkInstructions(e){const n=[];for(const r of e.mappedRows){const o=this.generateRowColorworkInstructions(r);n.push({row:r.panelRow,machineRow:r.machineRow,colorwork:o,stitchCount:r.totalStitches})}return n}generateRowColorworkInstructions(e){const n=[];let r=null,o=0;for(const i of e.colorwork)i===r?o++:(r!==null&&n.push({colorId:r,stitchCount:o}),r=i,o=1);return r!==null&&n.push({colorId:r,stitchCount:o}),n}synchronizeInstructions(e,n,r){const o=[],i=r.colorworkPattern.colors,a=this.parseShapingInstructions(e);for(const s of n){const l=a[s.machineRow]||null,c=new Io(s.row,s.machineRow,l,{colorSequence:s.colorwork,totalStitches:s.stitchCount,description:this.formatColorworkDescription(s.colorwork,i)},this.generateRowVisualChart(r,s.row-1));o.push(c)}return this.addRemainingShapingInstructions(o,e,a),o}parseShapingInstructions(e){const n={};return e.forEach((r,o)=>{if(typeof r=="string"){const i=r.match(/(?:Row|RC[=:]?)\s*(\d+)/i);if(i){const a=parseInt(i[1]);n[a]={type:"text",description:r,index:o}}else n[`general_${o}`]={type:"general",description:r,index:o}}}),n}formatColorworkDescription(e,n){return e.length===0?"No colorwork":e.map(o=>{const i=n[o.colorId],a=i?i.label:o.colorId;return`${o.stitchCount} ${a}`}).join(", ")}generateRowVisualChart(e,n){if(n<0||n>=e.mappedRows.length)return null;const r=e.mappedRows[n],o={grid:[r.colorwork],colors:e.colorworkPattern.colors,getRowCount:()=>1,getStitchCount:()=>r.colorwork.length};return this.colorworkVisualizer.generateChart(o,{cellSize:15,showRowNumbers:!1,showStitchNumbers:!1,showGrid:!0})}addRemainingShapingInstructions(e,n){n.forEach((r,o)=>{if(typeof r=="string"&&(r.toLowerCase().includes("cast on")||r.toLowerCase().includes("bind off")||r.toLowerCase().includes("hang hem")||!r.match(/(?:Row|RC[=:]?)\s*(\d+)/i))){const a=new Io(null,null,{type:"general",description:r,index:o},null,null);r.toLowerCase().includes("cast on")?e.unshift(a):e.push(a)}})}}var ur={},un={},jo;function ns(){if(jo)return un;jo=1,Object.defineProperty(un,"__esModule",{value:!0}),un.bind=void 0;function t(e,n){var r=n.type,o=n.listener,i=n.options;return e.addEventListener(r,o,i),function(){e.removeEventListener(r,o,i)}}return un.bind=t,un}var Lt={},Oo;function yu(){if(Oo)return Lt;Oo=1;var t=Lt&&Lt.__assign||function(){return t=Object.assign||function(i){for(var a,s=1,l=arguments.length;s<l;s++){a=arguments[s];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(i[c]=a[c])}return i},t.apply(this,arguments)};Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.bindAll=void 0;var e=ns();function n(i){if(!(typeof i>"u"))return typeof i=="boolean"?{capture:i}:i}function r(i,a){if(a==null)return i;var s=t(t({},i),{options:t(t({},n(a)),n(i.options))});return s}function o(i,a,s){var l=a.map(function(c){var d=r(c,s);return(0,e.bind)(i,d)});return function(){l.forEach(function(d){return d()})}}return Lt.bindAll=o,Lt}var To;function Cu(){return To||(To=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.bindAll=t.bind=void 0;var e=ns();Object.defineProperty(t,"bind",{enumerable:!0,get:function(){return e.bind}});var n=yu();Object.defineProperty(t,"bindAll",{enumerable:!0,get:function(){return n.bindAll}})})(ur)),ur}var nn=Cu(),rs="data-pdnd-honey-pot";function os(t){return t instanceof Element&&t.hasAttribute(rs)}function is(t){var e=document.elementsFromPoint(t.x,t.y),n=ge(e,2),r=n[0],o=n[1];return r?os(r)?o??null:r:null}var xu=2147483647;function ko(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Ao(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ko(Object(n),!0).forEach(function(r){Me(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ko(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var vn=2,Bo=vn/2;function Su(t){return{x:Math.floor(t.x),y:Math.floor(t.y)}}function wu(t){return{x:t.x-Bo,y:t.y-Bo}}function $u(t){return{x:Math.max(t.x,0),y:Math.max(t.y,0)}}function Ru(t){return{x:Math.min(t.x,window.innerWidth-vn),y:Math.min(t.y,window.innerHeight-vn)}}function Do(t){var e=t.client,n=Ru($u(wu(Su(e))));return DOMRect.fromRect({x:n.x,y:n.y,width:vn,height:vn})}function No(t){var e=t.clientRect;return{left:"".concat(e.left,"px"),top:"".concat(e.top,"px"),width:"".concat(e.width,"px"),height:"".concat(e.height,"px")}}function Eu(t){var e=t.client,n=t.clientRect;return e.x>=n.x&&e.x<=n.x+n.width&&e.y>=n.y&&e.y<=n.y+n.height}function Mu(t){var e=t.initial,n=document.createElement("div");n.setAttribute(rs,"true");var r=Do({client:e});Object.assign(n.style,Ao(Ao({backgroundColor:"transparent",position:"fixed",padding:0,margin:0,boxSizing:"border-box"},No({clientRect:r})),{},{pointerEvents:"auto",zIndex:xu})),document.body.appendChild(n);var o=nn.bind(window,{type:"pointermove",listener:function(a){var s={x:a.clientX,y:a.clientY};r=Do({client:s}),Object.assign(n.style,No({clientRect:r}))},options:{capture:!0}});return function(a){var s=a.current;if(o(),Eu({client:s,clientRect:r})){n.remove();return}function l(){c(),n.remove()}var c=nn.bindAll(window,[{type:"pointerdown",listener:l},{type:"pointermove",listener:l},{type:"focusin",listener:l},{type:"focusout",listener:l},{type:"dragstart",listener:l},{type:"dragenter",listener:l},{type:"dragover",listener:l}],{capture:!0})}}function Pu(){var t=null;function e(){return t=null,nn.bind(window,{type:"pointermove",listener:function(o){t={x:o.clientX,y:o.clientY}},options:{capture:!0}})}function n(){var r=null;return function(i){var a=i.eventName,s=i.payload;if(a==="onDragStart"){var l=s.location.initial.input,c=t??{x:l.clientX,y:l.clientY};r=Mu({initial:c})}if(a==="onDrop"){var d,u=s.location.current.input;(d=r)===null||d===void 0||d({current:{x:u.clientX,y:u.clientY}}),r=null,t=null}}}return{bindEvents:e,getOnPostDispatch:n}}function an(t){var e=null;return function(){if(!e){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];var a=t.apply(this,o);e={result:a}}return e.result}}var Iu=an(function(){return navigator.userAgent.includes("Firefox")}),Gr=an(function(){var e=navigator,n=e.userAgent;return n.includes("AppleWebKit")&&!n.includes("Chrome")}),Rr={isLeavingWindow:Symbol("leaving"),isEnteringWindow:Symbol("entering")};function ju(t){var e=t.dragLeave;return Gr()?e.hasOwnProperty(Rr.isLeavingWindow):!1}(function(){if(typeof window>"u"||!Gr())return;function e(){return{enterCount:0,isOverWindow:!1}}var n=e();function r(){n=e()}nn.bindAll(window,[{type:"dragstart",listener:function(){n.enterCount=0,n.isOverWindow=!0}},{type:"drop",listener:r},{type:"dragend",listener:r},{type:"dragenter",listener:function(i){!n.isOverWindow&&n.enterCount===0&&(i[Rr.isEnteringWindow]=!0),n.isOverWindow=!0,n.enterCount++}},{type:"dragleave",listener:function(i){n.enterCount--,n.isOverWindow&&n.enterCount===0&&(i[Rr.isLeavingWindow]=!0,n.isOverWindow=!1)}}],{capture:!0})})();function Ou(t){return"nodeName"in t}function Tu(t){return Ou(t)&&t.ownerDocument!==document}function ku(t){var e=t.dragLeave,n=e.type,r=e.relatedTarget;return n!=="dragleave"?!1:Gr()?ju({dragLeave:e}):r==null?!0:Iu()?Tu(r):r instanceof HTMLIFrameElement}function Au(t){var e=t.onDragEnd;return[{type:"pointermove",listener:(function(){var n=0;return function(){if(n<20){n++;return}e()}})()},{type:"pointerdown",listener:e}]}function pn(t){return{altKey:t.altKey,button:t.button,buttons:t.buttons,ctrlKey:t.ctrlKey,metaKey:t.metaKey,shiftKey:t.shiftKey,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY}}var Bu=function(e){var n=[],r=null,o=function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];n=s,!r&&(r=requestAnimationFrame(function(){r=null,e.apply(void 0,n)}))};return o.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},o},dr=Bu(function(t){return t()}),Nn=(function(){var t=null;function e(r){var o=requestAnimationFrame(function(){t=null,r()});t={frameId:o,fn:r}}function n(){t&&(cancelAnimationFrame(t.frameId),t.fn(),t=null)}return{schedule:e,flush:n}})();function Du(t){var e=t.source,n=t.initial,r=t.dispatchEvent,o={dropTargets:[]};function i(s){r(s),o={dropTargets:s.payload.location.current.dropTargets}}var a={start:function(l){var c=l.nativeSetDragImage,d={current:n,previous:o,initial:n};i({eventName:"onGenerateDragPreview",payload:{source:e,location:d,nativeSetDragImage:c}}),Nn.schedule(function(){i({eventName:"onDragStart",payload:{source:e,location:d}})})},dragUpdate:function(l){var c=l.current;Nn.flush(),dr.cancel(),i({eventName:"onDropTargetChange",payload:{source:e,location:{initial:n,previous:o,current:c}}})},drag:function(l){var c=l.current;dr(function(){Nn.flush();var d={initial:n,previous:o,current:c};i({eventName:"onDrag",payload:{source:e,location:d}})})},drop:function(l){var c=l.current,d=l.updatedSourcePayload;Nn.flush(),dr.cancel(),i({eventName:"onDrop",payload:{source:d??e,location:{current:c,previous:o,initial:n}}})}};return a}var Er={isActive:!1};function ss(){return!Er.isActive}function Nu(t){return t.dataTransfer?t.dataTransfer.setDragImage.bind(t.dataTransfer):null}function zu(t){var e=t.current,n=t.next;if(e.length!==n.length)return!0;for(var r=0;r<e.length;r++)if(e[r].element!==n[r].element)return!0;return!1}function Lu(t){var e=t.event,n=t.dragType,r=t.getDropTargetsOver,o=t.dispatchEvent;if(!ss())return;var i=_u({event:e,dragType:n,getDropTargetsOver:r});Er.isActive=!0;var a={current:i};fr({event:e,current:i.dropTargets});var s=Du({source:n.payload,dispatchEvent:o,initial:i});function l(m){var b=zu({current:a.current.dropTargets,next:m.dropTargets});a.current=m,b&&s.dragUpdate({current:a.current})}function c(m){var b=pn(m),g=os(m.target)?is({x:b.clientX,y:b.clientY}):m.target,y=r({target:g,input:b,source:n.payload,current:a.current.dropTargets});y.length&&(m.preventDefault(),fr({event:m,current:y})),l({dropTargets:y,input:b})}function d(){a.current.dropTargets.length&&l({dropTargets:[],input:a.current.input}),s.drop({current:a.current,updatedSourcePayload:null}),u()}function u(){Er.isActive=!1,f()}var f=nn.bindAll(window,[{type:"dragover",listener:function(b){c(b),s.drag({current:a.current})}},{type:"dragenter",listener:c},{type:"dragleave",listener:function(b){ku({dragLeave:b})&&(l({input:a.current.input,dropTargets:[]}),n.startedFrom==="external"&&d())}},{type:"drop",listener:function(b){if(a.current={dropTargets:a.current.dropTargets,input:pn(b)},!a.current.dropTargets.length){d();return}b.preventDefault(),fr({event:b,current:a.current.dropTargets}),s.drop({current:a.current,updatedSourcePayload:n.type==="external"?n.getDropPayload(b):null}),u()}},{type:"dragend",listener:function(b){a.current={dropTargets:a.current.dropTargets,input:pn(b)},d()}}].concat(Ue(Au({onDragEnd:d}))),{capture:!0});s.start({nativeSetDragImage:Nu(e)})}function fr(t){var e,n=t.event,r=t.current,o=(e=r[0])===null||e===void 0?void 0:e.dropEffect;o!=null&&n.dataTransfer&&(n.dataTransfer.dropEffect=o)}function _u(t){var e=t.event,n=t.dragType,r=t.getDropTargetsOver,o=pn(e);if(n.startedFrom==="external")return{input:o,dropTargets:[]};var i=r({input:o,source:n.payload,target:e.target,current:[]});return{input:o,dropTargets:i}}var zo={canStart:ss,start:Lu},Mr=new Map;function Hu(t){var e=t.typeKey,n=t.mount,r=Mr.get(e);if(r)return r.usageCount++,r;var o={typeKey:e,unmount:n(),usageCount:1};return Mr.set(e,o),o}function Wu(t){var e=Hu(t);return function(){e.usageCount--,!(e.usageCount>0)&&(e.unmount(),Mr.delete(t.typeKey))}}function Kr(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(){e.forEach(function(o){return o()})}}function as(t,e){var n=e.attribute,r=e.value;return t.setAttribute(n,r),function(){return t.removeAttribute(n)}}function Lo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Pt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Lo(Object(n),!0).forEach(function(r){Me(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lo(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function hr(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Fu(t))||e){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(c){throw c},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var c=n.next();return a=c.done,c},e:function(c){s=!0,i=c},f:function(){try{a||n.return==null||n.return()}finally{if(s)throw i}}}}function Fu(t,e){if(t){if(typeof t=="string")return _o(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_o(t,e):void 0}}function _o(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function gr(t){return t.slice(0).reverse()}function Xu(t){var e=t.typeKey,n=t.defaultDropEffect,r=new WeakMap,o="data-drop-target-for-".concat(e),i="[".concat(o,"]");function a(m){return r.set(m.element,m),function(){return r.delete(m.element)}}function s(m){var b=Kr(as(m.element,{attribute:o,value:"true"}),a(m));return an(b)}function l(m){var b,g,y,x,C=m.source,S=m.target,R=m.input,P=m.result,E=P===void 0?[]:P;if(S==null)return E;if(!(S instanceof Element))return S instanceof Node?l({source:C,target:S.parentElement,input:R,result:E}):E;var D=S.closest(i);if(D==null)return E;var T=r.get(D);if(T==null)return E;var A={input:R,source:C,element:T.element};if(T.canDrop&&!T.canDrop(A))return l({source:C,target:T.element.parentElement,input:R,result:E});var $=(b=(g=T.getData)===null||g===void 0?void 0:g.call(T,A))!==null&&b!==void 0?b:{},I=(y=(x=T.getDropEffect)===null||x===void 0?void 0:x.call(T,A))!==null&&y!==void 0?y:n,O={data:$,element:T.element,dropEffect:I,isActiveDueToStickiness:!1};return l({source:C,target:T.element.parentElement,input:R,result:[].concat(Ue(E),[O])})}function c(m){var b=m.eventName,g=m.payload,y=hr(g.location.current.dropTargets),x;try{for(y.s();!(x=y.n()).done;){var C,S=x.value,R=r.get(S.element),P=Pt(Pt({},g),{},{self:S});R==null||(C=R[b])===null||C===void 0||C.call(R,P)}}catch(E){y.e(E)}finally{y.f()}}var d={onGenerateDragPreview:c,onDrag:c,onDragStart:c,onDrop:c,onDropTargetChange:function(b){var g=b.payload,y=new Set(g.location.current.dropTargets.map(function(q){return q.element})),x=new Set,C=hr(g.location.previous.dropTargets),S;try{for(C.s();!(S=C.n()).done;){var R,P=S.value;x.add(P.element);var E=r.get(P.element),D=y.has(P.element),T=Pt(Pt({},g),{},{self:P});if(E==null||(R=E.onDropTargetChange)===null||R===void 0||R.call(E,T),!D){var A;E==null||(A=E.onDragLeave)===null||A===void 0||A.call(E,T)}}}catch(q){C.e(q)}finally{C.f()}var $=hr(g.location.current.dropTargets),I;try{for($.s();!(I=$.n()).done;){var O,z,N=I.value;if(!x.has(N.element)){var K=Pt(Pt({},g),{},{self:N}),H=r.get(N.element);H==null||(O=H.onDropTargetChange)===null||O===void 0||O.call(H,K),H==null||(z=H.onDragEnter)===null||z===void 0||z.call(H,K)}}}catch(q){$.e(q)}finally{$.f()}}};function u(m){d[m.eventName](m)}function f(m){var b=m.source,g=m.target,y=m.input,x=m.current,C=l({source:b,target:g,input:y});if(C.length>=x.length)return C;for(var S=gr(x),R=gr(C),P=[],E=0;E<S.length;E++){var D,T=S[E],A=R[E];if(A!=null){P.push(A);continue}var $=P[E-1],I=S[E-1];if($?.element!==I?.element)break;var O=r.get(T.element);if(!O)break;var z={input:y,source:b,element:O.element};if(O.canDrop&&!O.canDrop(z)||!((D=O.getIsSticky)!==null&&D!==void 0&&D.call(O,z)))break;P.push(Pt(Pt({},T),{},{isActiveDueToStickiness:!0}))}return gr(P)}return{dropTargetForConsumers:s,getIsOver:f,dispatchEvent:u}}function Yu(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Gu(t))||e){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(c){throw c},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var c=n.next();return a=c.done,c},e:function(c){s=!0,i=c},f:function(){try{a||n.return==null||n.return()}finally{if(s)throw i}}}}function Gu(t,e){if(t){if(typeof t=="string")return Ho(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ho(t,e):void 0}}function Ho(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Wo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Ku(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Wo(Object(n),!0).forEach(function(r){Me(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wo(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Vu(){var t=new Set,e=null;function n(i){e&&(!i.canMonitor||i.canMonitor(e.canMonitorArgs))&&e.active.add(i)}function r(i){var a=Ku({},i);t.add(a),n(a);function s(){t.delete(a),e&&e.active.delete(a)}return an(s)}function o(i){var a=i.eventName,s=i.payload;if(a==="onGenerateDragPreview"){e={canMonitorArgs:{initial:s.location.initial,source:s.source},active:new Set};var l=Yu(t),c;try{for(l.s();!(c=l.n()).done;){var d=c.value;n(d)}}catch(y){l.e(y)}finally{l.f()}}if(e){for(var u=Array.from(e.active),f=0,m=u;f<m.length;f++){var b=m[f];if(e.active.has(b)){var g;(g=b[a])===null||g===void 0||g.call(b,s)}}a==="onDrop"&&(e.active.clear(),e=null)}}return{dispatchEvent:o,monitorForConsumers:r}}function qu(t){var e=t.typeKey,n=t.mount,r=t.dispatchEventToSource,o=t.onPostDispatch,i=t.defaultDropEffect,a=Vu(),s=Xu({typeKey:e,defaultDropEffect:i});function l(u){r?.(u),s.dispatchEvent(u),a.dispatchEvent(u),o?.(u)}function c(u){var f=u.event,m=u.dragType;zo.start({event:f,dragType:m,getDropTargetsOver:s.getIsOver,dispatchEvent:l})}function d(){function u(){var f={canStart:zo.canStart,start:c};return n(f)}return Wu({typeKey:e,mount:u})}return{registerUsage:d,dropTarget:s.dropTargetForConsumers,monitor:a.monitorForConsumers}}var Uu=an(function(){return navigator.userAgent.toLocaleLowerCase().includes("android")}),Ju="pdnd:android-fallback",Fo="text/plain",Zu="text/uri-list",Qu="application/vnd.pdnd",qn=new WeakMap;function ed(t){return qn.set(t.element,t),function(){qn.delete(t.element)}}var Xo=Pu(),ls=qu({typeKey:"element",defaultDropEffect:"move",mount:function(e){return Kr(Xo.bindEvents(),nn.bind(document,{type:"dragstart",listener:function(r){var o,i,a,s,l,c;if(e.canStart(r)&&!r.defaultPrevented&&r.dataTransfer){var d=r.target;if(!(d instanceof HTMLElement))return null;var u=qn.get(d);if(!u)return null;var f=pn(r),m={element:u.element,dragHandle:(o=u.dragHandle)!==null&&o!==void 0?o:null,input:f};if(u.canDrag&&!u.canDrag(m))return r.preventDefault(),null;if(u.dragHandle){var b=is({x:f.clientX,y:f.clientY});if(!u.dragHandle.contains(b))return r.preventDefault(),null}var g=(i=(a=u.getInitialDataForExternal)===null||a===void 0?void 0:a.call(u,m))!==null&&i!==void 0?i:null;if(g)for(var y=0,x=Object.entries(g);y<x.length;y++){var C=ge(x[y],2),S=C[0],R=C[1];r.dataTransfer.setData(S,R??"")}Uu()&&!r.dataTransfer.types.includes(Fo)&&!r.dataTransfer.types.includes(Zu)&&r.dataTransfer.setData(Fo,Ju),r.dataTransfer.setData(Qu,"");var P={element:u.element,dragHandle:(s=u.dragHandle)!==null&&s!==void 0?s:null,data:(l=(c=u.getInitialData)===null||c===void 0?void 0:c.call(u,m))!==null&&l!==void 0?l:{}},E={type:"element",payload:P,startedFrom:"internal"};e.start({event:r,dragType:E})}}}))},dispatchEventToSource:function(e){var n,r,o=e.eventName,i=e.payload;(n=qn.get(i.source.element))===null||n===void 0||(r=n[o])===null||r===void 0||r.call(n,i)},onPostDispatch:Xo.getOnPostDispatch()}),td=ls.dropTarget;function nd(t){var e=Kr(ls.registerUsage(),ed(t),as(t.element,{attribute:"draggable",value:"true"}));return an(e)}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function rd(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(d){return l([c,d])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=c[0]&2?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,o=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(d){c=[6,d],o=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var At=(function(){function t(e,n){this.next=null,this.key=e,this.data=n,this.left=null,this.right=null}return t})();function od(t,e){return t>e?1:t<e?-1:0}function It(t,e,n){for(var r=new At(null,null),o=r,i=r;;){var a=n(t,e.key);if(a<0){if(e.left===null)break;if(n(t,e.left.key)<0){var s=e.left;if(e.left=s.right,s.right=e,e=s,e.left===null)break}i.left=e,i=e,e=e.left}else if(a>0){if(e.right===null)break;if(n(t,e.right.key)>0){var s=e.right;if(e.right=s.left,s.left=e,e=s,e.right===null)break}o.right=e,o=e,e=e.right}else break}return o.right=e.left,i.left=e.right,e.left=r.right,e.right=r.left,e}function pr(t,e,n,r){var o=new At(t,e);if(n===null)return o.left=o.right=null,o;n=It(t,n,r);var i=r(t,n.key);return i<0?(o.left=n.left,o.right=n,n.left=null):i>=0&&(o.right=n.right,o.left=n,n.right=null),o}function Yo(t,e,n){var r=null,o=null;if(e){e=It(t,e,n);var i=n(e.key,t);i===0?(r=e.left,o=e.right):i<0?(o=e.right,e.right=null,r=e):(r=e.left,e.left=null,o=e)}return{left:r,right:o}}function id(t,e,n){return e===null?t:(t===null||(e=It(t.key,e,n),e.left=t),e)}function Pr(t,e,n,r,o){if(t){r(""+e+(n?"└── ":"├── ")+o(t)+`
`);var i=e+(n?"    ":"│   ");t.left&&Pr(t.left,i,!1,r,o),t.right&&Pr(t.right,i,!0,r,o)}}var Vr=(function(){function t(e){e===void 0&&(e=od),this._root=null,this._size=0,this._comparator=e}return t.prototype.insert=function(e,n){return this._size++,this._root=pr(e,n,this._root,this._comparator)},t.prototype.add=function(e,n){var r=new At(e,n);this._root===null&&(r.left=r.right=null,this._size++,this._root=r);var o=this._comparator,i=It(e,this._root,o),a=o(e,i.key);return a===0?this._root=i:(a<0?(r.left=i.left,r.right=i,i.left=null):a>0&&(r.right=i.right,r.left=i,i.right=null),this._size++,this._root=r),this._root},t.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},t.prototype._remove=function(e,n,r){var o;if(n===null)return null;n=It(e,n,r);var i=r(e,n.key);return i===0?(n.left===null?o=n.right:(o=It(e,n.left,r),o.right=n.right),this._size--,o):n},t.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=It(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},t.prototype.findStatic=function(e){for(var n=this._root,r=this._comparator;n;){var o=r(e,n.key);if(o===0)return n;o<0?n=n.left:n=n.right}return null},t.prototype.find=function(e){return this._root&&(this._root=It(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},t.prototype.contains=function(e){for(var n=this._root,r=this._comparator;n;){var o=r(e,n.key);if(o===0)return!0;o<0?n=n.left:n=n.right}return!1},t.prototype.forEach=function(e,n){for(var r=this._root,o=[],i=!1;!i;)r!==null?(o.push(r),r=r.left):o.length!==0?(r=o.pop(),e.call(n,r),r=r.right):i=!0;return this},t.prototype.range=function(e,n,r,o){for(var i=[],a=this._comparator,s=this._root,l;i.length!==0||s;)if(s)i.push(s),s=s.left;else{if(s=i.pop(),l=a(s.key,n),l>0)break;if(a(s.key,e)>=0&&r.call(o,s))return this;s=s.right}return this},t.prototype.keys=function(){var e=[];return this.forEach(function(n){var r=n.key;return e.push(r)}),e},t.prototype.values=function(){var e=[];return this.forEach(function(n){var r=n.data;return e.push(r)}),e},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},t.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},t.prototype.at=function(e){for(var n=this._root,r=!1,o=0,i=[];!r;)if(n)i.push(n),n=n.left;else if(i.length>0){if(n=i.pop(),o===e)return n;o++,n=n.right}else r=!0;return null},t.prototype.next=function(e){var n=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var o=this._comparator;n;){var i=o(e.key,n.key);if(i===0)break;i<0?(r=n,n=n.left):n=n.right}return r},t.prototype.prev=function(e){var n=this._root,r=null;if(e.left!==null){for(r=e.left;r.right;)r=r.right;return r}for(var o=this._comparator;n;){var i=o(e.key,n.key);if(i===0)break;i<0?n=n.left:(r=n,n=n.right)}return r},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return ad(this._root)},t.prototype.load=function(e,n,r){n===void 0&&(n=[]),r===void 0&&(r=!1);var o=e.length,i=this._comparator;if(r&&Or(e,n,0,o-1,i),this._root===null)this._root=Ir(e,n,0,o),this._size=o;else{var a=ld(this.toList(),sd(e,n),i);o=this._size+o,this._root=jr({head:a},0,o)}return this},t.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){e===void 0&&(e=function(r){return String(r.key)});var n=[];return Pr(this._root,"",!0,function(r){return n.push(r)},e),n.join("")},t.prototype.update=function(e,n,r){var o=this._comparator,i=Yo(e,this._root,o),a=i.left,s=i.right;o(e,n)<0?s=pr(n,r,s,o):a=pr(n,r,a,o),this._root=id(a,s,o)},t.prototype.split=function(e){return Yo(e,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var e,n,r;return rd(this,function(o){switch(o.label){case 0:e=this._root,n=[],r=!1,o.label=1;case 1:return r?[3,6]:e===null?[3,2]:(n.push(e),e=e.left,[3,5]);case 2:return n.length===0?[3,4]:(e=n.pop(),[4,e]);case 3:return o.sent(),e=e.right,[3,5];case 4:r=!0,o.label=5;case 5:return[3,1];case 6:return[2]}})},t})();function Ir(t,e,n,r){var o=r-n;if(o>0){var i=n+Math.floor(o/2),a=t[i],s=e[i],l=new At(a,s);return l.left=Ir(t,e,n,i),l.right=Ir(t,e,i+1,r),l}return null}function sd(t,e){for(var n=new At(null,null),r=n,o=0;o<t.length;o++)r=r.next=new At(t[o],e[o]);return r.next=null,n.next}function ad(t){for(var e=t,n=[],r=!1,o=new At(null,null),i=o;!r;)e?(n.push(e),e=e.left):n.length>0?(e=i=i.next=n.pop(),e=e.right):r=!0;return i.next=null,o.next}function jr(t,e,n){var r=n-e;if(r>0){var o=e+Math.floor(r/2),i=jr(t,e,o),a=t.head;return a.left=i,t.head=t.head.next,a.right=jr(t,o+1,n),a}return null}function ld(t,e,n){for(var r=new At(null,null),o=r,i=t,a=e;i!==null&&a!==null;)n(i.key,a.key)<0?(o.next=i,i=i.next):(o.next=a,a=a.next),o=o.next;return i!==null?o.next=i:a!==null&&(o.next=a),r.next}function Or(t,e,n,r,o){if(!(n>=r)){for(var i=t[n+r>>1],a=n-1,s=r+1;;){do a++;while(o(t[a],i)<0);do s--;while(o(t[s],i)>0);if(a>=s)break;var l=t[a];t[a]=t[s],t[s]=l,l=e[a],e[a]=e[s],e[s]=l}Or(t,e,n,s,o),Or(t,e,s+1,r,o)}}const $t=11102230246251565e-32,rt=134217729,cd=(3+8*$t)*$t;function mr(t,e,n,r,o){let i,a,s,l,c=e[0],d=r[0],u=0,f=0;d>c==d>-c?(i=c,c=e[++u]):(i=d,d=r[++f]);let m=0;if(u<t&&f<n)for(d>c==d>-c?(a=c+i,s=i-(a-c),c=e[++u]):(a=d+i,s=i-(a-d),d=r[++f]),i=a,s!==0&&(o[m++]=s);u<t&&f<n;)d>c==d>-c?(a=i+c,l=a-i,s=i-(a-l)+(c-l),c=e[++u]):(a=i+d,l=a-i,s=i-(a-l)+(d-l),d=r[++f]),i=a,s!==0&&(o[m++]=s);for(;u<t;)a=i+c,l=a-i,s=i-(a-l)+(c-l),c=e[++u],i=a,s!==0&&(o[m++]=s);for(;f<n;)a=i+d,l=a-i,s=i-(a-l)+(d-l),d=r[++f],i=a,s!==0&&(o[m++]=s);return(i!==0||m===0)&&(o[m++]=i),m}function ud(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}function xn(t){return new Float64Array(t)}const dd=(3+16*$t)*$t,fd=(2+12*$t)*$t,hd=(9+64*$t)*$t*$t,Jt=xn(4),Go=xn(8),Ko=xn(12),Vo=xn(16),ot=xn(4);function gd(t,e,n,r,o,i,a){let s,l,c,d,u,f,m,b,g,y,x,C,S,R,P,E,D,T;const A=t-o,$=n-o,I=e-i,O=r-i;R=A*O,f=rt*A,m=f-(f-A),b=A-m,f=rt*O,g=f-(f-O),y=O-g,P=b*y-(R-m*g-b*g-m*y),E=I*$,f=rt*I,m=f-(f-I),b=I-m,f=rt*$,g=f-(f-$),y=$-g,D=b*y-(E-m*g-b*g-m*y),x=P-D,u=P-x,Jt[0]=P-(x+u)+(u-D),C=R+x,u=C-R,S=R-(C-u)+(x-u),x=S-E,u=S-x,Jt[1]=S-(x+u)+(u-E),T=C+x,u=T-C,Jt[2]=C-(T-u)+(x-u),Jt[3]=T;let z=ud(4,Jt),N=fd*a;if(z>=N||-z>=N||(u=t-A,s=t-(A+u)+(u-o),u=n-$,c=n-($+u)+(u-o),u=e-I,l=e-(I+u)+(u-i),u=r-O,d=r-(O+u)+(u-i),s===0&&l===0&&c===0&&d===0)||(N=hd*a+cd*Math.abs(z),z+=A*d+O*s-(I*c+$*l),z>=N||-z>=N))return z;R=s*O,f=rt*s,m=f-(f-s),b=s-m,f=rt*O,g=f-(f-O),y=O-g,P=b*y-(R-m*g-b*g-m*y),E=l*$,f=rt*l,m=f-(f-l),b=l-m,f=rt*$,g=f-(f-$),y=$-g,D=b*y-(E-m*g-b*g-m*y),x=P-D,u=P-x,ot[0]=P-(x+u)+(u-D),C=R+x,u=C-R,S=R-(C-u)+(x-u),x=S-E,u=S-x,ot[1]=S-(x+u)+(u-E),T=C+x,u=T-C,ot[2]=C-(T-u)+(x-u),ot[3]=T;const K=mr(4,Jt,4,ot,Go);R=A*d,f=rt*A,m=f-(f-A),b=A-m,f=rt*d,g=f-(f-d),y=d-g,P=b*y-(R-m*g-b*g-m*y),E=I*c,f=rt*I,m=f-(f-I),b=I-m,f=rt*c,g=f-(f-c),y=c-g,D=b*y-(E-m*g-b*g-m*y),x=P-D,u=P-x,ot[0]=P-(x+u)+(u-D),C=R+x,u=C-R,S=R-(C-u)+(x-u),x=S-E,u=S-x,ot[1]=S-(x+u)+(u-E),T=C+x,u=T-C,ot[2]=C-(T-u)+(x-u),ot[3]=T;const H=mr(K,Go,4,ot,Ko);R=s*d,f=rt*s,m=f-(f-s),b=s-m,f=rt*d,g=f-(f-d),y=d-g,P=b*y-(R-m*g-b*g-m*y),E=l*c,f=rt*l,m=f-(f-l),b=l-m,f=rt*c,g=f-(f-c),y=c-g,D=b*y-(E-m*g-b*g-m*y),x=P-D,u=P-x,ot[0]=P-(x+u)+(u-D),C=R+x,u=C-R,S=R-(C-u)+(x-u),x=S-E,u=S-x,ot[1]=S-(x+u)+(u-E),T=C+x,u=T-C,ot[2]=C-(T-u)+(x-u),ot[3]=T;const q=mr(H,Ko,4,ot,Vo);return Vo[q-1]}function pd(t,e,n,r,o,i){const a=(e-i)*(n-o),s=(t-o)*(r-i),l=a-s,c=Math.abs(a+s);return Math.abs(l)>=dd*c?l:-gd(t,e,n,r,o,i,c)}var cs={};const dn=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,Tr=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;const n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x,o=t.ll.y<e.ll.y?e.ll.y:t.ll.y,i=t.ur.y<e.ur.y?t.ur.y:e.ur.y;return{ll:{x:n,y:o},ur:{x:r,y:i}}};let jt=Number.EPSILON;jt===void 0&&(jt=Math.pow(2,-52));const md=jt*jt,qo=(t,e)=>{if(-jt<t&&t<jt&&-jt<e&&e<jt)return 0;const n=t-e;return n*n<md*t*e?0:t<e?-1:1};class vd{constructor(){this.reset()}reset(){this.xRounder=new Uo,this.yRounder=new Uo}round(e,n){return{x:this.xRounder.round(e),y:this.yRounder.round(n)}}}class Uo{constructor(){this.tree=new Vr,this.round(0)}round(e){const n=this.tree.add(e),r=this.tree.prev(n);if(r!==null&&qo(n.key,r.key)===0)return this.tree.remove(e),r.key;const o=this.tree.next(n);return o!==null&&qo(n.key,o.key)===0?(this.tree.remove(e),o.key):e}}const bn=new vd,Hn=(t,e)=>t.x*e.y-t.y*e.x,us=(t,e)=>t.x*e.x+t.y*e.y,Jo=(t,e,n)=>{const r=pd(t.x,t.y,e.x,e.y,n.x,n.y);return r>0?-1:r<0?1:0},Un=t=>Math.sqrt(us(t,t)),bd=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},o={x:n.x-t.x,y:n.y-t.y};return Hn(o,r)/Un(o)/Un(r)},yd=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},o={x:n.x-t.x,y:n.y-t.y};return us(o,r)/Un(o)/Un(r)},Zo=(t,e,n)=>e.y===0?null:{x:t.x+e.x/e.y*(n-t.y),y:n},Qo=(t,e,n)=>e.x===0?null:{x:n,y:t.y+e.y/e.x*(n-t.x)},Cd=(t,e,n,r)=>{if(e.x===0)return Qo(n,r,t.x);if(r.x===0)return Qo(t,e,n.x);if(e.y===0)return Zo(n,r,t.y);if(r.y===0)return Zo(t,e,n.y);const o=Hn(e,r);if(o==0)return null;const i={x:n.x-t.x,y:n.y-t.y},a=Hn(i,e)/o,s=Hn(i,r)/o,l=t.x+s*e.x,c=n.x+a*r.x,d=t.y+s*e.y,u=n.y+a*r.y,f=(l+c)/2,m=(d+u)/2;return{x:f,y:m}};class ct{static compare(e,n){const r=ct.comparePoints(e.point,n.point);return r!==0?r:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:Tt.compare(e.segment,n.segment))}static comparePoints(e,n){return e.x<n.x?-1:e.x>n.x?1:e.y<n.y?-1:e.y>n.y?1:0}constructor(e,n){e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const n=e.point.events;for(let r=0,o=n.length;r<o;r++){const i=n[r];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let n=0;n<e;n++){const r=this.point.events[n];if(r.segment.consumedBy===void 0)for(let o=n+1;o<e;o++){const i=this.point.events[o];i.consumedBy===void 0&&r.otherSE.point.events===i.otherSE.point.events&&r.segment.consume(i.segment)}}}getAvailableLinkedEvents(){const e=[];for(let n=0,r=this.point.events.length;n<r;n++){const o=this.point.events[n];o!==this&&!o.segment.ringOut&&o.segment.isInResult()&&e.push(o)}return e}getLeftmostComparator(e){const n=new Map,r=o=>{const i=o.otherSE;n.set(o,{sine:bd(this.point,e.point,i.point),cosine:yd(this.point,e.point,i.point)})};return(o,i)=>{n.has(o)||r(o),n.has(i)||r(i);const{sine:a,cosine:s}=n.get(o),{sine:l,cosine:c}=n.get(i);return a>=0&&l>=0?s<c?1:s>c?-1:0:a<0&&l<0?s<c?-1:s>c?1:0:l<a?-1:l>a?1:0}}}let xd=0;class Tt{static compare(e,n){const r=e.leftSE.point.x,o=n.leftSE.point.x,i=e.rightSE.point.x,a=n.rightSE.point.x;if(a<r)return 1;if(i<o)return-1;const s=e.leftSE.point.y,l=n.leftSE.point.y,c=e.rightSE.point.y,d=n.rightSE.point.y;if(r<o){if(l<s&&l<c)return 1;if(l>s&&l>c)return-1;const u=e.comparePoint(n.leftSE.point);if(u<0)return 1;if(u>0)return-1;const f=n.comparePoint(e.rightSE.point);return f!==0?f:-1}if(r>o){if(s<l&&s<d)return-1;if(s>l&&s>d)return 1;const u=n.comparePoint(e.leftSE.point);if(u!==0)return u;const f=e.comparePoint(n.rightSE.point);return f<0?1:f>0?-1:1}if(s<l)return-1;if(s>l)return 1;if(i<a){const u=n.comparePoint(e.rightSE.point);if(u!==0)return u}if(i>a){const u=e.comparePoint(n.rightSE.point);if(u<0)return 1;if(u>0)return-1}if(i!==a){const u=c-s,f=i-r,m=d-l,b=a-o;if(u>f&&m<b)return 1;if(u<f&&m>b)return-1}return i>a?1:i<a||c<d?-1:c>d?1:e.id<n.id?-1:e.id>n.id?1:0}constructor(e,n,r,o){this.id=++xd,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=r,this.windings=o}static fromRing(e,n,r){let o,i,a;const s=ct.comparePoints(e,n);if(s<0)o=e,i=n,a=1;else if(s>0)o=n,i=e,a=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const l=new ct(o,!0),c=new ct(i,!1);return new Tt(l,c,[r],[a])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<n?e:n},ur:{x:this.rightSE.point.x,y:e>n?e:n}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}comparePoint(e){if(this.isAnEndpoint(e))return 0;const n=this.leftSE.point,r=this.rightSE.point,o=this.vector();if(n.x===r.x)return e.x===n.x?0:e.x<n.x?1:-1;const i=(e.y-n.y)/o.y,a=n.x+i*o.x;if(e.x===a)return 0;const s=(e.x-n.x)/o.x,l=n.y+s*o.y;return e.y===l?0:e.y<l?-1:1}getIntersection(e){const n=this.bbox(),r=e.bbox(),o=Tr(n,r);if(o===null)return null;const i=this.leftSE.point,a=this.rightSE.point,s=e.leftSE.point,l=e.rightSE.point,c=dn(n,s)&&this.comparePoint(s)===0,d=dn(r,i)&&e.comparePoint(i)===0,u=dn(n,l)&&this.comparePoint(l)===0,f=dn(r,a)&&e.comparePoint(a)===0;if(d&&c)return f&&!u?a:!f&&u?l:null;if(d)return u&&i.x===l.x&&i.y===l.y?null:i;if(c)return f&&a.x===s.x&&a.y===s.y?null:s;if(f&&u)return null;if(f)return a;if(u)return l;const m=Cd(i,this.vector(),s,e.vector());return m===null||!dn(o,m)?null:bn.round(m.x,m.y)}split(e){const n=[],r=e.events!==void 0,o=new ct(e,!0),i=new ct(e,!1),a=this.rightSE;this.replaceRightSE(i),n.push(i),n.push(o);const s=new Tt(o,a,this.rings.slice(),this.windings.slice());return ct.comparePoints(s.leftSE.point,s.rightSE.point)>0&&s.swapEvents(),ct.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(o.checkForConsuming(),i.checkForConsuming()),n}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,r=this.windings.length;n<r;n++)this.windings[n]*=-1}consume(e){let n=this,r=e;for(;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;const o=Tt.compare(n,r);if(o!==0){if(o>0){const i=n;n=r,r=i}if(n.prev===r){const i=n;n=r,r=i}for(let i=0,a=r.rings.length;i<a;i++){const s=r.rings[i],l=r.windings[i],c=n.rings.indexOf(s);c===-1?(n.rings.push(s),n.windings.push(l)):n.windings[c]+=l}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,r=this._afterState.windings,o=this._afterState.multiPolys;for(let s=0,l=this.rings.length;s<l;s++){const c=this.rings[s],d=this.windings[s],u=n.indexOf(c);u===-1?(n.push(c),r.push(d)):r[u]+=d}const i=[],a=[];for(let s=0,l=n.length;s<l;s++){if(r[s]===0)continue;const c=n[s],d=c.poly;if(a.indexOf(d)===-1)if(c.isExterior)i.push(d);else{a.indexOf(d)===-1&&a.push(d);const u=i.indexOf(c.poly);u!==-1&&i.splice(u,1)}}for(let s=0,l=i.length;s<l;s++){const c=i[s].multiPoly;o.indexOf(c)===-1&&o.push(c)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(pt.type){case"union":{const r=e.length===0,o=n.length===0;this._isInResult=r!==o;break}case"intersection":{let r,o;e.length<n.length?(r=e.length,o=n.length):(r=n.length,o=e.length),this._isInResult=o===pt.numMultiPolys&&r<o;break}case"xor":{const r=Math.abs(e.length-n.length);this._isInResult=r%2===1;break}case"difference":{const r=o=>o.length===1&&o[0].isSubject;this._isInResult=r(e)!==r(n);break}default:throw new Error(`Unrecognized operation type found ${pt.type}`)}return this._isInResult}}class ei{constructor(e,n,r){if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const o=bn.round(e[0][0],e[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};let i=o;for(let a=1,s=e.length;a<s;a++){if(typeof e[a][0]!="number"||typeof e[a][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let l=bn.round(e[a][0],e[a][1]);l.x===i.x&&l.y===i.y||(this.segments.push(Tt.fromRing(i,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),i=l)}(o.x!==i.x||o.y!==i.y)&&this.segments.push(Tt.fromRing(i,o,this))}getSweepEvents(){const e=[];for(let n=0,r=this.segments.length;n<r;n++){const o=this.segments[n];e.push(o.leftSE),e.push(o.rightSE)}return e}}class Sd{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new ei(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let r=1,o=e.length;r<o;r++){const i=new ei(e[r],this,!1);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,r=this.interiorRings.length;n<r;n++){const o=this.interiorRings[n].getSweepEvents();for(let i=0,a=o.length;i<a;i++)e.push(o[i])}return e}}class ti{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let r=0,o=e.length;r<o;r++){const i=new Sd(e[r],this);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,r=this.polys.length;n<r;n++){const o=this.polys[n].getSweepEvents();for(let i=0,a=o.length;i<a;i++)e.push(o[i])}return e}}class Jn{static factory(e){const n=[];for(let r=0,o=e.length;r<o;r++){const i=e[r];if(!i.isInResult()||i.ringOut)continue;let a=null,s=i.leftSE,l=i.rightSE;const c=[s],d=s.point,u=[];for(;a=s,s=l,c.push(s),s.point!==d;)for(;;){const f=s.getAvailableLinkedEvents();if(f.length===0){const g=c[0].point,y=c[c.length-1].point;throw new Error(`Unable to complete output ring starting at [${g.x}, ${g.y}]. Last matching segment found ends at [${y.x}, ${y.y}].`)}if(f.length===1){l=f[0].otherSE;break}let m=null;for(let g=0,y=u.length;g<y;g++)if(u[g].point===s.point){m=g;break}if(m!==null){const g=u.splice(m)[0],y=c.splice(g.index);y.unshift(y[0].otherSE),n.push(new Jn(y.reverse()));continue}u.push({index:c.length,point:s.point});const b=s.getLeftmostComparator(a);l=f.sort(b)[0].otherSE;break}n.push(new Jn(c))}return n}constructor(e){this.events=e;for(let n=0,r=e.length;n<r;n++)e[n].segment.ringOut=this;this.poly=null}getGeom(){let e=this.events[0].point;const n=[e];for(let c=1,d=this.events.length-1;c<d;c++){const u=this.events[c].point,f=this.events[c+1].point;Jo(u,e,f)!==0&&(n.push(u),e=u)}if(n.length===1)return null;const r=n[0],o=n[1];Jo(r,e,o)===0&&n.shift(),n.push(n[0]);const i=this.isExteriorRing()?1:-1,a=this.isExteriorRing()?0:n.length-1,s=this.isExteriorRing()?n.length:-1,l=[];for(let c=a;c!=s;c+=i)l.push([n[c].x,n[c].y]);return l}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let e=this.events[0];for(let o=1,i=this.events.length;o<i;o++){const a=this.events[o];ct.compare(e,a)>0&&(e=a)}let n=e.segment.prevInResult(),r=n?n.prevInResult():null;for(;;){if(!n)return null;if(!r)return n.ringOut;if(r.ringOut!==n.ringOut)return r.ringOut.enclosingRing()!==n.ringOut?n.ringOut:n.ringOut.enclosingRing();n=r.prevInResult(),r=n?n.prevInResult():null}}}class ni{constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(let n=0,r=this.interiorRings.length;n<r;n++){const o=this.interiorRings[n].getGeom();o!==null&&e.push(o)}return e}}class wd{constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,r=this.polys.length;n<r;n++){const o=this.polys[n].getGeom();o!==null&&e.push(o)}return e}_composePolys(e){const n=[];for(let r=0,o=e.length;r<o;r++){const i=e[r];if(!i.poly)if(i.isExteriorRing())n.push(new ni(i));else{const a=i.enclosingRing();a.poly||n.push(new ni(a)),a.poly.addInterior(i)}}return n}}class $d{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tt.compare;this.queue=e,this.tree=new Vr(n),this.segments=[]}process(e){const n=e.segment,r=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(n),r;const o=e.isLeft?this.tree.add(n):this.tree.find(n);if(!o)throw new Error(`Unable to find segment #${n.id} [${n.leftSE.point.x}, ${n.leftSE.point.y}] -> [${n.rightSE.point.x}, ${n.rightSE.point.y}] in SweepLine tree.`);let i=o,a=o,s,l;for(;s===void 0;)i=this.tree.prev(i),i===null?s=null:i.key.consumedBy===void 0&&(s=i.key);for(;l===void 0;)a=this.tree.next(a),a===null?l=null:a.key.consumedBy===void 0&&(l=a.key);if(e.isLeft){let c=null;if(s){const u=s.getIntersection(n);if(u!==null&&(n.isAnEndpoint(u)||(c=u),!s.isAnEndpoint(u))){const f=this._splitSafely(s,u);for(let m=0,b=f.length;m<b;m++)r.push(f[m])}}let d=null;if(l){const u=l.getIntersection(n);if(u!==null&&(n.isAnEndpoint(u)||(d=u),!l.isAnEndpoint(u))){const f=this._splitSafely(l,u);for(let m=0,b=f.length;m<b;m++)r.push(f[m])}}if(c!==null||d!==null){let u=null;c===null?u=d:d===null?u=c:u=ct.comparePoints(c,d)<=0?c:d,this.queue.remove(n.rightSE),r.push(n.rightSE);const f=n.split(u);for(let m=0,b=f.length;m<b;m++)r.push(f[m])}r.length>0?(this.tree.remove(n),r.push(e)):(this.segments.push(n),n.prev=s)}else{if(s&&l){const c=s.getIntersection(l);if(c!==null){if(!s.isAnEndpoint(c)){const d=this._splitSafely(s,c);for(let u=0,f=d.length;u<f;u++)r.push(d[u])}if(!l.isAnEndpoint(c)){const d=this._splitSafely(l,c);for(let u=0,f=d.length;u<f;u++)r.push(d[u])}}}this.tree.remove(n)}return r}_splitSafely(e,n){this.tree.remove(e);const r=e.rightSE;this.queue.remove(r);const o=e.split(n);return o.push(r),e.consumedBy===void 0&&this.tree.add(e),o}}const ri=typeof process<"u"&&cs.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Rd=typeof process<"u"&&cs.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class Ed{run(e,n,r){pt.type=e,bn.reset();const o=[new ti(n,!0)];for(let u=0,f=r.length;u<f;u++)o.push(new ti(r[u],!1));if(pt.numMultiPolys=o.length,pt.type==="difference"){const u=o[0];let f=1;for(;f<o.length;)Tr(o[f].bbox,u.bbox)!==null?f++:o.splice(f,1)}if(pt.type==="intersection")for(let u=0,f=o.length;u<f;u++){const m=o[u];for(let b=u+1,g=o.length;b<g;b++)if(Tr(m.bbox,o[b].bbox)===null)return[]}const i=new Vr(ct.compare);for(let u=0,f=o.length;u<f;u++){const m=o[u].getSweepEvents();for(let b=0,g=m.length;b<g;b++)if(i.insert(m[b]),i.size>ri)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const a=new $d(i);let s=i.size,l=i.pop();for(;l;){const u=l.key;if(i.size===s){const m=u.segment;throw new Error(`Unable to pop() ${u.isLeft?"left":"right"} SweepEvent [${u.point.x}, ${u.point.y}] from segment #${m.id} [${m.leftSE.point.x}, ${m.leftSE.point.y}] -> [${m.rightSE.point.x}, ${m.rightSE.point.y}] from queue.`)}if(i.size>ri)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(a.segments.length>Rd)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const f=a.process(u);for(let m=0,b=f.length;m<b;m++){const g=f[m];g.consumedBy===void 0&&i.insert(g)}s=i.size,l=i.pop()}bn.reset();const c=Jn.factory(a.segments);return new wd(c).getGeom()}}const pt=new Ed,Md=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return pt.run("union",t,n)},Pd=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return pt.run("intersection",t,n)},Id=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return pt.run("xor",t,n)},jd=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return pt.run("difference",t,n)};var ds={union:Md,intersection:Pd,xor:Id,difference:jd};function Od(t,e,n,r,o){const i=e.trapezoids.map(d=>[d]);let a=null;if(i.length>0&&(a=ds.union(...i)),!a||a.length===0)return;t.fillStyle=r,t.beginPath();for(const d of a)for(let u=0;u<d.length;u++){const f=oi(d[u]);if(f.length!==0){t.moveTo(f[0][0],f[0][1]);for(let m=1;m<f.length;m++)t.lineTo(f[m][0],f[m][1]);t.closePath()}}t.fill("evenodd");let s=null,l=-1/0;for(const d of a){if(!d[0])continue;const u=oi(d[0]),f=Math.abs(kd(u));f>l&&(l=f,s=u)}if(!s||s.length<3)return;const c=Td(s,n);t.fillStyle=o,t.beginPath(),t.moveTo(s[0][0],s[0][1]);for(let d=1;d<s.length;d++)t.lineTo(s[d][0],s[d][1]);t.closePath(),t.moveTo(c[0][0],c[0][1]);for(let d=c.length-1;d>=0;d--)t.lineTo(c[d][0],c[d][1]);t.closePath(),t.fill("evenodd")}function Td(t,e){const n=[],r=t.length;for(let o=0;o<r;o++){const i=t[(o+r-1)%r],a=t[o],s=t[(o+1)%r],l=Math.atan2(a[1]-i[1],a[0]-i[0]),d=Math.sqrt(Math.pow(e.gaugeX*Math.cos(l),2)+Math.pow(e.gaugeY*Math.sin(l),2))/2,u=[Math.sin(l),-Math.cos(l)],f=Math.atan2(s[1]-a[1],s[0]-a[0]),b=Math.sqrt(Math.pow(e.gaugeX*Math.cos(f),2)+Math.pow(e.gaugeY*Math.sin(f),2))/2,g=[Math.sin(f),-Math.cos(f)],y=[a[0]-u[0]*d,a[1]-u[1]*d],x=[a[0]-g[0]*b,a[1]-g[1]*b],C=[a[0]-i[0],a[1]-i[1]],S=[s[0]-a[0],s[1]-a[1]],R=C[0]*S[1]-C[1]*S[0];if(Math.abs(R)<1e-6){const P=[(u[0]+g[0])/2,(u[1]+g[1])/2],E=(d+b)/2;n.push([a[0]-P[0]*E,a[1]-P[1]*E])}else{const P=((x[0]-y[0])*S[1]-(x[1]-y[1])*S[0])/R,E=[y[0]+P*C[0],y[1]+P*C[1]];n.push(E)}}return n}function kd(t){let e=0;for(let n=0,r=t.length-1;n<t.length;r=n++){const[o,i]=t[r],[a,s]=t[n];e+=o*s-a*i}return e/2}function oi(t){if(t.length===0)return t;const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]?t.slice(0,-1):t}const{Text:Ie}=yn,{Option:ht}=_t,Ad=U.memo(({layer:t,children:e,onLayerReorder:n,dragItemHoverStyle:r,dragItemNormalStyle:o})=>{const i=h.useRef(null),[a,s]=h.useState(!1);return h.useEffect(()=>{const l=i.current;if(!l)return;const c=nd({element:l,getInitialData:()=>({layerId:t.id,type:"layer"}),onDragStart:()=>{l.style.opacity="0.5"},onDrop:()=>{l.style.opacity="1"}}),d=td({element:l,onDragEnter:()=>s(!0),onDragLeave:()=>s(!1),onDrop:({source:u})=>{s(!1);const f=u.data.layerId;f&&f!==t.id&&n(f,t.id)},canDrop:({source:u})=>u.data.type==="layer"&&u.data.layerId!==t.id});return()=>{c(),d()}},[t.id,n]),v.jsx("div",{ref:i,style:a?r:o,children:e})}),Bd=({shape:t,patternLayers:e=[],gauge:n=null,onLayersChange:r=(...i)=>{},onGaugeChange:o=(...i)=>{}})=>{const i=h.useRef(null),[a,s]=h.useState(1),[l,c]=h.useState({x:0,y:0}),[d,u]=h.useState(!1),[f,m]=h.useState({x:0,y:0}),[b,g]=h.useState({width:800,height:600}),y=h.useRef(!1),x=Cr(qs);h.useEffect(()=>{console.log("📚 Library patterns loaded:",x)},[x]);const C=h.useMemo(()=>{const p={solid:{name:"Solid Color",type:"solid",defaultConfig:{colors:[{color:"#ffffff"}]}},stripes:{name:"Horizontal Stripes",type:"stripes",defaultConfig:{colors:[{color:"#ffffff",rows:2},{color:"#000000",rows:2}],width:4}},vstripes:{name:"Vertical Stripes",type:"vstripes",defaultConfig:{colors:[{color:"#ffffff",columns:2},{color:"#000000",columns:2}],height:4}},checkerboard:{name:"Checkerboard",type:"checkerboard",defaultConfig:{cellSize:2,colors:[{color:"#ffffff"},{color:"#000000"}]}},argyle:{name:"Argyle",type:"argyle",defaultConfig:{colors:[{color:"#ffffff"},{color:"#ff0000"},{color:"#0000ff"}]}},border:{name:"Border",type:"border",defaultConfig:{thickness:1,color:"#000000"}},row:{name:"Row",type:"row",defaultConfig:{elements:[]}},vstack:{name:"Vertical Stack",type:"vstack",defaultConfig:{elements:[]}}};return x&&typeof x=="object"&&Object.entries(x).forEach(([B,w])=>{const M=`custom-${B}`;p[M]={name:w.name||B,type:"custom",customPattern:w.pattern,customColors:w.colors,defaultConfig:{pattern:w.pattern,colors:w.colors||{}}}}),p},[x]);h.useEffect(()=>{console.log("🎨 Available patterns:",Object.keys(C),C)},[C]);const[S,R]=h.useState(new Set),P=(p,B,w,M=0,j=0,k,Y=[],W=null)=>{const X=[];if(E(B,w,M,j,X),X.length===0)return;let J=Math.min(...X.map(F=>Math.min(F.topLeft.x,F.topRight.x,F.bottomLeft.x,F.bottomRight.x))),te=Math.max(...X.map(F=>Math.max(F.topLeft.x,F.topRight.x,F.bottomLeft.x,F.bottomRight.x))),pe=Math.min(...X.map(F=>Math.min(F.topLeft.y,F.topRight.y,F.bottomLeft.y,F.bottomRight.y))),_=Math.max(...X.map(F=>Math.max(F.topLeft.y,F.topRight.y,F.bottomLeft.y,F.bottomRight.y)));if(p.save(),p.beginPath(),X.forEach((F,re)=>{p.moveTo(F.topLeft.x,F.topLeft.y),p.lineTo(F.topRight.x,F.topRight.y),p.lineTo(F.bottomRight.x,F.bottomRight.y),p.lineTo(F.bottomLeft.x,F.bottomLeft.y),p.closePath()}),p.clip(),Y&&Y.length>0&&W){let F={minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0};z(B,1,0,0,F),D(p,(Y||[]).filter(re=>re.patternType!=="border"),B,J,pe,te-J,_-pe,w,W,F)}else p.fillStyle=k,p.globalAlpha=.3,p.fillRect(J,pe,te-J,_-pe),p.globalAlpha=1;p.restore();const ee=(Y||[]).find(F=>F.patternType==="border");if(ee&&W){const F=ee.patternConfig?.thickness??1,re=ee.patternConfig?.color||"#000000",me=(W.stitchesPerFourInches??W.spi??0)/4,Se=(W.rowsPerFourInches??W.rpi??0)/4,Ae=W.scalingFactor||1,We=w*(me>0?1/me:0)/Ae,Ne=w*(Se>0?1/Se:0)/Ae,Ee={gaugeX:F*We,gaugeY:F*Ne},Te=X.map(Pe=>[[Pe.topLeft.x,Pe.topLeft.y],[Pe.topRight.x,Pe.topRight.y],[Pe.bottomRight.x,Pe.bottomRight.y],[Pe.bottomLeft.x,Pe.bottomLeft.y]]);try{Od(p,{trapezoids:Te},Ee,"transparent",re)}catch(Pe){console.warn("Border render failed:",Pe)}}p.strokeStyle="#a1a8af",p.lineWidth=3,p.lineJoin="round",X.forEach(F=>{p.beginPath(),p.moveTo(F.topLeft.x,F.topLeft.y),p.lineTo(F.topRight.x,F.topRight.y),p.lineTo(F.bottomRight.x,F.bottomRight.y),p.lineTo(F.bottomLeft.x,F.bottomLeft.y),p.closePath(),p.stroke()})},E=(p,B,w=0,M=0,j=[])=>{const k=Math.max(p.baseA,p.baseB)*B,Y=w+(k-p.baseB*B)/2+(p.baseBHorizontalOffset||0)*B,W=w+(k+p.baseB*B)/2+(p.baseBHorizontalOffset||0)*B,X=w+(k-p.baseA*B)/2,J=w+(k+p.baseA*B)/2,te=M,pe=M+p.height*B;if(j.push({topLeft:{x:Y,y:te},topRight:{x:W,y:te},bottomLeft:{x:X,y:pe},bottomRight:{x:J,y:pe}}),p.successors&&p.successors.length>0){const _=p.successors.map(re=>Math.max(re.baseA,re.baseB)*B),ee=_.reduce((re,me)=>re+me,0);let F=w+(k-ee)/2;for(let re=p.successors.length-1;re>=0;re--){const me=p.successors[re],Se=_[re];E(me,B,F,te-me.height*B,j),F+=Se}}},D=(p,B,w,M,j,k,Y,W,X,J=null)=>{const te=J?J.maxX-J.minX:Math.max(w.baseA,w.baseB),pe=J?J.maxY-J.minY:w.height,_=X.scalingFactor||1,ee=te*_,F=pe*_,re=X.stitchesPerFourInches/4,me=X.rowsPerFourInches/4,Se=Math.round(ee*re),Ae=Math.round(F*me),We=k/Se,Ne=Y/Ae,Ee=T(Se,Ae,B);for(let Te=0;Te<Ae;Te++)for(let Pe=0;Pe<Se;Pe++){const Ge=M+Pe*We,lt=j+Te*Ne,ze=Ee[Te]&&Ee[Te][Pe];ze&&ze!=="transparent"&&(p.fillStyle=ze,p.fillRect(Ge,lt,We,Ne))}},T=(p,B,w,M,j)=>{const k=Array(B).fill().map(()=>Array(p).fill("transparent"));return[...w].reverse().forEach(Y=>{A(k,p,B,Y)}),k},A=(p,B,w,M)=>{let{pattern:j,settings:k}=M;if(M.patternType==="stripes"&&M.patternConfig&&M.patternConfig.colors?M.patternConfig.colors.some(Ae=>Ae.rows===0)&&(j=St("stripes",M.patternConfig,w)):M.patternType==="vstripes"&&M.patternConfig&&M.patternConfig.colors&&M.patternConfig.colors.some(Ae=>Ae.columns===0)&&(j=St("vstripes",M.patternConfig,B)),!j||!j.grid||j.grid.length===0)return;const Y=j.getRowCount(),W=j.getStitchCount();if(Y===0||W===0)return;const{repeatMode:X="none",repeatCountX:J=0,repeatCountY:te=0,offsetHorizontal:pe=0,offsetVertical:_=0}=k,ee=X==="x"||X==="both",F=X==="y"||X==="both",re=Math.floor((B-W)/2),me=Math.floor((w-Y)/2);for(let Se=0;Se<w;Se++)for(let Ae=0;Ae<B;Ae++){const We=Ae-re-pe,Ne=Se-me-_;let Ee=0,Te=0;if(ee&&W>0&&(Ee=Math.floor(We/W)),F&&Y>0&&(Te=Math.floor(Ne/Y)),ee&&J>0){const Le=Math.floor(J/2),Fe=(J%2===0,-Le),ke=J%2===0?Le-1:Le;if(Ee<Fe||Ee>ke)continue}if(F&&te>0){const Le=Math.floor(te/2),Fe=(te%2===0,-Le),ke=te%2===0?Le-1:Le;if(Te<Fe||Te>ke)continue}if(!ee&&(We<0||We>=W)||!F&&(Ne<0||Ne>=Y))continue;let Pe,Ge;if(ee)Pe=(We%W+W)%W;else if(Pe=We,Pe<0||Pe>=W)continue;if(F)Ge=(Ne%Y+Y)%Y;else if(Ge=Ne,Ge<0||Ge>=Y)continue;const lt=j.grid[Ge][Pe],ze=j.colors[lt];if(ze){const Le=M.settings.colorMapping?.[lt]||ze.color;Le&&Le!=="transparent"&&(p[Se][Ae]=Le)}}},$=(p,B,w,M,j,k,Y,W,X,J,te,pe)=>{const _=window.devicePixelRatio||1,ee=30*_,F=30*_,re=Y*j*_;p.save(),p.setTransform(_,0,0,_,0,0),p.fillStyle="#f0f0f0",p.fillRect(0,w-F/_,B,F/_),p.fillRect(0,0,ee/_,w),p.strokeStyle="#d0d0d0",p.lineWidth=1,p.beginPath(),p.moveTo(0,w-F/_),p.lineTo(B,w-F/_),p.moveTo(ee/_,0),p.lineTo(ee/_,w),p.stroke(),p.fillStyle="#666",p.font="10px Arial",p.textAlign="center",p.textBaseline="middle",p.fillStyle="#333",p.font="10px Arial",p.textAlign="center",p.textBaseline="middle";const me=(W.maxX-W.minX)*Y*j,Se=(W.maxY-W.minY)*Y*j,Ae=X,We=J,Ne=Ae-me/2,Ee=We+Se/2,Te=Ne,Pe=Ee,Ge=Math.ceil(te),lt=Math.ceil(pe);for(let Fe=0;Fe<=Ge;Fe++){const ke=Te+Fe*re/_;ke>=ee/_&&ke<=B&&(p.strokeStyle="#666",p.lineWidth=1,p.beginPath(),p.moveTo(ke,w-8),p.lineTo(ke,w),p.stroke(),p.fillStyle="#333",p.fillText(Fe.toString(),ke,w-15));const Qe=ke+re/_/2;if(Qe>=ee/_&&Qe<=B&&Fe<Ge&&(p.strokeStyle="#999",p.lineWidth=1,p.beginPath(),p.moveTo(Qe,w-4),p.lineTo(Qe,w),p.stroke()),Fe<Ge){const st=ke+re/_/4,Je=ke+3*re/_/4;st>=ee/_&&st<=B&&(p.strokeStyle="#ccc",p.lineWidth=1,p.beginPath(),p.moveTo(st,w-2),p.lineTo(st,w),p.stroke()),Je>=ee/_&&Je<=B&&(p.strokeStyle="#ccc",p.lineWidth=1,p.beginPath(),p.moveTo(Je,w-2),p.lineTo(Je,w),p.stroke())}}const ze=Te+te*re/_;ze>=ee/_&&ze<=B&&(p.fillStyle="#555",p.font="italic 10px Arial",p.fillText(`${te.toFixed(1)}"`,ze+20,w-10)),p.textAlign="center",p.textBaseline="middle";for(let Fe=0;Fe<=lt;Fe++){const ke=Pe-Fe*re/_;ke>=F/_&&ke<=w&&(p.strokeStyle="#666",p.lineWidth=1,p.beginPath(),p.moveTo(ee/_-8,ke),p.lineTo(ee/_,ke),p.stroke(),p.save(),p.translate(15,ke),p.rotate(-Math.PI/2),p.fillStyle="#333",p.fillText(Fe.toString(),0,0),p.restore());const Qe=ke-re/_/2;if(Qe>=F/_&&Qe<=w&&Fe<lt&&(p.strokeStyle="#999",p.lineWidth=1,p.beginPath(),p.moveTo(ee/_-4,Qe),p.lineTo(ee/_,Qe),p.stroke()),Fe<lt){const st=ke-re/_/4,Je=ke-3*re/_/4;st>=F/_&&st<=w&&(p.strokeStyle="#ccc",p.lineWidth=1,p.beginPath(),p.moveTo(ee/_-2,st),p.lineTo(ee/_,st),p.stroke()),Je>=F/_&&Je<=w&&(p.strokeStyle="#ccc",p.lineWidth=1,p.beginPath(),p.moveTo(ee/_-2,Je),p.lineTo(ee/_,Je),p.stroke())}}const Le=Pe-pe*re/_;Le>=F/_&&Le<=w&&(p.save(),p.translate(10,Le-20),p.rotate(-Math.PI/2),p.fillStyle="#555",p.font="italic 10px Arial",p.textAlign="center",p.fillText(`${pe.toFixed(1)}"`,0,0),p.restore()),p.restore()},I=(p,B,w,M=0,j=0,k,Y=[],W=null)=>{const X=Math.max(B.baseA,B.baseB)*w,J=M+(X-B.baseB*w)/2+(B.baseBHorizontalOffset||0)*w,te=M+(X+B.baseB*w)/2+(B.baseBHorizontalOffset||0)*w,pe=M+(X-B.baseA*w)/2,_=M+(X+B.baseA*w)/2,ee=j,F=j+B.height*w;if(p.save(),p.beginPath(),p.moveTo(J,ee),p.lineTo(te,ee),p.lineTo(_,F),p.lineTo(pe,F),p.closePath(),p.clip(),Y&&Y.length>0&&W){const re={baseA:B.baseA,baseB:B.baseB,height:B.height,baseBHorizontalOffset:B.baseBHorizontalOffset||0};D(p,(Y||[]).filter(me=>me.patternType!=="border"),re,pe,ee,_-pe,F-ee,w,W)}else p.fillStyle=k,p.fill();p.restore(),p.strokeStyle="#1890ff",p.lineWidth=3,p.beginPath(),p.moveTo(J,ee),p.lineTo(te,ee),p.lineTo(_,F),p.lineTo(pe,F),p.closePath(),p.stroke()},O=(p,B,w,M=0,j=0,k={minX:0,maxX:0,minY:0,maxY:0},Y,W=[],X=null)=>{if(z(B,w,M,j,k),I(p,B,w,M,j,Y,W,X),B.successors&&B.successors.length>0){const J=Math.max(B.baseA,B.baseB)*w,te=B.successors.map(F=>Math.max(F.baseA,F.baseB)*w),pe=te.reduce((F,re)=>F+re,0);let _=M+(J-pe)/2;const ee=j;for(let F=B.successors.length-1;F>=0;F--){const re=B.successors[F],me=te[F];O(p,re,w,_,ee-re.height*w,k,Y,W,X),_+=me}}},z=(p,B,w=0,M=0,j={minX:0,maxX:0,minY:0,maxY:0})=>{const k=Math.max(p.baseA,p.baseB)*B,Y=w+(k-p.baseB*B)/2+(p.baseBHorizontalOffset||0)*B,W=w+(k+p.baseB*B)/2+(p.baseBHorizontalOffset||0)*B,X=w+(k-p.baseA*B)/2,J=w+(k+p.baseA*B)/2,te=M,pe=M+p.height*B;if(j.minX=Math.min(j.minX,Y,W,X,J),j.maxX=Math.max(j.maxX,Y,W,X,J),j.minY=Math.min(j.minY,te,pe),j.maxY=Math.max(j.maxY,te,pe),p.successors&&p.successors.length>0){const _=p.successors.map(re=>Math.max(re.baseA,re.baseB)*B),ee=_.reduce((re,me)=>re+me,0);let F=w+(k-ee)/2;for(let re=p.successors.length-1;re>=0;re--){const me=p.successors[re],Se=_[re];z(me,B,F,te-me.height*B,j),F+=Se}}},N=p=>{p.button===0&&(p.preventDefault(),u(!0),m({x:p.clientX,y:p.clientY}))},K=p=>{if(!d)return;p.preventDefault();const B=p.clientX-f.x,w=p.clientY-f.y;c(M=>({x:M.x+B,y:M.y+w})),m({x:p.clientX,y:p.clientY})},H=p=>{p.preventDefault(),u(!1)},q=p=>{p.preventDefault()},oe=()=>{s(1),c({x:0,y:0})};h.useEffect(()=>{const p=B=>{if(!i.current)return;B.key==="="||B.key==="+"?(B.preventDefault(),s(M=>Math.min(M*1.2,5))):B.key==="-"?(B.preventDefault(),s(M=>Math.max(M/1.2,.1))):B.key==="0"&&(B.ctrlKey||B.metaKey)&&(B.preventDefault(),oe());const w=20;B.key==="ArrowUp"?(B.preventDefault(),c(M=>({...M,y:M.y+w}))):B.key==="ArrowDown"?(B.preventDefault(),c(M=>({...M,y:M.y-w}))):B.key==="ArrowLeft"?(B.preventDefault(),c(M=>({...M,x:M.x+w}))):B.key==="ArrowRight"&&(B.preventDefault(),c(M=>({...M,x:M.x-w})))};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[]),h.useEffect(()=>{const p=i.current;if(!p||!t)return;const B=p.getContext("2d"),w=window.devicePixelRatio||1,M=30,j=30;p.width=b.width*w,p.height=b.height*w,p.style.width=`${b.width}px`,p.style.height=`${b.height}px`,B.scale(w,w),B.clearRect(0,0,b.width,b.height),B.save(),B.translate((b.width-M)/2+l.x+M,(b.height-j)/2+l.y+j),B.scale(a,a);let k={minX:0,maxX:0,minY:0,maxY:0};const W=document.createElement("canvas").getContext("2d");O(W,t,1,0,0,k,"#1890ff");const X=k.maxX-k.minX,J=k.maxY-k.minY,te=(b.width-M)*.8,pe=(b.height-j)*.8,_=Math.min(te/X,pe/J),ee=-k.minX*_-X*_/2,F=-k.minY*_-J*_/2;B.translate(ee,F);const re={...k};P(B,t,_,0,0,"#1890ff",e,n),B.restore();let me={minX:0,maxX:0,minY:0,maxY:0};z(t,1,0,0,me);const Se=n?.scalingFactor||1,Ae=(me.maxX-me.minX)*Se,We=(me.maxY-me.minY)*Se,Ne=(b.width-M)/2+l.x+M,Ee=(b.height-j)/2+l.y+j;$(B,b.width,b.height,t,a,{x:l.x,y:l.y},_,re,Ne,Ee,Ae,We)},[t,e,n,a,l,b]),h.useEffect(()=>{const p=()=>{const B=document.querySelector(".canvas-container");B&&g({width:B.clientWidth-20,height:B.clientHeight-20})};return p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]),h.useEffect(()=>{if(e.length===0&&!y.current){y.current=!0;const p={id:Date.now(),name:"solid color bg",pattern:St("solid",{colors:[{color:"#cfcfcf"}]}),patternType:"solid",patternConfig:{colors:[{color:"#cfcfcf"}]},priority:1,settings:{repeatMode:"both",repeatCountX:0,repeatCountY:0,offsetHorizontal:0,offsetVertical:0,colorMapping:{}}};r([p])}},[e.length,r]);const L=h.useCallback((p,B,w)=>{r(M=>M.map(j=>j.id===p?{...j,settings:{...j.settings,[B]:w}}:j))},[r]),ae=(p,B,w)=>{const M=typeof w=="string"?w:w.toHexString(),j=e.map(k=>{if(k.id===p){const Y={...k.settings.colorMapping,[B]:M};return{...k,settings:{...k.settings,colorMapping:Y}}}return k});r(j)},be=h.useCallback((p,B)=>{r(w=>{const M=w.findIndex(W=>W.id===p),j=w.findIndex(W=>W.id===B);if(M===-1||j===-1)return w;const k=[...w],[Y]=k.splice(M,1);return k.splice(j,0,Y),k})},[r]),fe=h.useCallback(p=>{R(B=>{const w=new Set(B);return w.has(p)?w.delete(p):w.add(p),w})},[]),se=h.useCallback(()=>{const p="checkerboard",B={id:Date.now(),name:`Layer ${e.length+1}`,pattern:St(C[p].type,C[p].defaultConfig),patternType:C[p].type,patternConfig:C[p].defaultConfig,priority:e.length+1,settings:{repeatMode:"none",repeatCountX:0,repeatCountY:0,offsetHorizontal:0,offsetVertical:0,colorMapping:{}}};r(w=>[B,...w])},[e.length,r]),Q=h.useMemo(()=>({fontSize:"12px"}),[]),le=h.useMemo(()=>({minWidth:30,fontSize:"11px"}),[]),Z=h.useMemo(()=>({width:"100%"}),[]),ne=h.useMemo(()=>({width:"100%"}),[]),ce=h.useMemo(()=>({marginBottom:8,transition:"all 0.2s ease"}),[]),Ce=h.useMemo(()=>({...ce,border:"2px dashed #1890ff",borderRadius:"4px"}),[ce]),$e=h.useMemo(()=>({...ce,border:"none",borderRadius:"0"}),[ce]),he=h.useCallback(p=>p.patternKey||p.patternType||"checkerboard",[]),xe=h.useCallback(p=>{r(B=>B.filter(w=>w.id!==p))},[r]),Re=h.useCallback(p=>{r(B=>{const w=B.find(j=>j.id===p);return w?[{...w,id:Date.now(),name:`${w.name} Copy`,priority:B.length+1},...B]:B})},[r]),ye=h.useCallback((p,B)=>{const w=C[B].type,M={...C[B].defaultConfig,patterns:C},j=St(w,M);r(k=>k.map(Y=>Y.id===p?{...Y,pattern:j,patternType:w,patternKey:B,patternConfig:M,settings:{...Y.settings,colorMapping:{}}}:Y))},[r,C]),ie=h.useCallback((p,B)=>{r(w=>w.map(M=>{if(M.id===p){const j={...B,patterns:C},k=St(M.patternType,j);return{...M,patternConfig:B,pattern:k}}return M}))},[r,C]);return v.jsxs("div",{className:"colorwork-canvas-editor",children:[v.jsx("div",{className:"canvas-header",style:{display:"flex",alignItems:"center",padding:"8px 16px",borderBottom:"1px solid #f0f0f0",background:"#fafafa"},children:v.jsxs(Ye,{children:[v.jsxs(Ie,{children:["Zoom: ",Math.round(a*100),"%"]}),v.jsx(je,{icon:v.jsx(Cc,{}),onClick:()=>s(p=>Math.min(p*1.2,5)),size:"small",title:"Zoom in (+)"}),v.jsx(Ki,{min:.1,max:5,step:.1,value:a,onChange:s,style:{width:100},tooltip:{formatter:p=>`${Math.round(p*100)}%`}}),v.jsx(je,{icon:v.jsx(wc,{}),onClick:()=>s(p=>Math.max(p/1.2,.1)),size:"small",title:"Zoom out (-)"}),v.jsx(je,{icon:v.jsx(hu,{}),onClick:oe,size:"small",title:"Reset view (Ctrl+0)",children:"Reset"}),v.jsx(Ie,{style:{fontSize:"11px",color:"#666",marginLeft:8},children:"Drag to pan • +/- to zoom • Arrows to move"})]})}),v.jsxs("div",{className:"canvas-main-layout",children:[v.jsx("div",{className:"canvas-container",children:v.jsx("canvas",{ref:i,className:"main-canvas",onMouseDown:N,onMouseMove:K,onMouseUp:H,onMouseLeave:H,onContextMenu:q,style:{cursor:d?"grabbing":"grab",userSelect:"none",touchAction:"none"}})}),v.jsx("div",{className:"side-panel",children:v.jsx(ut,{title:"Colorwork Layers",size:"small",children:v.jsxs(Ye,{direction:"vertical",style:{width:"100%"},size:"small",children:[v.jsx(je,{type:"primary",icon:v.jsx(Yn,{}),onClick:se,style:{width:"100%"},size:"small",children:"+ New Layer"}),v.jsx("div",{className:"layers-list",children:e.map((p,B)=>v.jsx(Ad,{layer:p,index:B,onLayerReorder:be,dragItemHoverStyle:Ce,dragItemNormalStyle:$e,children:v.jsx(Us,{size:"small",ghost:!0,activeKey:S.has(p.id)?[]:[p.id],onChange:()=>fe(p.id),items:[{key:p.id,label:v.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[v.jsxs("span",{style:{display:"flex",alignItems:"center",gap:8},children:[v.jsx(uu,{className:"drag-handle",style:{cursor:"grab"}}),p.name]}),v.jsxs("div",{style:{display:"flex",gap:4},children:[v.jsx(je,{size:"small",type:"text",icon:v.jsx(xr,{}),onClick:w=>{w.stopPropagation(),Re(p.id)},title:"Make a copy"}),v.jsx(je,{size:"small",danger:!0,type:"text",icon:v.jsx(Sr,{}),onClick:w=>{w.stopPropagation(),xe(p.id)},disabled:e.length===1,title:"Delete layer"})]})]}),children:v.jsxs(Ye,{direction:"vertical",style:ne,size:"small",children:[v.jsxs("div",{children:[v.jsx(Ie,{style:Q,children:"Pattern:"}),v.jsx(_t,{value:he(p),onChange:w=>ye(p.id,w),style:Z,size:"small",children:Object.entries(C).map(([w,M])=>v.jsx(ht,{value:w,children:M.name},w))})]}),p.patternType==="border"&&v.jsxs("div",{children:[v.jsx(Ie,{style:Q,children:"Border Color:"}),v.jsx("div",{style:{margin:"6px 0 12px"},children:v.jsx(Qt,{value:p.patternConfig?.color||"#000000",onChange:w=>{const M=typeof w=="string"?w:w.toHexString(),j={...p.patternConfig,color:M};ie(p.id,j)},showText:!1,size:"small"})}),v.jsx(Ie,{style:Q,children:"Border Thickness (stitches):"}),v.jsx(He,{value:p.patternConfig?.thickness??1,onChange:w=>{const M={...p.patternConfig,thickness:w??1};ie(p.id,M)},min:0,max:20,size:"small",style:Z})]}),p.patternType==="stripes"&&v.jsxs("div",{children:[v.jsx(Ie,{style:Q,children:"Pattern Width (stitches):"}),v.jsx(He,{value:p.patternConfig?.width||4,onChange:w=>{const M={...p.patternConfig,width:w||4};ie(p.id,M)},min:1,max:20,size:"small",style:Z})]}),p.patternType==="vstripes"&&v.jsxs("div",{children:[v.jsx(Ie,{style:Q,children:"Pattern Height (rows):"}),v.jsx(He,{value:p.patternConfig?.height||4,onChange:w=>{const M={...p.patternConfig,height:w||4};ie(p.id,M)},min:1,max:20,size:"small",style:Z})]}),p.patternType==="checkerboard"&&v.jsxs("div",{children:[v.jsx(Ie,{style:Q,children:"Cell Size (n x n):"}),v.jsx(He,{value:p.patternConfig?.cellSize||2,onChange:w=>{const M={...p.patternConfig,cellSize:w||2};ie(p.id,M)},min:1,max:10,size:"small",style:Z,formatter:w=>`${w} x ${w}`,parser:w=>w.replace(" x "+w.split(" x ")[1],"")})]}),p.patternType==="stripes"&&v.jsxs("div",{children:[v.jsx(Ie,{style:Q,children:"Stripe Configuration:"}),v.jsx(Ie,{style:{fontSize:"11px",color:"#666",display:"block",marginTop:2},children:"Enter 0 rows to fill remaining space with that color"}),p.patternConfig.colors.map((j,k)=>j.rows===0?k:-1).filter(j=>j!==-1).filter(j=>j!==0&&j!==p.patternConfig.colors.length-1).length>0?v.jsx(Ie,{style:{fontSize:"11px",color:"#ff6b35",display:"block",marginTop:2},children:"Warning: Only first or last colors should have 0 rows"}):null,v.jsxs(Ye,{direction:"vertical",size:"small",style:{marginTop:8},children:[p.patternConfig.colors.map((w,M)=>v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[v.jsx(He,{value:w.rows,onChange:j=>{const k=[...p.patternConfig.colors];k[M].rows=j||0,ie(p.id,{...p.patternConfig,colors:k})},min:0,size:"small",style:{width:60},placeholder:"0"}),v.jsx(Ie,{children:w.rows===0?"rows (fill)":"rows"}),p.patternConfig.colors.length>1&&v.jsx(je,{size:"small",danger:!0,onClick:()=>{const j=p.patternConfig.colors.filter((k,Y)=>Y!==M);ie(p.id,{...p.patternConfig,colors:j})},children:"Remove"})]},M)),v.jsx(je,{size:"small",onClick:()=>{const w=[...p.patternConfig.colors,{color:"#ff0000",rows:2}];ie(p.id,{...p.patternConfig,colors:w})},children:"Add Color"})]})]}),p.patternType==="vstripes"&&v.jsxs("div",{children:[v.jsx(Ie,{style:Q,children:"Vertical Stripe Configuration:"}),v.jsx(Ie,{style:{fontSize:"11px",color:"#666",display:"block",marginTop:2},children:"Enter 0 columns to fill remaining space with that color"}),p.patternConfig.colors.map((j,k)=>j.columns===0?k:-1).filter(j=>j!==-1).filter(j=>j!==0&&j!==p.patternConfig.colors.length-1).length>0?v.jsx(Ie,{style:{fontSize:"11px",color:"#ff6b35",display:"block",marginTop:2},children:"Warning: Only first or last colors should have 0 columns"}):null,v.jsxs(Ye,{direction:"vertical",size:"small",style:{marginTop:8},children:[p.patternConfig.colors.map((w,M)=>v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[v.jsx(He,{value:w.columns,onChange:j=>{const k=[...p.patternConfig.colors];k[M].columns=j||0,ie(p.id,{...p.patternConfig,colors:k})},min:0,size:"small",style:{width:60},placeholder:"0"}),v.jsx(Ie,{children:w.columns===0?"cols (fill)":"cols"}),p.patternConfig.colors.length>1&&v.jsx(je,{size:"small",danger:!0,onClick:()=>{const j=p.patternConfig.colors.filter((k,Y)=>Y!==M);ie(p.id,{...p.patternConfig,colors:j})},children:"Remove"})]},M)),v.jsx(je,{size:"small",onClick:()=>{const w=[...p.patternConfig.colors,{color:"#ff0000",columns:2}];ie(p.id,{...p.patternConfig,colors:w})},children:"Add Color"})]})]}),(p.patternType==="row"||p.patternType==="vstack")&&v.jsxs("div",{children:[v.jsx(Ie,{style:Q,children:p.patternType==="row"?"Row:":"Vertical Stack:"}),v.jsx(Ie,{style:{fontSize:"11px",color:"#666",display:"block",marginTop:2,marginBottom:8},children:p.patternType==="row"?"Stack elements left to right. Use stripes for bands or custom shapes (with repeat count).":"Stack elements top to bottom. Use stripes for bands, custom shapes (with repeat count), or rows for horizontal composition."}),v.jsxs(Ye,{direction:"vertical",size:"small",style:{width:"100%"},children:[(p.patternConfig.elements||[]).map((w,M)=>v.jsxs("div",{style:{border:"1px solid #d9d9d9",padding:8,borderRadius:4},children:[v.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[v.jsx(Ie,{style:{fontSize:"11px",fontWeight:"bold"},children:w.elementType==="stripes"?`Stripes ${M+1}`:w.elementType==="shape"&&w.shapeKey?C[w.shapeKey]?.name||"Shape":w.elementType==="sequence"?`Sequence ${M+1}`:`Element ${M+1}`}),v.jsxs(Ye,{size:"small",children:[v.jsx(je,{size:"small",disabled:M===0,onClick:()=>{const j=[...p.patternConfig.elements||[]];[j[M-1],j[M]]=[j[M],j[M-1]],ie(p.id,{...p.patternConfig,elements:j})},children:"↑"}),v.jsx(je,{size:"small",disabled:M===(p.patternConfig.elements||[]).length-1,onClick:()=>{const j=[...p.patternConfig.elements||[]];[j[M],j[M+1]]=[j[M+1],j[M]],ie(p.id,{...p.patternConfig,elements:j})},children:"↓"}),v.jsx(je,{size:"small",danger:!0,onClick:()=>{const j=(p.patternConfig.elements||[]).filter((k,Y)=>Y!==M);ie(p.id,{...p.patternConfig,elements:j})},children:"Remove"})]})]}),v.jsxs(_t,{value:w.elementType||"stripes",onChange:j=>{const k=[...p.patternConfig.elements||[]];j==="stripes"?k[M]={elementType:"stripes",stripeConfig:p.patternType==="row"?{colors:[{color:"#ffffff",columns:2}]}:{colors:[{color:"#ffffff",rows:2}]}}:j==="sequence"?k[M]={elementType:"sequence",shapes:[],repeatCount:1,alignment:"center"}:j.startsWith("custom-")&&(k[M]={elementType:"shape",shapeKey:j,repeatCount:1}),ie(p.id,{...p.patternConfig,elements:k})},size:"small",style:{width:"100%",marginBottom:8},children:[v.jsx(ht,{value:"stripes",children:"Stripes"}),Object.entries(C).filter(([j])=>j.startsWith("custom-")).map(([j,k])=>v.jsx(ht,{value:j,children:k.name},j))]}),w.elementType==="stripes"&&w.stripeConfig&&v.jsxs("div",{style:{marginTop:8,paddingLeft:8,borderLeft:"2px solid #e8e8e8"},children:[v.jsx(Ie,{style:{fontSize:"10px",display:"block",marginBottom:4},children:"Stripe width (sts):"}),w.stripeConfig.colors.map((j,k)=>v.jsx("div",{style:{display:"flex",gap:4,alignItems:"center",marginBottom:4},children:v.jsx(He,{value:p.patternType==="row"?j.columns:j.rows,onChange:Y=>{const W=[...p.patternConfig.elements||[]],X=[...w.stripeConfig.colors];p.patternType==="row"?X[k]={...X[k],columns:Y||1}:X[k]={...X[k],rows:Y||1},W[M]={...w,stripeConfig:{colors:X}},ie(p.id,{...p.patternConfig,elements:W})},min:1,size:"small",style:{width:50}})},k))]}),w.elementType==="shape"&&w.shapeKey&&v.jsx("div",{style:{marginTop:8,paddingLeft:8,borderLeft:"2px solid #e8e8e8"},children:v.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[v.jsx(Ie,{style:{fontSize:"10px"},children:"Repeat:"}),v.jsx(He,{value:w.repeatCount||1,onChange:j=>{const k=[...p.patternConfig.elements||[]];k[M]={...w,repeatCount:j||1},ie(p.id,{...p.patternConfig,elements:k})},min:1,size:"small",style:{width:60}})]})}),(w.elementType==="vstack"||w.elementType==="row")&&v.jsxs("div",{style:{marginTop:8,paddingLeft:8,borderLeft:"2px solid #e8e8e8"},children:[v.jsxs(Ie,{style:{fontSize:"10px",display:"block",marginBottom:4},children:[w.elementType==="vstack"?"Vertical":"Row"," Stack:"]}),v.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center",marginBottom:6},children:[v.jsx(Ie,{style:{fontSize:"10px"},children:"Repeat:"}),v.jsx(He,{value:w.repeatCount||1,onChange:j=>{const k=[...p.patternConfig.elements||[]];k[M]={...w,repeatCount:j||1},ie(p.id,{...p.patternConfig,elements:k})},min:1,size:"small",style:{width:60}})]}),(w.elements||[]).filter(j=>j.elementType==="stripes").map((j,k)=>{const Y=(w.elements||[]).findIndex((W,X)=>W===j&&X>=k);return v.jsxs("div",{style:{marginBottom:6},children:[v.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center",marginBottom:4},children:[v.jsx(Ie,{style:{fontSize:"10px",color:"#666"},children:"Stripes"}),v.jsx(je,{size:"small",danger:!0,onClick:()=>{const W=[...p.patternConfig.elements||[]],X=(w.elements||[]).filter((J,te)=>te!==Y);W[M]={...w,elements:X},ie(p.id,{...p.patternConfig,elements:W})},children:"×"})]}),j.stripeConfig&&j.stripeConfig.colors.map((W,X)=>v.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center",marginBottom:4,marginLeft:8},children:[v.jsx(Qt,{value:W.color,onChange:J=>{const te=[...p.patternConfig.elements||[]],pe=[...w.elements||[]],_={...j.stripeConfig};_.colors=[..._.colors],_.colors[X]={...W,color:J.toHexString()},pe[Y]={...j,stripeConfig:_},te[M]={...w,elements:pe},ie(p.id,{...p.patternConfig,elements:te})},size:"small"}),v.jsx(He,{value:w.elementType==="vstack"?W.rows:W.columns,onChange:J=>{const te=[...p.patternConfig.elements||[]],pe=[...w.elements||[]],_={...j.stripeConfig};_.colors=[..._.colors],w.elementType==="vstack"?_.colors[X]={...W,rows:J||1}:_.colors[X]={...W,columns:J||1},pe[Y]={...j,stripeConfig:_},te[M]={...w,elements:pe},ie(p.id,{...p.patternConfig,elements:te})},min:1,size:"small",style:{width:50}}),v.jsx(je,{size:"small",danger:!0,onClick:()=>{const J=[...p.patternConfig.elements||[]],te=[...w.elements||[]],pe={...j.stripeConfig};pe.colors=pe.colors.filter((_,ee)=>ee!==X),te[Y]={...j,stripeConfig:pe},J[M]={...w,elements:te},ie(p.id,{...p.patternConfig,elements:J})},children:"×"})]},X)),v.jsx(je,{size:"small",onClick:()=>{const W=[...p.patternConfig.elements||[]],X=[...w.elements||[]],J={...j.stripeConfig};J.colors=[...J.colors,w.elementType==="vstack"?{color:"#ffffff",rows:2}:{color:"#ffffff",columns:2}],X[Y]={...j,stripeConfig:J},W[M]={...w,elements:X},ie(p.id,{...p.patternConfig,elements:W})},style:{marginLeft:8},children:"+ Stripe"})]},`stripe-${k}`)}),(w.elements||[]).filter(j=>j.elementType==="shape").map((j,k)=>{const Y=(w.elements||[]).findIndex((W,X)=>W===j&&X>=k);return v.jsx("div",{style:{marginBottom:6},children:v.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center",marginBottom:4},children:[v.jsx(_t,{value:j.shapeKey||"",onChange:W=>{const X=[...p.patternConfig.elements||[]],J=[...w.elements||[]];J[Y]={...j,shapeKey:W},X[M]={...w,elements:J},ie(p.id,{...p.patternConfig,elements:X})},size:"small",style:{flex:1},children:Object.keys(C).map(W=>v.jsx(ht,{value:W,children:C[W].name},W))}),v.jsx(Ie,{style:{fontSize:"9px"},children:"x"}),v.jsx(He,{value:j.repeatCount||1,onChange:W=>{const X=[...p.patternConfig.elements||[]],J=[...w.elements||[]];J[Y]={...j,repeatCount:W||1},X[M]={...w,elements:J},ie(p.id,{...p.patternConfig,elements:X})},min:1,size:"small",style:{width:50}}),v.jsx(je,{size:"small",danger:!0,onClick:()=>{const W=[...p.patternConfig.elements||[]],X=(w.elements||[]).filter((J,te)=>te!==Y);W[M]={...w,elements:X},ie(p.id,{...p.patternConfig,elements:W})},children:"×"})]})},`shape-${k}`)}),v.jsxs("div",{style:{display:"flex",gap:4},children:[v.jsx(je,{size:"small",onClick:()=>{const j=[...p.patternConfig.elements||[]],k=[...w.elements||[],{elementType:"stripes",stripeConfig:w.elementType==="vstack"?{colors:[{color:"#ffffff",rows:2}]}:{colors:[{color:"#ffffff",columns:2}]}}];j[M]={...w,elements:k},ie(p.id,{...p.patternConfig,elements:j})},children:"+ Stripes"}),v.jsx(je,{size:"small",onClick:()=>{const j=[...p.patternConfig.elements||[]],k=[...w.elements||[],{elementType:"shape",shapeKey:Object.keys(C)[0]||"",repeatCount:1}];j[M]={...w,elements:k},ie(p.id,{...p.patternConfig,elements:j})},children:"+ Shape"})]})]}),w.elementType==="sequence"&&v.jsxs("div",{style:{marginTop:8,paddingLeft:8,borderLeft:"2px solid #e8e8e8"},children:[v.jsx(Ie,{style:{fontSize:"10px",display:"block",marginBottom:4},children:"Shapes in sequence:"}),v.jsx(Ie,{style:{fontSize:"9px",color:"#999",display:"block",marginBottom:4},children:"(Add shapes to create a sequence)"}),v.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center",marginTop:4},children:[v.jsx(Ie,{style:{fontSize:"10px"},children:"Repeat Sequence:"}),v.jsx(He,{value:w.repeatCount||1,onChange:j=>{const k=[...p.patternConfig.elements||[]];k[M]={...w,repeatCount:j||1},ie(p.id,{...p.patternConfig,elements:k})},min:0,size:"small",style:{width:60}})]}),v.jsxs(_t,{value:w.alignment||"center",onChange:j=>{const k=[...p.patternConfig.elements||[]];k[M]={...w,alignment:j},ie(p.id,{...p.patternConfig,elements:k})},size:"small",style:{width:"100%",marginTop:4},children:[v.jsx(ht,{value:"start",children:p.patternType==="row"?"Left":"Top"}),v.jsx(ht,{value:"center",children:"Center"}),v.jsx(ht,{value:"end",children:p.patternType==="row"?"Right":"Bottom"})]})]}),(()=>{let j=[];if(w.elementType==="stripes"&&w.stripeConfig)j=w.stripeConfig.colors.map((k,Y)=>({id:`stripe-${Y}`,label:w.stripeConfig.colors.length>1?`Color ${Y+1}`:"Color",defaultColor:k.color}));else if(w.elementType==="shape"&&w.shapeKey&&C[w.shapeKey]){const k=C[w.shapeKey],Y=St(w.shapeKey,k.defaultConfig||{}),W=Y.getColorsUsed?.()||[],X=new Set(W.map(J=>J.id));j=Object.entries(Y.colors).filter(([J])=>X.has(J)&&J!=="transparent").map(([J,te])=>({id:J,label:te.label,defaultColor:te.color}))}return j.length>0?v.jsxs("div",{style:{marginTop:12,paddingTop:8,borderTop:"1px solid #e8e8e8"},children:[v.jsx(Ie,{style:{fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:6},children:"Colors:"}),j.map(k=>v.jsxs("div",{style:{marginBottom:4,display:"grid",gridTemplateColumns:"1fr auto",alignItems:"center",gap:8},children:[v.jsx(Ie,{style:{fontSize:"10px"},children:k.label}),v.jsx(Qt,{value:w.colorMapping?.[k.id]||k.defaultColor,onChange:Y=>{const W=[...p.patternConfig.elements||[]];W[M]={...w,colorMapping:{...w.colorMapping||{},[k.id]:Y.toHexString()}},ie(p.id,{...p.patternConfig,elements:W})},showText:!1,size:"small"})]},k.id))]}):null})()]},M)),v.jsx(je,{size:"small",onClick:()=>{const w=[...p.patternConfig.elements||[],{elementType:"stripes",stripeConfig:p.patternType==="row"?{colors:[{color:"#ffffff",columns:2}]}:{colors:[{color:"#ffffff",rows:2}]}}];ie(p.id,{...p.patternConfig,elements:w})},children:"Add Element"})]})]}),v.jsxs("div",{children:[v.jsx(Ie,{style:Q,children:"Repeat:"}),v.jsxs(_t,{value:p.settings.repeatMode||"none",onChange:w=>L(p.id,"repeatMode",w),style:Z,size:"small",children:[v.jsx(ht,{value:"none",children:"Non-repeating"}),v.jsx(ht,{value:"x",children:"Repeat Horizontal"}),v.jsx(ht,{value:"y",children:"Repeat Vertical"}),v.jsx(ht,{value:"both",children:"Repeat Both Directions"})]})]}),(p.settings.repeatMode==="x"||p.settings.repeatMode==="both")&&v.jsxs("div",{children:[v.jsx(Ie,{style:Q,children:"Horizontal Repeats (0=infinity):"}),v.jsx(He,{value:p.settings.repeatCountX||0,onChange:w=>L(p.id,"repeatCountX",w||0),min:0,max:50,size:"small",style:Z,formatter:w=>w===0?"infinity":w,parser:w=>w==="infinity"?0:parseInt(w)||0})]}),(p.settings.repeatMode==="y"||p.settings.repeatMode==="both")&&v.jsxs("div",{children:[v.jsx(Ie,{style:Q,children:"Vertical Repeats (0=infinity):"}),v.jsx(He,{value:p.settings.repeatCountY||0,onChange:w=>L(p.id,"repeatCountY",w||0),min:0,max:50,size:"small",style:Z,formatter:w=>w===0?"infinity":w,parser:w=>w==="infinity"?0:parseInt(w)||0})]}),v.jsxs(qe,{gutter:4,children:[v.jsxs(De,{span:12,children:[v.jsx(Ie,{style:Q,children:"Horizontal Offset:"}),v.jsx(He,{value:p.settings.offsetHorizontal,onChange:w=>L(p.id,"offsetHorizontal",w||0),size:"small",style:Z})]}),v.jsxs(De,{span:12,children:[v.jsx(Ie,{style:Q,children:"Vertical Offset:"}),v.jsx(He,{value:p.settings.offsetVertical,onChange:w=>L(p.id,"offsetVertical",w||0),size:"small",style:Z})]})]}),v.jsxs("div",{children:[v.jsx(Ie,{style:Q,children:"Color Assignment:"}),v.jsx("div",{style:{marginTop:4},children:p.pattern&&p.pattern.colors&&(()=>{const w=p.pattern.getColorsUsed?.()||[],M=new Set(w.map(k=>k.id));return Object.entries(p.pattern.colors).filter(([k])=>w.length>0?M.has(k)&&k!=="transparent":k!=="transparent").map(([k,Y])=>v.jsxs("div",{style:{marginBottom:4,display:"grid",gridTemplateColumns:"1fr auto",alignItems:"center",gap:8},children:[v.jsx(Ie,{style:le,children:Y.label}),v.jsx(Qt,{value:p.settings.colorMapping?.[k]||Y.color,onChange:W=>ae(p.id,k,W),showText:!1,size:"small"})]},k))})()})]})]})}]})},p.id))})]})})})]})]})};function mn(t=[{color:"#ffffff"}]){const e={};return t.forEach((n,r)=>{e[r]={id:r,label:`Color ${r+1}`,color:n.color}}),new Ze(0,0,[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],e,{width:4,height:4})}function Dd(t=2,e=[{color:"#ffffff"},{color:"#000000"}]){const n=t*2,r=[];for(let i=0;i<n;i++){const a=[];for(let s=0;s<n;s++){const l=Math.floor(i/t),c=Math.floor(s/t),d=(l+c)%2;a.push(d)}r.push(a)}const o={};return e.forEach((i,a)=>{o[a]={id:a,label:`Color ${a+1}`,color:i.color}}),new Ze(0,0,r,o,{width:n,height:n})}function Nd(t=[{color:"#ffffff"},{color:"#ff0000"},{color:"#0000ff"}]){const e={};return t.forEach((n,r)=>{e[r]={id:r,label:`Color ${r+1}`,color:n.color}}),new Ze(0,0,[[0,0,1,1,1,1,0,0],[0,1,1,2,2,1,1,0],[1,1,2,2,2,2,1,1],[1,2,2,0,0,2,2,1],[1,2,2,0,0,2,2,1],[1,1,2,2,2,2,1,1],[0,1,1,2,2,1,1,0],[0,0,1,1,1,1,0,0]],e,{width:8,height:8})}function St(t,e,n=null){if(console.log("🎯 generatePattern called:",{type:t,hasConfig:!!e,configKeys:e?Object.keys(e):[]}),t==="stripes"){const{colors:r}=e;let o;const i=r.filter(f=>f.rows===0),a=r.reduce((f,m)=>f+(m.rows||0),0);i.length>0&&n?o=n:i.length>0&&!n?o=Math.max(a*2,20):o=Math.max(a,1);const s=e.width||4,l=[];let c=0,d=0;if(r.length>=2&&r[0].rows===0&&r[r.length-1].rows===0){const f=o-a,m=Math.floor(f/2),b=f%2;r.forEach((g,y)=>{if(y===0){const x=m+b;for(let C=0;C<x;C++)l.push(new Array(s).fill(y))}else if(y===r.length-1){const x=m;for(let C=0;C<x;C++)l.push(new Array(s).fill(y))}else for(let x=0;x<g.rows;x++)l.push(new Array(s).fill(y))})}else if(r.every(f=>f.rows===0)){const f=Math.floor(o/r.length);let m=o-f*r.length;r.forEach((b,g)=>{let y=f+(g<m?1:0);for(let x=0;x<y;x++)l.push(new Array(s).fill(g))})}else{const f=Math.max(0,o-a);r.forEach((m,b)=>{if(m.rows===0)if(b===0){const g=f;for(let y=0;y<g&&c<o;y++)l.push(new Array(s).fill(d)),c++}else if(b===r.length-1){const g=o-c;for(let y=0;y<g;y++)l.push(new Array(s).fill(d)),c++}else{const g=i.length>1?Math.floor(f/i.length):f;for(let y=0;y<g&&c<o;y++)l.push(new Array(s).fill(d)),c++}else for(let g=0;g<m.rows&&c<o;g++)l.push(new Array(s).fill(d)),c++;d++})}for(;l.length<o;){const f=o-l.length,m=l.slice(0,Math.min(l.length,f));l.push(...m)}const u={};return r.forEach((f,m)=>{u[m]={id:m,label:`Color ${m+1}`,color:f.color}}),new Ze(0,0,l,u,{width:s,height:o})}else if(t==="vstripes"){const{colors:r}=e;let o;const i=r.filter(m=>m.columns===0),a=r.reduce((m,b)=>m+(b.columns||0),0);i.length>0&&n?o=n:i.length>0&&!n?o=Math.max(a*2,20):o=Math.max(a,1);const s=e.height||4,l=Array(s).fill().map(()=>[]);let c=0,d=0;const u=Math.max(0,o-a);if(r.length>=2&&r[0].columns===0&&r[r.length-1].columns===0){const m=o-a,b=Math.floor(m/2),g=m%2;r.forEach((y,x)=>{if(x===0){const C=b+g;for(let S=0;S<C;S++)for(let R=0;R<s;R++)l[R].push(x)}else if(x===r.length-1){const C=b;for(let S=0;S<C;S++)for(let R=0;R<s;R++)l[R].push(x)}else for(let C=0;C<y.columns;C++)for(let S=0;S<s;S++)l[S].push(x)})}else if(r.every(m=>m.columns===0)){const m=Math.floor(o/r.length);let b=o-m*r.length;r.forEach((g,y)=>{let x=m+(y<b?1:0);for(let C=0;C<x;C++)for(let S=0;S<s;S++)l[S].push(y)})}else r.forEach((m,b)=>{if(m.columns===0)if(b===0){const g=u;for(let y=0;y<g&&c<o;y++){for(let x=0;x<s;x++)l[x].push(d);c++}}else if(b===r.length-1){const g=o-c;for(let y=0;y<g;y++){for(let x=0;x<s;x++)l[x].push(d);c++}}else{const g=i.length>1?Math.floor(u/i.length):u;for(let y=0;y<g&&c<o;y++){for(let x=0;x<s;x++)l[x].push(d);c++}}else for(let g=0;g<m.columns&&c<o;g++){for(let y=0;y<s;y++)l[y].push(d);c++}d++});for(;l[0].length<o;){const m=o-l[0].length;for(let b=0;b<s;b++){const g=l[b].slice(0,Math.min(l[b].length,m));l[b].push(...g)}}const f={};return r.forEach((m,b)=>{f[b]={id:b,label:`Color ${b+1}`,color:m.color}}),new Ze(0,0,l,f,{width:o,height:s})}else if(t==="custom"||typeof t=="string"&&t.startsWith("custom-")){if(e.pattern&&Array.isArray(e.pattern)){const r={},o=e.colors||{};return Object.entries(o).forEach(([i,a])=>{i==="CCX"?r[i]={id:i,label:"Transparent",color:"transparent"}:typeof a=="string"?r[i]={id:i,label:i,color:a}:a&&typeof a=="object"&&a.color?r[i]=a:r[i]={id:i,label:i,color:"#ffffff"}}),new Ze(0,0,e.pattern,r,{})}return mn([{color:"#ffffff"}])}else{if(t==="solid")return mn(e.colors||[{color:"#ffffff"}]);if(t==="checkerboard")return Dd(e.cellSize||2,e.colors||[{color:"#ffffff"},{color:"#000000"}]);if(t==="argyle")return Nd(e.colors||[{color:"#ffffff"},{color:"#ff0000"},{color:"#0000ff"}]);if(t==="row")return kr(e.elements||[],e.patterns||{});if(t==="vstack")return zd(e.elements||[],e.patterns||{})}return mn([{color:"#ffffff"}])}function kr(t=[],e={}){if(console.log("🎨 createRowPattern called:",t),!t||t.length===0)return mn([{color:"#ffffff"}]);const n={};let r=0;const o=[];t.forEach((l,c)=>{if(l.elementType==="stripes"&&l.stripeConfig){const d=l.stripeConfig.colors||[],u={};d.forEach((f,m)=>{const b=`c${r}`,g=d.length>1?`Stripes-${c+1} C${m+1}`:`Stripes-${c+1}`;n[b]={id:b,label:g,color:f.color||"#ffffff"},u[m]=b,r++}),o.push({type:"stripes",width:d.reduce((f,m)=>f+(m.columns||1),0),colorMapping:u,stripeConfig:l.stripeConfig})}else if(l.elementType==="shape"&&l.shapeKey&&e[l.shapeKey]){const d=e[l.shapeKey],u=d.name||"Shape",f=St(l.shapeKey,d.defaultConfig||{}),m=l.repeatCount||1,b={};Object.entries(f.colors).forEach(([g,y])=>{const x=`c${r}`;n[x]={id:x,label:`${u} ${y.label}`,color:y.color},b[g]=x,r++}),o.push({type:"shape",pattern:f,repeatCount:m,colorMapping:b,width:f.getStitchCount()*m})}});const i=Math.max(...o.map(l=>l.type==="shape"&&l.pattern?l.pattern.getRowCount():10))||10,a=o.reduce((l,c)=>l+(c.width||4),0),s=[];for(let l=0;l<i;l++){const c=[];o.forEach(d=>{if(d.type==="stripes")d.stripeConfig.colors.forEach((u,f)=>{const m=d.colorMapping[f],b=u.columns||1;for(let g=0;g<b;g++)c.push(m)});else if(d.type==="shape"&&d.pattern){const u=d.pattern.getRowCount(),f=d.pattern.getStitchCount(),m=f*d.repeatCount;for(let b=0;b<m;b++){const g=l%u,y=b%f,x=d.pattern.grid[g][y],C=d.colorMapping[x];c.push(C)}}}),s.push(c)}return new Ze(0,0,s,n,{width:a,height:i})}function zd(t=[],e={}){if(console.log("🎨 createVStackPattern called:",t),!t||t.length===0)return mn([{color:"#ffffff"}]);const n={};let r=0;const o=[];t.forEach((u,f)=>{if(u.elementType==="stripes"&&u.stripeConfig){const m=u.stripeConfig.colors||[],b={};m.forEach((g,y)=>{const x=`c${r}`,C=m.length>1?`Stripes-${f+1} C${y+1}`:`Stripes-${f+1}`,S=u.colorMapping&&u.colorMapping[`stripe-${y}`]?u.colorMapping[`stripe-${y}`]:g.color||"#ffffff";n[x]={id:x,label:C,color:S},b[y]=x,r++}),o.push({type:"stripes",height:m.reduce((g,y)=>g+(y.rows||1),0),colorMapping:b,stripeConfig:u.stripeConfig})}else if(u.elementType==="row"&&u.elements){const m=kr(u.elements,e),b=u.repeatCount||1,g={};Object.entries(m.colors).forEach(([y,x])=>{const C=`c${r}`;n[C]={id:C,label:`Row-${f+1} ${x.label}`,color:x.color},g[y]=C,r++}),o.push({type:"row",pattern:m,repeatCount:b,colorMapping:g,height:m.getRowCount()*b})}else if(u.elementType==="shape"&&u.shapeKey&&e[u.shapeKey]){const m=e[u.shapeKey];m.name,St(u.shapeKey,m.defaultConfig||{});const b=u.repeatCount||1,g=[{elementType:"shape",shapeKey:u.shapeKey,repeatCount:b}],y=kr(g,e),x={};Object.entries(y.colors).forEach(([C,S])=>{const R=`c${r}`,P=u.colorMapping&&u.colorMapping[C]?u.colorMapping[C]:S.color;n[R]={id:R,label:S.label,color:P},x[C]=R,r++}),o.push({type:"implicit-row",pattern:y,colorMapping:x,height:y.getRowCount()})}});const i=(u,f)=>f===0?u:i(f,u%f),a=(u,f)=>u*f/i(u,f),s=o.map(u=>u.type==="row"&&u.pattern||u.type==="implicit-row"&&u.pattern?u.pattern.getStitchCount():1);let l=s.reduce((u,f)=>a(u,f),1);l>500&&(l=Math.max(...s)),l=Math.max(l,10);const c=o.reduce((u,f)=>u+(f.height||4),0),d=[];return o.forEach(u=>{if(u.type==="stripes")u.stripeConfig.colors.forEach((f,m)=>{const b=u.colorMapping[m],g=f.rows||1;for(let y=0;y<g;y++){const x=Array(l).fill(b);d.push(x)}});else if(u.type==="row"&&u.pattern){const f=u.pattern.getStitchCount();for(let m=0;m<u.repeatCount;m++)for(let b=0;b<u.pattern.getRowCount();b++){const g=[];for(let y=0;y<l;y++){const x=y%f,C=u.pattern.grid[b][x],S=u.colorMapping[C];g.push(S)}d.push(g)}}else if(u.type==="implicit-row"&&u.pattern){const f=u.pattern.getStitchCount();for(let m=0;m<u.pattern.getRowCount();m++){const b=[];for(let g=0;g<l;g++){const y=g%f,x=u.pattern.grid[m][y],C=u.colorMapping[x];b.push(C)}d.push(b)}}}),new Ze(0,0,d,n,{width:l,height:c})}const{Text:Ct,Title:Ld}=yn,_d=({stitchPlan:t,currentRow:e=0})=>{if(!t||!t.rows||t.rows.length===0)return v.jsx("div",{className:"row-by-row-instructions",children:v.jsx(Ct,{type:"secondary",children:"No instructions available"})});const n=t.generateKnittingInstructions();return v.jsx("div",{className:"row-by-row-instructions",children:n.map((r,o)=>{const i=o===e,a=o<e,s=t.rows[o];return v.jsxs(ut,{size:"small",style:{marginBottom:8,backgroundColor:i?"#e6f7ff":a?"#f6ffed":"white",border:i?"2px solid #1890ff":"1px solid #d9d9d9"},children:[v.jsx(qe,{children:v.jsx(De,{span:24,children:v.jsxs(Ld,{level:5,children:["Row ",o+1,s&&s.rowNumber&&s.rowNumber!==o+1&&` (RC: ${s.rowNumber})`]})})}),typeof r=="string"&&v.jsx(qe,{style:{marginBottom:8},children:v.jsxs(De,{span:24,children:[v.jsx(Ct,{strong:!0,children:"Shaping: "}),v.jsx(Ct,{children:r})]})}),r.hasShaping&&r.hasShaping()&&v.jsx(qe,{style:{marginBottom:8},children:v.jsxs(De,{span:24,children:[v.jsx(Ct,{strong:!0,children:"Shaping: "}),v.jsx(Ct,{children:r.shaping.description})]})}),s&&s.getColorworkInstructions&&s.getColorworkInstructions()&&v.jsxs(v.Fragment,{children:[v.jsx(qe,{style:{marginBottom:8},children:v.jsxs(De,{span:24,children:[v.jsx(Ct,{strong:!0,children:"Colorwork: "}),v.jsx(Ye,{wrap:!0,children:s.getColorworkInstructions().map((l,c)=>v.jsxs(Gn,{style:{backgroundColor:l.colorHex,color:Wd(l.colorHex),fontWeight:"bold",border:"1px solid #d9d9d9"},children:[l.stitchCount," ",l.colorLabel]},c))})]})}),v.jsx(qe,{style:{marginTop:8},children:v.jsx(De,{span:24,children:v.jsx(Hd,{colorworkInstructions:s.getColorworkInstructions(),totalStitches:s.leftStitchesInWork+s.rightStitchesInWork})})})]}),r.hasColorwork&&r.hasColorwork()&&v.jsxs(v.Fragment,{children:[v.jsx(qe,{style:{marginBottom:8},children:v.jsxs(De,{span:24,children:[v.jsx(Ct,{strong:!0,children:"Colorwork: "}),v.jsx(Ct,{children:r.colorwork.description})]})}),v.jsx(qe,{children:v.jsx(De,{span:24,children:v.jsx(Ye,{wrap:!0,children:r.colorwork.colorSequence.map((l,c)=>v.jsxs(Gn,{color:r.colorwork.pattern?.colors[l.colorId]?.color,style:{color:"black",fontWeight:"bold",border:"1px solid #d9d9d9"},children:[l.stitchCount," ",l.colorId]},c))})})}),r.visualChart&&v.jsx(qe,{style:{marginTop:8},children:v.jsx(De,{span:24,children:v.jsx("div",{dangerouslySetInnerHTML:{__html:r.visualChart.svg},style:{maxWidth:"100%",overflow:"auto",border:"1px solid #f0f0f0",borderRadius:"4px",padding:"4px"}})})})]}),s&&v.jsx(qe,{style:{marginTop:8},children:v.jsx(De,{span:24,children:v.jsxs(Ct,{type:"secondary",style:{fontSize:"12px"},children:[s.leftStitchesInWork+s.rightStitchesInWork," stitches (",s.leftStitchesInWork," left, ",s.rightStitchesInWork," right)"]})})})]},o)})})},Hd=({colorworkInstructions:t,totalStitches:e})=>{if(!t||t.length===0)return null;const n=Math.max(8,Math.min(20,400/e)),r=e*n,o=20;let i=0;const a=t.map((s,l)=>{const c=s.stitchCount*n,d=v.jsx("rect",{x:i,y:0,width:c,height:o,fill:s.colorHex,stroke:"#000",strokeWidth:"0.5"},l);return i+=c,d});return v.jsxs("div",{style:{marginTop:4},children:[v.jsx(Ct,{strong:!0,style:{fontSize:"11px"},children:"Visual Pattern:"}),v.jsx("div",{style:{marginTop:2},children:v.jsx("svg",{width:r,height:o,style:{border:"1px solid #ddd",borderRadius:"2px"},children:a})})]})},Wd=t=>{const e=t.replace("#",""),n=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2,2),16),o=parseInt(e.substr(4,2),16);return(.299*n+.587*r+.114*o)/255>.5?"#000000":"#ffffff"};class Fd{constructor(){this.composer=new es,this.instructionGenerator=new ts}createColorworkStitchPlan(e,n,r={}){return this.composer.combinePatterns(e,n,r).stitchPlan}generateCombinedInstructions(e,n,r={}){const o=this.composer.combinePatterns(e,n,r);return this.instructionGenerator.generateCombinedInstructions(o)}createBasicStitchPlan(e){if(!e.shape)return{rows:[]};const n=e.gauge,r=e.sizeModifier;return e.shape.getStitchPlan(n,r,1)}}const{Title:Xd,Text:wt}=yn,Yd=({combinedPattern:t,instructions:e=[],knittingProgress:n,onRowComplete:r,onBackToSettings:o})=>{const[i,a]=h.useState(null),[s,l]=h.useState(null);h.useEffect(()=>{if(t)if(t.stitchPlan&&t.stitchPlan.hasColorwork())a(t.stitchPlan);else{const f=new Fd,m=t.panel,b=t.colorworkPattern;try{const g=f.createColorworkStitchPlan(m,b);a(g)}catch(g){console.error("Error creating enhanced stitch plan:",g)}}},[t]),h.useEffect(()=>{if(i&&i.rows[n.currentRow]){const f=i.rows[n.currentRow];l(f)}},[i,n.currentRow]);const c=()=>{n.currentRow>0},d=()=>{n.currentRow<e.length-1&&r(n.currentRow)},u=Math.round(n.completedRows.length/e.length*100);return v.jsxs("div",{className:"interactive-knitting-view",style:{padding:"24px",background:"#f5f5f5",minHeight:"100vh"},children:[v.jsx("div",{className:"knitting-header",style:{marginBottom:"24px"},children:v.jsxs(qe,{justify:"space-between",align:"middle",children:[v.jsx(De,{children:v.jsx(je,{onClick:o,icon:v.jsx(Zr,{}),children:"Back to Settings"})}),v.jsxs(De,{children:[v.jsx(Xd,{level:2,style:{margin:0,textAlign:"center"},children:"Interactive Knitting"}),v.jsxs(wt,{type:"secondary",style:{display:"block",textAlign:"center"},children:["Row ",n.currentRow+1," of ",e.length]})]}),v.jsx(De,{children:v.jsx(Po,{type:"circle",percent:u,size:60,strokeColor:"#52c41a"})})]})}),v.jsxs(qe,{gutter:[24,24],children:[v.jsx(De,{xs:24,lg:8,children:v.jsxs(Ye,{direction:"vertical",style:{width:"100%"},size:"large",children:[v.jsx(ut,{title:`Row ${n.currentRow+1}`,extra:v.jsx(Gn,{color:n.completedRows.includes(n.currentRow)?"green":"blue",children:n.completedRows.includes(n.currentRow)?"Complete":"In Progress"}),children:s&&v.jsxs(Ye,{direction:"vertical",style:{width:"100%"},children:[v.jsxs("div",{children:[v.jsx(wt,{strong:!0,children:"Shaping:"}),v.jsx("div",{style:{marginTop:8,padding:12,background:"#f0f8ff",borderRadius:6},children:v.jsxs(wt,{children:[s.leftStitchesInWork+s.rightStitchesInWork," stitches total (",s.leftStitchesInWork," left, ",s.rightStitchesInWork," right)"]})})]}),s.getColorworkInstructions&&s.getColorworkInstructions()&&v.jsxs("div",{children:[v.jsx(wt,{strong:!0,children:"Colorwork:"}),v.jsxs("div",{style:{marginTop:8},children:[v.jsx(Ye,{wrap:!0,children:s.getColorworkInstructions().map((f,m)=>v.jsxs(Gn,{style:{backgroundColor:f.colorHex,color:Vd(f.colorHex),fontWeight:"bold",border:"1px solid #d9d9d9",fontSize:"14px",padding:"6px 12px"},children:[f.stitchCount," ",f.colorLabel]},m))}),v.jsxs("div",{style:{marginTop:12},children:[v.jsx(wt,{strong:!0,style:{fontSize:"12px"},children:"Pattern:"}),v.jsx(Gd,{colorworkInstructions:s.getColorworkInstructions(),totalStitches:s.leftStitchesInWork+s.rightStitchesInWork})]})]})]}),v.jsx(_r,{}),v.jsxs(qe,{gutter:[8,8],children:[v.jsx(De,{span:8,children:v.jsx(je,{icon:v.jsx(Zr,{}),onClick:c,disabled:n.currentRow===0,block:!0,size:"small",children:"Prev"})}),v.jsx(De,{span:8,children:v.jsx(je,{type:"primary",icon:v.jsx(Ei,{}),onClick:d,disabled:n.currentRow>=e.length-1,block:!0,children:"Done"})}),v.jsx(De,{span:8,children:v.jsx(je,{icon:v.jsx(Js,{}),onClick:d,disabled:n.currentRow>=e.length-1,block:!0,size:"small",children:"Next"})})]})]})}),v.jsx(ut,{title:"Progress Overview",size:"small",children:v.jsxs(Ye,{direction:"vertical",style:{width:"100%"},children:[v.jsxs("div",{children:[v.jsxs(wt,{children:["Completed Rows: ",n.completedRows.length]}),v.jsx(Po,{percent:u,showInfo:!1,strokeColor:"#52c41a"})]}),v.jsx("div",{children:v.jsxs(wt,{type:"secondary",style:{fontSize:"12px"},children:["Remaining: ",e.length-n.completedRows.length," rows"]})})]})})]})}),v.jsx(De,{xs:24,lg:16,children:v.jsxs(Ye,{direction:"vertical",style:{width:"100%"},size:"large",children:[v.jsx(ut,{title:"Panel with Current Row Highlighted",children:v.jsx("div",{style:{background:"white",padding:"20px",borderRadius:"8px",textAlign:"center"},children:v.jsx(Kd,{combinedPattern:t,currentRow:n.currentRow,completedRows:n.completedRows})})}),v.jsx(ut,{title:"All Instructions",children:i&&v.jsx(_d,{stitchPlan:i,currentRow:n.currentRow})})]})})]})]})},Gd=({colorworkInstructions:t,totalStitches:e})=>{if(!t||t.length===0)return null;const n=Math.max(2,Math.min(8,300/e)),r=e*n,o=20;let i=0;const a=t.map((s,l)=>{const c=s.stitchCount*n,d=v.jsx("rect",{x:i,y:0,width:c,height:o,fill:s.colorHex,stroke:"#666",strokeWidth:"0.5"},l);return i+=c,d});return v.jsx("div",{style:{marginTop:8},children:v.jsx("svg",{width:r,height:o,style:{border:"1px solid #ddd",borderRadius:"4px",display:"block"},children:a})})},Kd=({combinedPattern:t,currentRow:e,completedRows:n})=>{if(!t||!t.stitchPlan)return v.jsx(wt,{type:"secondary",children:"Panel visualization unavailable"});const r=t.stitchPlan.rows,o=Math.max(...r.map(i=>i.leftStitchesInWork+i.rightStitchesInWork));return v.jsxs("div",{style:{maxWidth:"400px",margin:"0 auto"},children:[v.jsxs(wt,{strong:!0,style:{fontSize:"12px"},children:["Panel Shape (Row ",e+1," highlighted)"]}),v.jsx("div",{style:{marginTop:8},children:r.map((i,a)=>{const s=i.leftStitchesInWork+i.rightStitchesInWork,l=s/o*100;let c="#f0f0f0";return n.includes(a)?c="#52c41a":a===e&&(c="#1890ff"),v.jsx("div",{style:{width:`${l}%`,height:"6px",backgroundColor:c,margin:"1px auto",borderRadius:"3px",border:a===e?"2px solid #1890ff":"none"},title:`Row ${a+1}: ${s} stitches`},a)})}),v.jsx("div",{style:{marginTop:8,fontSize:"10px"},children:v.jsxs(Ye,{children:[v.jsx("span",{style:{color:"#52c41a"},children:"● Completed"}),v.jsx("span",{style:{color:"#1890ff"},children:"● Current"}),v.jsx("span",{style:{color:"#f0f0f0"},children:"● Remaining"})]})})]})},Vd=t=>{const e=t.replace("#",""),n=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2,2),16),o=parseInt(e.substr(4,2),16);return(.299*n+.587*r+.114*o)/255>.5?"#000000":"#ffffff"},qd=(t,e,n,r=0,o=0,i,a=[],s=null,l=null)=>{const c=[];if(fs(e,n,r,o,c),c.length===0)return;let d=Math.min(...c.map(g=>Math.min(g.topLeft.x,g.topRight.x,g.bottomLeft.x,g.bottomRight.x))),u=Math.max(...c.map(g=>Math.max(g.topLeft.x,g.topRight.x,g.bottomLeft.x,g.bottomRight.x))),f=Math.min(...c.map(g=>Math.min(g.topLeft.y,g.topRight.y,g.bottomLeft.y,g.bottomRight.y))),m=Math.max(...c.map(g=>Math.max(g.topLeft.y,g.topRight.y,g.bottomLeft.y,g.bottomRight.y)));t.save(),t.beginPath(),c.forEach((g,y)=>{t.moveTo(g.topLeft.x,g.topLeft.y),t.lineTo(g.topRight.x,g.topRight.y),t.lineTo(g.bottomRight.x,g.bottomRight.y),t.lineTo(g.bottomLeft.x,g.bottomLeft.y),t.closePath()}),t.clip();const b=a?a.filter(g=>!g.pattern?.metadata?.isBorderPattern):[];if(b.length>0&&s?Ud(t,b,e,d,f,u-d,m-f,n,s):(t.fillStyle=i,t.globalAlpha=.3,t.fillRect(d,f,u-d,m-f),t.globalAlpha=1),t.restore(),t.strokeStyle="#a1a8af",t.lineWidth=3,t.lineJoin="round",c.forEach(g=>{t.beginPath(),t.moveTo(g.topLeft.x,g.topLeft.y),t.lineTo(g.topRight.x,g.topRight.y),t.lineTo(g.bottomRight.x,g.bottomRight.y),t.lineTo(g.bottomLeft.x,g.bottomLeft.y),t.closePath(),t.stroke()}),l&&l.color&&l.thickness&&s){const g=(u-d)/n,y=(m-f)/n,x=s.stitchesPerFourInches/4,C=s.rowsPerFourInches/4,S=s.scalingFactor||1,R=Math.round(g*S*x),P=Math.round(y*S*C),E=(u-d)/R,D=(m-f)/P,T=l.thickness,A=c.map(I=>[[[I.topLeft.x,I.topLeft.y],[I.topRight.x,I.topRight.y],[I.bottomRight.x,I.bottomRight.y],[I.bottomLeft.x,I.bottomLeft.y],[I.topLeft.x,I.topLeft.y]]]),$=ds.union(...A);t.save(),t.fillStyle=l.color,$.forEach(I=>{I.forEach(O=>{if(O.length<3)return;const z=[];for(let N=0;N<O.length-1;N++){const K=O[(N-1+O.length-1)%(O.length-1)],H=O[N],q=O[N+1],oe=H[0]-K[0],L=H[1]-K[1],ae=Math.sqrt(oe*oe+L*L),be=q[0]-H[0],fe=q[1]-H[1],se=Math.sqrt(be*be+fe*fe);if(ae<.001||se<.001)continue;const Q=oe/ae,le=L/ae,Z=be/se,ne=fe/se,ce=-le,Ce=Q,$e=-ne,he=Z,xe=Math.atan2(le,Q),Re=Math.atan2(ne,Z),ye=T*Math.sqrt(Math.pow(Math.abs(Math.sin(xe))*E,2)+Math.pow(Math.abs(Math.cos(xe))*D,2)),ie=T*Math.sqrt(Math.pow(Math.abs(Math.sin(Re))*E,2)+Math.pow(Math.abs(Math.cos(Re))*D,2)),p=(ce+$e)/2,B=(Ce+he)/2,w=Math.sqrt(p*p+B*B);if(w<.001)continue;const M=p/w,j=B/w,k=Q*Z+le*ne,Y=Math.acos(Math.max(-1,Math.min(1,k)))/2,W=Math.sin(Y);if(Math.abs(W)<.1){const X=(ye+ie)/2;z.push([H[0]+M*X,H[1]+j*X])}else{const J=(ye+ie)/2/W;z.push([H[0]+M*J,H[1]+j*J])}}if(z.length>=3){t.beginPath(),t.moveTo(O[0][0],O[0][1]);for(let N=1;N<O.length;N++)t.lineTo(O[N][0],O[N][1]);t.moveTo(z[z.length-1][0],z[z.length-1][1]);for(let N=z.length-2;N>=0;N--)t.lineTo(z[N][0],z[N][1]);t.closePath(),t.fill("evenodd")}})}),t.restore()}},fs=(t,e,n=0,r=0,o=[])=>{const i=Math.max(t.baseA,t.baseB)*e,a=n+(i-t.baseB*e)/2+(t.baseBHorizontalOffset||0)*e,s=n+(i+t.baseB*e)/2+(t.baseBHorizontalOffset||0)*e,l=n+(i-t.baseA*e)/2,c=n+(i+t.baseA*e)/2,d=r,u=r+t.height*e;if(o.push({topLeft:{x:a,y:d},topRight:{x:s,y:d},bottomLeft:{x:l,y:u},bottomRight:{x:c,y:u}}),t.successors&&t.successors.length>0){const f=t.successors.map(g=>Math.max(g.baseA,g.baseB)*e),m=f.reduce((g,y)=>g+y,0);let b=n+(i-m)/2;for(let g=t.successors.length-1;g>=0;g--){const y=t.successors[g],x=f[g];fs(y,e,b,d-y.height*e,o),b+=x}}},Ud=(t,e,n,r,o,i,a,s,l)=>{const c=Math.max(n.baseA,n.baseB),d=n.height,u=l.stitchesPerFourInches/4,f=l.rowsPerFourInches/4,m=Math.round(c*u),b=Math.round(d*f),g=i/m,y=a/b,x=Jd(m,b,e);for(let C=0;C<b;C++)for(let S=0;S<m;S++){const R=r+S*g,P=o+C*y,E=x[C]&&x[C][S];E&&E!=="transparent"&&(t.fillStyle=E,t.fillRect(R,P,g,y))}},Jd=(t,e,n)=>{const r=Array(e).fill().map(()=>Array(t).fill("transparent"));return n.sort((o,i)=>o.priority-i.priority).forEach(o=>{Zd(r,t,e,o)}),r},Zd=(t,e,n,r)=>{const{pattern:o,settings:i}=r;if(!o||!o.grid||o.grid.length===0)return;if(o.metadata?.isBorderPattern){const S=o.metadata.borderThickness||1,P=o.colors[1];if(P){const E=P.color;for(let D=0;D<n;D++)for(let T=0;T<e;T++){const A=D<S,$=D>=n-S,I=T<S,O=T>=e-S;(A||$||I||O)&&E&&E!=="transparent"&&(t[D][T]=E)}}return}const a=o.getRowCount(),s=o.getStitchCount();if(a===0||s===0)return;const{repeatMode:l="both",repeatCountX:c=0,repeatCountY:d=0,repeatHorizontal:u=!0,repeatVertical:f=!0,offsetHorizontal:m=0,offsetVertical:b=0}=i,g=l?l==="x"||l==="both":u,y=l?l==="y"||l==="both":f,x=Math.floor((e-s)/2),C=Math.floor((n-a)/2);for(let S=0;S<n;S++)for(let R=0;R<e;R++){const P=R-x-m,E=S-C-b;let D=0,T=0;if(g&&s>0&&(D=Math.floor(P/s)),y&&a>0&&(T=Math.floor(E/a)),g&&c&&c>0&&Math.abs(D)>=c||y&&d&&d>0&&Math.abs(T)>=d||!g&&(P<0||P>=s)||!y&&(E<0||E>=a))continue;let A,$;if(g)A=(P%s+s)%s;else if(A=P,A<0||A>=s)continue;if(y)$=(E%a+a)%a;else if($=E,$<0||$>=a)continue;const I=o.grid[$][A],O=o.colors[I];O&&O.color&&(t[S][R]=O.color)}},ii=(t,e,n,r=0,o=0,i={minX:0,maxX:0,minY:0,maxY:0},a,s=[],l=null,c=null)=>{hs(e,n,r,o,i),qd(t,e,n,r,o,a,s,l,c)},hs=(t,e,n=0,r=0,o={minX:0,maxX:0,minY:0,maxY:0})=>{const i=Math.max(t.baseA,t.baseB)*e,a=n+(i-t.baseB*e)/2+(t.baseBHorizontalOffset||0)*e,s=n+(i+t.baseB*e)/2+(t.baseBHorizontalOffset||0)*e,l=n+(i-t.baseA*e)/2,c=n+(i+t.baseA*e)/2,d=r,u=r+t.height*e;if(o.minX=Math.min(o.minX,a,s,l,c),o.maxX=Math.max(o.maxX,a,s,l,c),o.minY=Math.min(o.minY,d,u),o.maxY=Math.max(o.maxY,d,u),t.successors&&t.successors.length>0){const f=t.successors.map(g=>Math.max(g.baseA,g.baseB)*e),m=f.reduce((g,y)=>g+y,0);let b=n+(i-m)/2;for(let g=t.successors.length-1;g>=0;g--){const y=t.successors[g],x=f[g];hs(y,e,b,d-y.height*e,o),b+=x}}},Qd=({shape:t,patternLayers:e=[],gauge:n=null,label:r="",size:o=200,padding:i=10,showPatterns:a=!0})=>{const{token:s}=Mi.useToken(),l=s.colorPrimary,c=h.useRef(null);return h.useEffect(()=>{const d=c.current;if(!d||!t)return;const u=d.getContext("2d"),f=window.devicePixelRatio||1;d.width=o*f,d.height=o*f,d.style.width=`${o}px`,d.style.height=`${o}px`,u.scale(f,f),u.clearRect(0,0,o,o);let m=null;const b=e.find(I=>I.pattern?.metadata?.isBorderPattern);if(b){const O=b.pattern.colors[1],z=b.pattern.metadata.borderThickness||1;m={color:b.settings.colorMapping?.[1]||O?.color||"#000000",thickness:z}}let g={minX:0,maxX:0,minY:0,maxY:0};const x=document.createElement("canvas").getContext("2d");ii(x,t,1,0,0,g,l,e,n,m);const C=g.maxX-g.minX,S=g.maxY-g.minY,R=o-2*i,P=o-2*i,E=Math.min(R/C,P/S),D=C*E,T=S*E,A=(o-D)/2-g.minX*E+i,$=(o-T)/2-g.minY*E+i;u.save(),u.translate(A,$),g={minX:0,maxX:0,minY:0,maxY:0},ii(u,t,E,0,0,g,l,a?e:[],n,m),u.restore()},[t,e,n,o,i,a,l]),v.jsxs("div",{style:{width:o+i*2,height:o+i*3,float:"left"},children:[v.jsx("canvas",{ref:c,style:{border:"1px solid #d9d9d9",borderRadius:"6px",backgroundColor:"#fafafa"}}),r&&v.jsx("div",{style:{textAlign:"center",marginTop:4,fontSize:"12px"},children:r})]})},{Text:vr}=yn,mf=h.forwardRef((t,e)=>{const{initialPanel:n=null,initialColorwork:r=null,project:o=null,previewKey:i=null,allSelectedPanelKeys:a=[],stage:s,onStageChange:l,getPanelLabel:c,onRequestPreviewKeyChange:d}=t,u=Zs(),[f,m]=h.useState([]),b=h.useRef(null),g=h.useRef(null),y=h.useRef(i??null),[x,C]=h.useState("settings"),S=s??x,[R,P]=h.useState({currentRow:0,completedRows:[],currentSection:0}),[E,D]=h.useState(()=>({shape:si(o?.panelShape||n?.shape)||ai(),gauge:n?.gauge||new Xr(19,30),sizeModifier:n?.sizeModifier||1})),T=h.useMemo(()=>r||ef(),[r]),A=Cr(M=>M?.colorworkGrid?.colors),$=h.useMemo(()=>{const M=A?Object.values(A):null;return M&&M.length>0?M.map(j=>j.color):["#eae7c7"]},[A]),I=h.useMemo(()=>i?a.findIndex(M=>M===i):-1,[i,a]),O=I>-1&&I<a.length-1,z=O?a[I+1]:null,N=h.useMemo(()=>i?c&&c(i)||i:"",[i,c]),K=I>=0?I+1:0,H=h.useMemo(()=>{if(!E.gauge)return null;const M=E.gauge;return{stitchesPerFourInches:typeof M?.stitchesPerFourInches=="number"?M.stitchesPerFourInches:E.gauge.getStitchesPerInch()*4,rowsPerFourInches:typeof M?.rowsPerFourInches=="number"?M.rowsPerFourInches:E.gauge.getRowsPerInch()*4,scalingFactor:typeof M?.scalingFactor=="number"?M.scalingFactor:1}},[E.gauge]),q=Cr(M=>i?M?.knittingDesign?.patternData?.panels?.patternLayers?.[i]:null),oe=()=>[{id:1,name:"Base Pattern",pattern:new Ze(0,0,[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],{0:{id:0,label:"Color 1",color:"#eae7c7"}},{width:4,height:4}),patternType:"solid",patternConfig:{colors:[{color:"#eae7c7"}]},priority:1,settings:{repeatMode:"both",repeatCountX:0,repeatCountY:0,offsetHorizontal:0,offsetVertical:0,colorMapping:{}}}],[L,ae]=h.useState(()=>q||oe()),be=M=>{ae(j=>{const k=typeof M=="function"?M(j):M;return i&&u(Qs({panelKey:i,layers:k})),k})};h.useEffect(()=>{if(!i){y.current=null;return}if(q)ae(q),b.current=fn(q),g.current=null;else if(i!==y.current){const M=g.current||b.current,j=M&&Array.isArray(M)?fn(M):oe();be(j),g.current=null}y.current=i},[i,q]),h.useEffect(()=>{b.current=fn(L)},[L]);const fe=h.useMemo(()=>({stretchMode:"repeat",alignmentMode:"center",instructionFormat:"compact"}),[]),[se,Q]=h.useState(null),[le,Z]=h.useState([]),[ne]=h.useState(new es),[ce]=h.useState(new ts);h.useEffect(()=>{Ce()},[E,T,fe,$]),h.useEffect(()=>{const M=si(o?.panelShape||n?.shape)||ai();D(j=>({...j,shape:M,gauge:n?.gauge||j.gauge,sizeModifier:n?.sizeModifier||j.sizeModifier}))},[o?.id,n?.gauge,n?.shape,n?.sizeModifier]);const Ce=()=>{if(!(!E.shape||!T))try{const M={};$.forEach((X,J)=>{M[J]={id:J,label:`Color ${J+1}`,color:X}});const j=new Ze(0,0,T.grid,M,{width:T.metadata?.width||T.getStitchCount?.()||8,height:T.metadata?.height||T.getRowCount?.()||8}),k=new tn(E.shape,E.gauge,E.sizeModifier),Y=ne.combinePatterns(k,j,fe),W=ce.generateInstructions(Y,fe.instructionFormat);Q(Y),Z(W)}catch(M){console.error("Error generating combined pattern:",M)}},$e=(M,j)=>{D(k=>({...k,[M]:j}))},he=M=>{l&&l(M),s===void 0&&C(M)},xe=()=>{he("knitting"),P({currentRow:0,completedRows:[],currentSection:0})};h.useImperativeHandle(e,()=>({startKnitting:xe}));const Re=()=>{he("settings")},ye=M=>{P(j=>({...j,currentRow:Math.min(M+1,le.length-1),completedRows:[...j.completedRows,M]}))},ie=M=>{if(!i)return;const j=fn(M&&Array.isArray(M)?M:L),k=E.gauge,Y=E.gauge?{stitchesPerFourInches:typeof k?.stitchesPerFourInches=="number"?k.stitchesPerFourInches:E.gauge.getStitchesPerInch()*4,rowsPerFourInches:typeof k?.rowsPerFourInches=="number"?k.rowsPerFourInches:E.gauge.getRowsPerInch()*4,scalingFactor:typeof k?.scalingFactor=="number"?k.scalingFactor:1}:null,W=E.shape&&typeof E.shape?.toJSON=="function"?E.shape.toJSON():E.shape,X=N||i;m(J=>[...J.filter(_=>_.panelKey!==i),{panelKey:i,label:X,layers:j,gauge:Y,shape:W,timestamp:Date.now()}].sort((_,ee)=>{const F=a.indexOf(_.panelKey),re=a.indexOf(ee.panelKey),me=F===-1?Number.MAX_SAFE_INTEGER:F,Se=re===-1?Number.MAX_SAFE_INTEGER:re;return me===Se?_.timestamp-ee.timestamp:me-Se}))},p=()=>{if(!i)return;const M=fn(L);g.current=M,ie(M),O&&z?d?.(z):g.current=null},B=()=>v.jsxs("div",{className:"colorwork-settings-view",children:[f.length>0&&v.jsxs("div",{style:{marginBottom:16},children:[v.jsx(vr,{strong:!0,style:{display:"block",marginBottom:8},children:"Captured panels"}),v.jsx(Ye,{size:16,wrap:!0,children:f.map(M=>{const j=M.shape instanceof tt?M.shape:M.shape?tt.fromObject(M.shape):null,k=M.gauge||H;return j?v.jsx(Qd,{shape:j,patternLayers:M.layers,gauge:k,label:M.label,size:140,padding:8},M.panelKey):null})})]}),v.jsxs("div",{style:{marginBottom:16,display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:12},children:[v.jsx(vr,{strong:!0,children:N?`Editing ${N}${a.length>1?` (${K} of ${a.length})`:""}`:"Select a panel to edit"}),v.jsxs(Ye,{children:[!O&&i&&v.jsx(vr,{type:"secondary",children:"All selected panels captured"}),v.jsx(je,{type:"primary",onClick:p,disabled:!i,children:O?"Save & Next Panel":"Save Panel"})]})]}),v.jsx(Bd,{shape:E.shape,patternLayers:L,gauge:E.gauge,onLayersChange:M=>be(M),onGaugeChange:M=>$e("gauge",M)})]}),w=()=>v.jsx(Yd,{combinedPattern:se,instructions:le,knittingProgress:R,onRowComplete:ye,onBackToSettings:Re});return v.jsxs("div",{className:"colorwork-panel-editor",children:[S==="settings"&&B(),S==="knitting"&&w()]})});function si(t){if(!t)return null;if(t instanceof tt)return t;if(typeof t=="object"){const e=n=>{if(!n)return null;const r=n.height||0,o=n.baseA||0,i=n.baseB||0,a=n.baseBHorizontalOffset||0,s=n.finishingSteps||[],l=[];return n.successors&&Array.isArray(n.successors)&&n.successors.forEach(c=>{const d=e(c);d&&l.push(d)}),new tt(r,o,i,a,l,s)};return e(t)}return null}function ai(){return new tt(40,20,30,0)}function ef(){return new Ze(0,0,[[0,1,0,1,0,1,0,1],[1,0,1,0,1,0,1,0],[0,1,0,1,0,1,0,1],[1,0,1,0,1,0,1,0],[0,1,0,1,0,1,0,1],[1,0,1,0,1,0,1,0],[0,1,0,1,0,1,0,1],[1,0,1,0,1,0,1,0]],{0:{id:0,label:"Color 1",color:"#ffffff"},1:{id:1,label:"Color 2",color:"#000000"}},{width:8,height:8})}function fn(t){return Array.isArray(t)?t.map(e=>{const n=e?.pattern;let r=n;return n instanceof Ze?r=Ze.fromJSON(n.toJSON()):n&&typeof n=="object"&&"grid"in n&&(r=Ze.fromJSON(n)),{...e,pattern:r,patternConfig:li(e?.patternConfig),settings:li(e?.settings)}}):[]}function li(t){if(t==null)return t;try{return JSON.parse(JSON.stringify(t))}catch(e){return console.warn("Failed to clone value, returning original reference",e),t}}const gs=(t,e=.7)=>{if(!t)return t;let n=t.replace("#","");n.length===3&&(n=n.split("").map(a=>a+a).join(""));const r=Math.max(0,Math.min(255,Math.floor(parseInt(n.slice(0,2),16)*e))),o=Math.max(0,Math.min(255,Math.floor(parseInt(n.slice(2,4),16)*e))),i=Math.max(0,Math.min(255,Math.floor(parseInt(n.slice(4,6),16)*e)));return`#${r.toString(16).padStart(2,"0")}${o.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}`},ci=(t,e={})=>{const n=typeof e.width=="number"?e.width:Math.max(1,(t.baseA||10)*.25),r=typeof e.height=="number"?e.height:Math.max(.5,(t.height||10)*.15),o=Math.max(0,typeof e.baseStart=="number"?e.baseStart:n),i=Math.max(0,typeof e.basePivot=="number"?e.basePivot:n);return{id:e.id||`sr-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,label:e.label||null,baseA:o,baseB:i,baseBHorizontalOffset:0,height:r,successors:[],isHem:!1,shortRows:[]}},ui=(t,e,n={},r=1,o=0,i=0)=>{const a=Math.max(0,Math.min(1,typeof n.posX=="number"?n.posX:.5));let s=Math.max(0,Math.min(1,typeof n.posY=="number"?n.posY:0));if(t.isHem){const I=1-Math.abs(s-.5)*2;s=Math.max(0,Math.min(1,I))}const l=Math.max(t.baseA,t.baseB)*r,c=o+(l-t.baseB*r)/2+(t.baseBHorizontalOffset||0)*r,d=o+(l+t.baseB*r)/2+(t.baseBHorizontalOffset||0)*r,u=o+(l-t.baseA*r)/2,f=o+(l+t.baseA*r)/2,m=($,I,O)=>$+(I-$)*O,b=m(c,u,s),y=m(d,f,s)-b,x=b+y*a,C=Math.max(e.baseA,e.baseB)*r,S=(e.baseBHorizontalOffset||0)*r,R=x-(C/2+S),P=(t.isHem?t.height*.5:t.height)*r,E=i,D=i+P,T=E+(D-E)*s;return{childXOffset:R,childYOffset:T,anchorX:x,anchorY:T}},tf=(t,e,n=0,r=0,o)=>{const i=Math.max(t.baseA,t.baseB)*e,a=n+(i-t.baseB*e)/2+0*e,s=n+(i+t.baseB*e)/2+0*e,l=n+(i-t.baseA*e)/2,c=n+(i+t.baseA*e)/2,d=r+t.height*e,u=r,f=gs(o,.7);return v.jsx("g",{children:v.jsx("polygon",{points:`${a},${d} ${s},${d} ${c},${u} ${l},${u}`,fill:f,fillOpacity:.65,stroke:"#666",strokeWidth:1,strokeLinejoin:"round","data-shortrow-id":t.id})},t.id||`${n}-${r}`)},nf=(t,e,n=0,r=0,o,i,a)=>{const s=t,l=(s.isHem?s.height*.5:s.height)*e,c=Math.max(s.baseA,s.baseB)*e,d=n+(c-s.baseB*e)/2+(s.baseBHorizontalOffset||0)*e,u=n+(c+s.baseB*e)/2+(s.baseBHorizontalOffset||0)*e,f=n+(c-s.baseA*e)/2,m=n+(c+s.baseA*e)/2,b=r,g=r+l,y=i&&t.id&&t.id===i,x=(d+u+f+m)/4,C=(b+g)/2,S=s.isHem?gs(o,.6):o;return v.jsxs("g",{children:[v.jsx("polygon",{points:`${d},${b} ${u},${b} ${m},${g} ${f},${g}`,fill:S,fillOpacity:y?.95:.85,stroke:y?"#1677ff":"#a1a8af",strokeWidth:y?4:3,strokeLinejoin:"round",style:{cursor:a?"pointer":"default"},onClick:a?()=>a(t.id):void 0,"data-trapezoid-id":t.id,role:a?"button":void 0,tabIndex:a?0:void 0}),t.label?v.jsx("text",{x,y:C,textAnchor:"middle",dominantBaseline:"central",style:{pointerEvents:"none",fontWeight:700,fontSize:"24px"},fill:"#ffffff",stroke:"#000000",strokeWidth:2,children:t.label}):null]},t.id||`${n}-${r}`)},Ar=(t,e,n=0,r=0,o={minX:0,maxX:0,minY:0,maxY:0},i,a,s,l=null)=>{const c=[],d=Math.max(t.baseA,t.baseB)*e,u=n+(d-t.baseB*e)/2+(t.baseBHorizontalOffset||0)*e,f=n+(d+t.baseB*e)/2+(t.baseBHorizontalOffset||0)*e,m=n+(d-t.baseA*e)/2,b=n+(d+t.baseA*e)/2,g=r,y=(t.isHem?t.height*.5:t.height)*e,x=r+y;if(o.minX=Math.min(o.minX,u,f,m,b),o.maxX=Math.max(o.maxX,u,f,m,b),o.minY=Math.min(o.minY,g,x),o.maxY=Math.max(o.maxY,g,x),t.shortRows&&t.shortRows.length)for(let C of t.shortRows){const S=ci(t,C),{childXOffset:R,childYOffset:P}=ui(t,S,C,e,n,r),E=R+(Math.max(S.baseA,S.baseB)*e-S.baseB*e)/2,D=R+(Math.max(S.baseA,S.baseB)*e+S.baseB*e)/2,T=P+S.height*e,A=P;o.minX=Math.min(o.minX,E),o.maxX=Math.max(o.maxX,D),o.minY=Math.min(o.minY,A),o.maxY=Math.max(o.maxY,T,o.maxY)}if(c.push(nf(t,e,n,r,i,a,s)),t.shortRows&&t.shortRows.length)for(let C of t.shortRows){const S=ci(t,C),{childXOffset:R,childYOffset:P,anchorX:E,anchorY:D}=ui(t,S,C,e,n,r);c.push(tf(S,e,R,P,i)),C.id&&C.id===l&&c.push(v.jsx("g",{children:v.jsx("circle",{cx:E,cy:D,r:4,fill:"#000"})},`marker-${C.id}`))}if(t.successors&&t.successors.length>0){const C=t.successors.map(P=>Math.max(P.baseA,P.baseB)*e),S=C.reduce((P,E)=>P+E,0);let R=n+(d-S)/2;for(let P=0;P<t.successors.length;P++){const E=t.successors[P],D=C[P],T={minX:o.minX,maxX:o.maxX,minY:o.minY,maxY:o.maxY},A=(E.isHem?E.height*.5:E.height)*e;c.push(...Ar(E,e,R,g-A,T,i,a,s)),o.minX=T.minX,o.maxX=T.maxX,o.minY=T.minY,o.maxY=T.maxY,R+=D}}return c},rf=({shape:t,label:e="",size:n=200,padding:r=10,selectedId:o=null,onSelect:i=null,selectedShortRowId:a=null})=>{const{token:s}=Mi.useToken(),l=s.colorPrimary;let c={minX:0,maxX:0,minY:0,maxY:0};Ar(t,1,0,0,c,l,null,null);const d=c.maxX-c.minX,u=c.maxY-c.minY,f=n-2*r,m=n-2*r,b=Math.min(f/d,m/u),g=d*b,y=u*b,x=(n-g)/2-c.minX*b+r,C=(n-y)/2-c.minY*b+r;c={minX:0,maxX:0,minY:0,maxY:0};const S=Ar(t,b,0,0,c,l,o,i,a);return v.jsxs("div",{style:{},children:[v.jsx("svg",{width:n,height:n,viewBox:`0 0 ${n} ${n+4}`,preserveAspectRatio:"none",children:v.jsx("g",{transform:`translate(${x}, ${C})`,children:S})}),e]})},{Text:et}=yn,qr=()=>`trap-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,of=()=>({id:qr(),height:40,baseA:20,baseB:30,baseBHorizontalOffset:0,successors:[],label:null,isHem:!1,shortRows:[]}),sf=()=>({id:qr(),height:12,baseA:16,baseB:12,baseBHorizontalOffset:0,successors:[],label:null,isHem:!1,shortRows:[]}),af=()=>({id:`sr-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,label:null,posX:.5,posY:.5,height:2,baseStart:5,basePivot:1});function Ft(t){return JSON.parse(JSON.stringify(t))}function Br(t,e,n=null){if(!t)return{node:null,parent:null,indexInParent:-1};if(t.id===e)return{node:t,parent:n,indexInParent:-1};for(let r=0;r<(t.successors||[]).length;r++){const o=t.successors[r],i=Br(o,e,t);if(i.node)return{...i,indexInParent:n===t?r:i.indexInParent}}return{node:null,parent:null,indexInParent:-1}}function lf(t){const e={};let n=0;const r=[t],o=i=>{let a="";for(i+=1;i>0;){const s=(i-1)%26;a=String.fromCharCode(65+s)+a,i=Math.floor((i-1)/26)}return a};for(;r.length;){const i=r.pop();if(i&&(e[i.id]=o(n++),i.successors&&i.successors.length))for(let a=i.successors.length-1;a>=0;a--)r.push(i.successors[a])}return e}function hn(t){const e=lf(t),n=r=>{if(!r)return r;const o={...r};return o.label=e[r.id],o.title=e[r.id]?`Trapezoid ${e[r.id]}`:"Trapezoid",o.successors&&o.successors.length&&(o.successors=o.successors.map(n)),o};return n(t)}function Zt(t,e,n){const r=Ft(t),o=[r];for(;o.length;){const i=o.pop();if(i.id===e){n(i);break}(i.successors||[]).forEach(a=>o.push(a))}return r}function cf(t,e){if(t.id===e)return t;const n=Ft(t),r=[n];for(;r.length;){const o=r.shift();if(!o.successors)continue;const i=o.successors.findIndex(a=>a.id===e);if(i!==-1){o.successors.splice(i,1);break}o.successors.forEach(a=>r.push(a))}return n}function uf(t,e){const n=Ft(t),r=[n];for(;r.length;){const o=r.pop();if(o.id===e){o.successors=o.successors||[],o.successors.push(sf());break}(o.successors||[]).forEach(i=>r.push(i))}return n}function di(t,e,n,r){const o=Ft(t),i=[o];for(;i.length;){const a=i.pop();if(a.id===e){if(!a.successors)break;const s=a.successors,[l]=s.splice(n,1);s.splice(r,0,l);break}(a.successors||[]).forEach(s=>i.push(s))}return o}function vf(){const[t,e]=h.useState(()=>hn(of())),[n,r]=h.useState(t.id),[o,i]=h.useState(null),[a,s]=h.useState(!1),[l,c]=h.useState(!1),{setMenuItems:d}=ea(),u=h.useMemo(()=>Br(t,n),[t,n]),f=u.node||t,m=h.useCallback(($,I)=>{e(O=>Zt(O,f.id,z=>{z[$]=I??0}))},[f?.id]),b=h.useCallback(($,I)=>{e(O=>Zt(O,f.id,z=>{z[$]=!!I}))},[f?.id]),g=h.useCallback(()=>e($=>hn(uf($,f.id))),[f?.id]),y=h.useCallback(()=>e($=>hn(cf($,f.id))),[f?.id]),x=h.useCallback(()=>{if(f.id===t.id){e(N=>({...Ft(N),id:N.id}));return}const{parent:$}=Br(t,f.id);if(!$)return;const I=Ft(f);I.id=qr();const O=Ft(t),z=[O];for(;z.length;){const N=z.pop();if(N.id===$.id){const K=N.successors.findIndex(H=>H.id===f.id);N.successors.splice(K+1,0,I);break}(N.successors||[]).forEach(K=>z.push(K))}e(hn(O))},[t,f]),C=f?.successors||[],S=f?.shortRows||[],R=h.useCallback($=>{try{if(!$){en.error("No panel data provided");return}const I=tn.fromObject($);e(hn(I.shape)),r(I.shape.id),en.success(`Loaded panel: ${$.name||"Untitled"}`)}catch(I){console.error("PanelShapeCreator: Error loading panel",I),en.error("Failed to load panel: "+String(I))}},[]),P=h.useCallback(async($,I)=>{console.log(`Panel "${$}" saved successfully`)},[]);h.useEffect(()=>(d([{key:"panel-save-as",label:"Save As...",icon:v.jsx(Zi,{}),onClick:()=>c(!0)},{key:"panel-open",label:"Open...",icon:v.jsx(na,{}),onClick:()=>s(!0)}]),()=>d([])),[d]);const E=h.useCallback(()=>{e($=>Zt($,f.id,I=>{I.shortRows=I.shortRows||[],I.shortRows.push(af())}))},[f?.id]),D=h.useCallback(()=>{o&&(e($=>Zt($,f.id,I=>{I.shortRows=(I.shortRows||[]).filter(O=>O.id!==o)})),i(null))},[f?.id,o]),T=h.useCallback(()=>{o&&e($=>Zt($,f.id,I=>{I.shortRows=I.shortRows||[];const O=I.shortRows.findIndex(N=>N.id===o);if(O===-1)return;const z={...I.shortRows[O],id:`sr-${Date.now()}-${Math.random().toString(36).slice(2,6)}`};I.shortRows.splice(O+1,0,z)}))},[f?.id,o]),A=h.useCallback(($,I,O)=>{const z=I==="posX"||I==="posY"?Math.max(0,Math.min(1,O)):O;e(N=>Zt(N,f.id,K=>{if(!K.shortRows)return;const H=K.shortRows.findIndex(q=>q.id===$);H!==-1&&(K.shortRows[H]={...K.shortRows[H],[I]:z})}))},[f?.id]);return v.jsxs("div",{style:{display:"flex",height:"calc(100vh - 64px)"},children:[v.jsx("div",{style:{flex:1,minWidth:360,padding:16},children:v.jsx(ut,{size:"small",title:"Preview",children:v.jsx(rf,{shape:t,size:560,padding:20,selectedId:n,selectedShortRowId:o,onSelect:$=>$&&r($)},JSON.stringify(t))})}),v.jsxs("div",{style:{width:440,padding:16},children:[v.jsxs(Ye,{direction:"vertical",style:{width:"100%"},children:[v.jsxs(Ye,{style:{marginBottom:8},children:[v.jsx(je,{size:"small",onClick:()=>r(t.id),disabled:f.id===t.id,children:"Select Root"}),v.jsx(je,{size:"small",onClick:()=>u.parent&&r(u.parent.id),disabled:!u.parent,children:"Select Parent"})]}),v.jsxs(ut,{size:"small",title:"Geometry",children:[v.jsxs(qe,{gutter:8,children:[v.jsxs(De,{span:12,children:[v.jsx(et,{children:"Height"}),v.jsx(He,{value:f.height,min:0,onChange:$=>m("height",$),style:{width:"100%"}})]}),v.jsxs(De,{span:12,children:[v.jsx(et,{children:"Lower Base (A)"}),v.jsx(He,{value:f.baseA,min:0,onChange:$=>m("baseA",$),style:{width:"100%"}})]})]}),v.jsxs(qe,{gutter:8,style:{marginTop:8},children:[v.jsxs(De,{span:12,children:[v.jsx(et,{children:"Upper Base (B)"}),v.jsx(He,{value:f.baseB,min:0,onChange:$=>m("baseB",$),style:{width:"100%"}})]}),v.jsxs(De,{span:12,children:[v.jsx(et,{children:"Horizontal Offset"}),v.jsx(He,{value:f.baseBHorizontalOffset,onChange:$=>m("baseBHorizontalOffset",$),style:{width:"100%"}})]})]}),v.jsx(qe,{style:{marginTop:12},gutter:8,children:v.jsx(De,{span:24,children:v.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[v.jsx(et,{style:{whiteSpace:"nowrap",marginRight:8},children:"Is Hem"}),v.jsx(ra,{checked:!!f.isHem,onChange:$=>b("isHem",$)})]})})})]}),v.jsxs(ut,{size:"small",title:"Children",children:[v.jsxs(Ye,{style:{marginBottom:8},children:[v.jsx(je,{icon:v.jsx(Yn,{}),onClick:g,children:"Add Child"}),v.jsx(je,{icon:v.jsx(xr,{}),onClick:x,children:"Duplicate"}),v.jsx(je,{icon:v.jsx(Sr,{}),danger:!0,onClick:y,disabled:f.id===t.id,children:"Remove"})]}),v.jsx(Bn,{size:"small",bordered:!0,dataSource:C,rowKey:$=>`${$.id}-${$.label||"none"}`,locale:{emptyText:"No children"},renderItem:($,I)=>v.jsx(Bn.Item,{style:{cursor:"pointer",background:$.id===n?"#f0f7ff":"transparent"},onClick:()=>r($.id),actions:[v.jsx(je,{icon:v.jsx(au,{}),size:"small",disabled:I===0,onClick:O=>{O.stopPropagation(),e(z=>di(z,f.id,I,I-1))}},"up"),v.jsx(je,{icon:v.jsx(ou,{}),size:"small",disabled:I===C.length-1,onClick:O=>{O.stopPropagation(),e(z=>di(z,f.id,I,I+1))}},"down")],children:v.jsxs(Ye,{children:[v.jsx(et,{strong:!0,children:$.label?`Trapezoid ${$.label}`:"Trapezoid"}),v.jsxs(et,{type:"secondary",children:["h:",$.height," A:",$.baseA," B:",$.baseB," off:",$.baseBHorizontalOffset]})]})})})]}),v.jsxs(ut,{size:"small",title:"Short Rows",children:[v.jsxs(Ye,{style:{marginBottom:8},children:[v.jsx(je,{icon:v.jsx(Yn,{}),onClick:E,children:"Add Short Row"}),v.jsx(je,{icon:v.jsx(xr,{}),onClick:T,disabled:!o,children:"Duplicate"}),v.jsx(je,{icon:v.jsx(Sr,{}),danger:!0,onClick:D,disabled:!o,children:"Remove"})]}),v.jsx(Bn,{size:"small",bordered:!0,dataSource:S,rowKey:$=>`${$.id}-${$.label||"none"}`,locale:{emptyText:"No short rows"},renderItem:($,I)=>v.jsx(Bn.Item,{style:{cursor:"pointer",background:$.id===o?"#f0f7ff":"transparent"},onClick:()=>i($.id),children:v.jsxs(Ye,{direction:"vertical",children:[v.jsx(et,{strong:!0,children:$.label?$.label:`Short Row ${I+1}`}),v.jsxs(et,{type:"secondary",children:["x:",($.posX||0).toFixed(2)," y:",($.posY||0).toFixed(2)," h:",($.height||0).toFixed(2),'" A:',($.baseStart||0).toFixed(2)," B:",($.basePivot||0).toFixed(2)]})]})})}),o?(()=>{const $=(S||[]).find(I=>I.id===o);return $?v.jsxs("div",{style:{marginTop:12},children:[v.jsx(et,{strong:!0,style:{display:"block",marginBottom:8},children:$.label||`Short Row ${S.indexOf($)+1}`}),v.jsxs(qe,{gutter:8,children:[v.jsxs(De,{span:12,children:[v.jsx(et,{children:"Pos X"}),v.jsx(He,{min:0,max:1,step:.01,value:$.posX,onChange:I=>A($.id,"posX",I),style:{width:"100%"}})]}),v.jsxs(De,{span:12,children:[v.jsx(et,{children:"Pos Y"}),v.jsx(He,{min:0,max:1,step:.01,value:$.posY,onChange:I=>A($.id,"posY",I),style:{width:"100%"}})]})]}),v.jsxs(qe,{gutter:8,style:{marginTop:8},children:[v.jsxs(De,{span:12,children:[v.jsx(et,{children:"Height (in)"}),v.jsx(He,{min:0,step:.1,value:$.height,onChange:I=>A($.id,"height",I),style:{width:"100%"}})]}),v.jsx(De,{span:12,children:v.jsx(et,{children:" "})})]}),v.jsxs(qe,{gutter:8,style:{marginTop:8},children:[v.jsxs(De,{span:12,children:[v.jsx(et,{children:"Base Start (in)"}),v.jsx(He,{min:0,step:.1,value:$.baseStart,onChange:I=>A($.id,"baseStart",I),style:{width:"100%"}})]}),v.jsxs(De,{span:12,children:[v.jsx(et,{children:"Base Pivot (in)"}),v.jsx(He,{min:0,step:.1,value:$.basePivot,onChange:I=>A($.id,"basePivot",I),style:{width:"100%"}})]})]})]}):null})():null]}),v.jsx(_r,{}),v.jsx(et,{type:"secondary",children:"Tip: Select a child to edit its geometry, use arrows to reorder, or Add Child to grow the tree."})]}),v.jsx(ta,{visible:a,jsonKey:"panels",displayLabel:"Panel",onOpen:R,onClose:()=>s(!1)}),v.jsx(vu,{visible:l,jsonKey:"panels",displayLabel:"Panel",entityData:new tn(t,void 0,1).toJSON(),onSave:P,onClose:()=>c(!1)})]})]})}export{ut as C,Xr as G,Cn as L,vf as P,vu as S,Sl as a,mf as b,rf as c};
//# sourceMappingURL=PanelShapeCreator-C5MhsgF5.js.map
